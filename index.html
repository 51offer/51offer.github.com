<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>51offer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="æ¯å‘¨åˆ†äº«åšå®¢">
<meta property="og:type" content="website">
<meta property="og:title" content="51offer">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="51offer">
<meta property="og:description" content="æ¯å‘¨åˆ†äº«åšå®¢">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="51offer">
<meta name="twitter:description" content="æ¯å‘¨åˆ†äº«åšå®¢">
  
    <link rel="alternative" href="/atom.xml" title="51offer" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">ç§»åŠ¨ç»„å›¢é˜Ÿ</a></h1>
		</hgroup>

		
		<p class="header-subtitle">MobileBlogs</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>èœå•</li>
						<li>æ ‡ç­¾</li>
						
						<li>å‹æƒ…é“¾æ¥</li>
						
						
						<li>å…³äºæˆ‘</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">ä¸»é¡µ</a></li>
				        
							<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/51offer" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/p/1006062608078012/home" title="weibo">weibo</a>
					        
								<a class="mail" target="_blank" href="/ming.z@51offer.com" title="mail">mail</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Chrome/" style="font-size: 10px;">Chrome</a> <a href="/tags/JUnit4/" style="font-size: 10px;">JUnit4</a> <a href="/tags/Playground/" style="font-size: 10px;">Playground</a> <a href="/tags/blog-tools-ci/" style="font-size: 10px;">blog, tools, ci</a> <a href="/tags/express/" style="font-size: 10px;">express</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/javaScript/" style="font-size: 10px;">javaScript</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/phython/" style="font-size: 10px;">phython</a> <a href="/tags/shell/" style="font-size: 20px;">shell</a> <a href="/tags/tablayout/" style="font-size: 10px;">tablayout</a> <a href="/tags/weui/" style="font-size: 10px;">weui</a> <a href="/tags/åšå®¢/" style="font-size: 10px;">åšå®¢</a> <a href="/tags/åŒæ­¥å¼‚æ­¥/" style="font-size: 10px;">åŒæ­¥å¼‚æ­¥</a> <a href="/tags/å‘/" style="font-size: 10px;">å‘</a> <a href="/tags/å¼€å‘æ•ˆç‡/" style="font-size: 10px;">å¼€å‘æ•ˆç‡</a> <a href="/tags/æ•ˆç‡/" style="font-size: 10px;">æ•ˆç‡</a> <a href="/tags/æ¸¸æˆ/" style="font-size: 10px;">æ¸¸æˆ</a> <a href="/tags/ç ”å‘æ‚è°ˆ/" style="font-size: 10px;">ç ”å‘æ‚è°ˆ</a> <a href="/tags/çº¿ç¨‹/" style="font-size: 10px;">çº¿ç¨‹</a> <a href="/tags/ç½‘ç«™/" style="font-size: 10px;">ç½‘ç«™</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.tomatopeter.com/">tomatopeter&#39;s blog&#39;</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://ioi.im/">ming.z&#39;s blog</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">æˆ‘ä»¬æ˜¯ä¸€ç¾¤çˆ±æŠ˜è…¾çš„æŠ€æœ¯å®…ï¼Œç«‹å¿—åœ¨ç•™å­¦è¡Œä¸šåšäº›å¥½ç©çš„äº‹ã€‚å¦‚æœä½ ç›¸ä¿¡æŠ€æœ¯æ‹¥æœ‰å¼ºå¤§çš„åŠ›é‡ï¼Œæœ‰å¾ˆå¤šæœ‰è¶£çš„å¿µå¤´ä¸çŸ¥åœ¨ä½•å¤„èƒ½å®è·µï¼Œä¸å¦¨åŠ å…¥æˆ‘ä»¬ä¸€èµ·åˆ‡ç£‹ã€‚ã€‚ã€‚</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">ç§»åŠ¨ç»„å›¢é˜Ÿ</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">ç§»åŠ¨ç»„å›¢é˜Ÿ</h1>
			</hgroup>
			
			<p class="header-subtitle">MobileBlogs</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">ä¸»é¡µ</a></li>
		        
					<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/51offer" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/p/1006062608078012/home" title="weibo">weibo</a>
			        
						<a class="mail" target="_blank" href="/ming.z@51offer.com" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬61æœŸ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/29/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬61æœŸ/" class="article-date">
  	<time datetime="2016-07-29T14:30:00.000Z" itemprop="datePublished">2016-07-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/29/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬61æœŸ/">ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬61æœŸ</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="CloudKitåˆæ¢_-_åˆ˜åº·">CloudKitåˆæ¢ - åˆ˜åº·</h2><h3 id="ä»€ä¹ˆæ˜¯CloudKit">ä»€ä¹ˆæ˜¯CloudKit</h3><ul>
<li>iCloud</li>
<li>Documents</li>
<li>iCloud Drive</li>
<li>CloudKit</li>
</ul>
<h3 id="CloudKit_åŸºç¡€å¯¹è±¡ç±»å‹">CloudKit åŸºç¡€å¯¹è±¡ç±»å‹</h3><ul>
<li><p><code>CKContainer</code>: Containers å°±åƒåº”ç”¨è¿è¡Œçš„æ²™ç›’ä¸€æ ·ï¼Œä¸€ä¸ªåº”ç”¨åªèƒ½è®¿é—®è‡ªå·±æ²™ç›’ä¸­çš„å†…å®¹è€Œä¸èƒ½è®¿é—®å…¶ä»–åº”ç”¨çš„ã€‚Containers å°±æ˜¯æœ€å¤–å±‚å®¹å™¨ï¼Œæ¯ä¸ªåº”ç”¨æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå±äºè‡ªå·±çš„ containerã€‚</p>
</li>
<li><p><code>CKDatabase</code>: Database å³æ•°æ®åº“ï¼Œç§æœ‰æ•°æ®åº“ç”¨æ¥å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ç”¨æˆ·çš„æ€§åˆ«å¹´é¾„ç­‰ï¼Œç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„ç§æœ‰æ•°æ®åº“ã€‚åº”ç”¨ä¹Ÿæœ‰ä¸€ä¸ªå…¬å¼€çš„æ•°æ®åº“æ¥å­˜å‚¨å…¬å…±ä¿¡æ¯ï¼Œä¾‹å¦‚ä½ åœ¨æ„å»ºä¸€ä¸ªåŸºäºåœ°ç†ä½ç½®çš„åº”ç”¨ï¼Œé‚£ä¹ˆåœ°ç†ä½ç½®ä¿¡æ¯å°±åº”è¯¥å­˜å‚¨åœ¨å…¬å…±æ•°æ®åº“é‡Œä»¥ä¾¿æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½è®¿é—®åˆ°ã€‚</p>
</li>
<li><p><code>CKRecord</code>: å³æ•°æ®åº“ä¸­çš„ä¸€æ¡æ•°æ®è®°å½•ã€‚CloudKit ä½¿ç”¨ record é€šè¿‡ key-value ç»“æ„æ¥å­˜å‚¨ç»“æ„åŒ–æ•°æ®ã€‚å…³äºé”®å€¼å­˜å‚¨ï¼Œç›®å‰å€¼çš„æ¶æ„æ”¯æŒ NSStringã€NSNumberã€NSDataã€NSDateã€CLLocationï¼Œå’Œ CKReferenceã€CKAssetï¼ˆè¿™ä¸¤ä¸ªä¸‹é¢æˆ‘ä»¬ä¼šè¯´æ˜ï¼‰ï¼Œä»¥åŠå­˜å‚¨ä»¥ä¸Šæ•°æ®ç±»å‹çš„æ•°ç»„ã€‚</p>
</li>
<li><p><code>CKRecordZone</code>: Record ä¸æ˜¯ä»¥é›¶æ•£çš„æ–¹å¼å­˜åœ¨äº database ä¹‹ä¸­çš„ï¼Œå®ƒä»¬ä½äº record zones é‡Œã€‚æ¯ä¸ªåº”ç”¨éƒ½æœ‰ä¸€ä¸ª default record zoneï¼Œä½ ä¹Ÿå¯ä»¥æœ‰è‡ªå®šä¹‰çš„ record zoneã€‚</p>
</li>
<li><p><code>CKRecordIdentifier</code>: æ˜¯ä¸€æ¡ record çš„å”¯ä¸€æ ‡è¯†ï¼Œç”¨äºç¡®å®šè¯¥ record åœ¨æ•°æ®åº“ä¸­çš„å”¯ä¸€ä½ç½®ã€‚</p>
</li>
<li><p><code>CKReference</code>: Reference ä¸€ç§å¼•ç”¨å…³ç³»ã€‚ä»¥åœ°ç†ä½ç½®ç­¾åˆ°åº”ç”¨ä¸ºä¾‹ï¼Œæ¯ä¸ªåœ°ç†ä½ç½®å¯ä»¥åŒ…å«å¾ˆå¤šç”¨æˆ·åœ¨è¯¥ä½ç½®çš„ç­¾åˆ°ï¼Œé‚£ä¹ˆä½ç½®ä¸ç­¾åˆ°ä¹‹é—´å°±å½¢æˆäº†è¿™æ ·ä¸€ç§åŒ…å«å¼çš„ä»å±å…³ç³»ã€‚</p>
</li>
<li><p><code>CKAsset</code>: å³èµ„æºæ–‡ä»¶ï¼Œä¾‹å¦‚äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¿˜æ˜¯ä»¥ç­¾åˆ°åº”ç”¨ä¸ºä¾‹ï¼Œç”¨æˆ·ç­¾åˆ°æ—¶å¯èƒ½è¿˜åŒ…å«ä¸€å¼ ç…§ç‰‡ï¼Œé‚£ä¹ˆè¿™å¼ ç…§ç‰‡å°±ä¼šä»¥ asset å½¢å¼å­˜å‚¨èµ·æ¥ã€‚</p>
</li>
</ul>
<h3 id="æœ‰å“ªäº›Apiï¼ˆDiary_Demoï¼‰">æœ‰å“ªäº›Apiï¼ˆDiary Demoï¼‰</h3><h4 id="å¢">å¢</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">updateRecord</span><span class="params">(diary: Diary, record: CKRecord)</span></span> &#123;</span><br><span class="line">    </span><br><span class="line">    record.setObject(diary.content, forKey: <span class="string">"Content"</span>)</span><br><span class="line">    </span><br><span class="line">    record.setObject(diary.created_at, forKey: <span class="string">"Created_at"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> location = diary.location &#123;</span><br><span class="line">        record.setObject(location, forKey: <span class="string">"Location"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> title = diary.title &#123;</span><br><span class="line">        record.setObject(title, forKey: <span class="string">"Title"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    record.setObject(diary.id, forKey: <span class="string">"id"</span>)</span><br><span class="line">    </span><br><span class="line">    privateDB.saveRecord(record, completionHandler: &#123; (newDiary, error) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">debugPrint</span>(<span class="string">"Diary Updated"</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">            <span class="built_in">debugPrint</span>(<span class="string">"error <span class="subst">\(error.description)</span>"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åˆ ">åˆ </h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">deleteCloudRecord</span><span class="params">(record: CKRecord)</span></span> &#123;</span><br><span class="line">    privateDB.deleteRecordWithID(record.recordID) &#123; (recordID, error) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Delete <span class="subst">\(recordID?.recordName)</span> <span class="subst">\(error?.description)</span>"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ”¹">æ”¹</h4><p>æŸ¥è¯¢ -&gt; ä¿®æ”¹ -&gt; æ›´æ–°</p>
<h4 id="æŸ¥">æŸ¥</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">fetchCloudRecordWithTitle</span><span class="params">(title: String , complete: <span class="params">([CKRecord]?)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> predicate = <span class="type">NSPredicate</span>(format: <span class="string">"Title == %@"</span>, title)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> query = <span class="type">CKQuery</span>(recordType: <span class="string">"Diary"</span>,</span><br><span class="line">                        predicate: predicate )</span><br><span class="line">    </span><br><span class="line">    privateDB.performQuery(query, inZoneWithID: <span class="literal">nil</span>) &#123;</span><br><span class="line">        results, error <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> results = results &#123;</span><br><span class="line">            complete(results)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            complete(<span class="literal">nil</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç¢°åˆ°çš„é—®é¢˜(è¸©åˆ°çš„å‘)">ç¢°åˆ°çš„é—®é¢˜(è¸©åˆ°çš„å‘)</h3><ol>
<li><code>Saving CloudKit Record â€œNot Authenticatedâ€ (9/1002)â€œ â€This request requires an authenticated account</code><br>åŸå› ï¼šä½¿ç”¨æ¨¡æ‹Ÿå™¨æˆ–è€…è®¾å¤‡æ²¡æœ‰å¯ç”¨iCloud</li>
<li><code>Couldn&#39;t get container configuration from the server for container</code><br>åŸå› ï¼šcontainerâ€™s identifieré”™è¯¯ï¼Œå¯èƒ½æ˜¯ä½¿ç”¨é»˜è®¤å€¼ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸ä»£ç é‡Œåˆå§‹åŒ–containeræ—¶çš„identifierä¸ä¸€è‡´ï¼›<br>å¦å¤–ï¼Œéœ€è¦ä¸å¼€å‘è€…ä¸­å¿ƒ<code>Certificates, Identifiers &amp; Profiles</code>çš„iCloud Containersä¿æŒä¸€è‡´ã€‚<strong>éœ€è¦5åˆ†é’Ÿå·¦å³æ‰å¯ä»¥ä½¿ç”¨</strong></li>
<li><code>Invalid Arguments(12/2015); server message = Field &#39;___recordID&#39; is not marked queryable</code><br>åŸå› ï¼šæœªè®¾ç½®<code>Metadata Indexes</code>.éœ€è¦å‰å¾€CloudKit Dashboard -&gt; Record Types -&gt; Metedata Indexesè®¾ç½®</li>
</ol>
<h3 id="æ”¶è´¹">æ”¶è´¹</h3><p>ç­‰ä¸åŠè¦è¯•è¯• CloudKit äº†ï¼Ÿå®ƒèƒ½è®©ä½ ä»ç¼–å†™æœåŠ¡ç«¯ä»£ç ã€ç›‘æ§æœåŠ¡å™¨å‹åŠ›ã€é•¿æœŸç»´æŠ¤å¤§é‡çš„ CDNã€ç§Ÿç”¨æœåŠ¡å™¨ç­‰ç­‰ç­‰ç­‰çš„äº‹æƒ…ä¸­è§£è„±å‡ºæ¥ã€‚ç­‰ç­‰ï¼CloudKit æ€ä¹ˆæ”¶è´¹å‘¢ï¼Œä¼šå¾ˆè´µå—ï¼Ÿç­”æ¡ˆæ˜¯ï¼šå…è´¹ã€‚ç›®å‰è‹¹æœå…è®¸ä½ ä½¿ç”¨ CloudKit å­˜å‚¨ 10 GB èµ„æºï¼Œ100 M æ•°æ®åº“å­˜å‚¨ï¼Œæ¯å¤© 2 GB æµé‡ï¼›å½“ä½ çš„ç”¨æˆ·æ•°é‡å¢åŠ çš„æ—¶å€™ï¼Œè¿™äº›å…è´¹é¢åº¦ä¹Ÿç›¸åº”åœ°å¢åŠ åˆ° 1 PB å­˜å‚¨ã€10 TB æ•°æ®åº“å­˜å‚¨ï¼Œä»¥åŠæ¯å¤© 200 TB æµé‡ã€‚</p>
<h3 id="å‚è€ƒ">å‚è€ƒ</h3><p><a href="https://developer.apple.com/library/ios/documentation/DataManagement/Conceptual/CloudKitQuickStart/EnablingiCloudandConfiguringCloudKit/EnablingiCloudandConfiguringCloudKit.html#//apple_ref/doc/uid/TP40014987-CH2-SW1" target="_blank" rel="external">https://developer.apple.com/library/ios/documentation/DataManagement/Conceptual/CloudKitQuickStart/EnablingiCloudandConfiguringCloudKit/EnablingiCloudandConfiguringCloudKit.html#//apple_ref/doc/uid/TP40014987-CH2-SW1</a></p>
<p><a href="https://icloud.developer.apple.com/dashboard" target="_blank" rel="external">https://icloud.developer.apple.com/dashboard</a></p>
<p><a href="http://nshipster.cn/cloudkit/" target="_blank" rel="external">http://nshipster.cn/cloudkit/</a></p>
<h3 id="é€šç”¨é“¾æ¥ï¼ˆ_Universal_Links_ï¼‰-_æ¨å¿—å¹³">é€šç”¨é“¾æ¥ï¼ˆ Universal Links ï¼‰- æ¨å¿—å¹³</h3><p>@(iOS)[universal links, é€šç”¨é“¾æ¥]</p>
<blockquote>
<ul>
<li>é€šè¿‡å”¯ä¸€çš„ç½‘å€, å°±å¯ä»¥é“¾æ¥ä¸€ä¸ªç‰¹å®šçš„è§†å›¾åˆ°ä½ çš„ APP é‡Œé¢, ä¸éœ€è¦ç‰¹åˆ«çš„ schema</li>
<li>ä¸å†éœ€è¦JavaScriptæ£€æŸ¥å¹³å°ï¼Œè·³è½¬ä¹Ÿä¸éœ€è¦jså»åšç‰¹å®šå¤„ç†</li>
<li>æ¯”schemeæ›´çµæ´»æ›´å®‰å…¨çš„åŒ¹é…URLè·³è½¬</li>
</ul>
<p>æ³¨æ„ï¼šä¸èƒ½ä½¿ç”¨æ¨¡æ‹Ÿå™¨è°ƒè¯•</p>
</blockquote>
<p><img src="https://s3-eu-west-1.amazonaws.com/hoko-blog/universal_links.png" alt="image"></p>
<blockquote>
<p>å·¥ä½œåŸç†ï¼šWhen the app is installed, the system downloads and verifies the site association file for each of its associated domains. If the verification is successful, the app is associated with the domain.</p>
</blockquote>
<h4 id="Configure_your_file_server">Configure your file server</h4><ul>
<li><a href="https://api-pre.51offer.com/apple-app-site-association" target="_blank" rel="external">æˆ‘ä»¬çš„æ ¹è·¯å¾„é…ç½®æ–‡ä»¶</a></li>
<li><a href="https://branch.io/resources/universal-links/" target="_blank" rel="external">æ ¹è·¯å¾„é…ç½®æœ‰æ•ˆæ€§éªŒè¯</a><h5 id="è¦æ±‚å¦‚ä¸‹ï¼š">è¦æ±‚å¦‚ä¸‹ï¼š</h5><blockquote>
<p>Alright! So you have your signed apple-app-site-association file. Now you just need to configure your file server to host this for you. There are a few caveats:</p>
</blockquote>
</li>
<li>It must be sent with the header â€˜application/pkcs7-mimeâ€™</li>
<li>It must be sent from the endpoint youdomain.com/apple-app-site-association</li>
<li>It must return a 200 http code.</li>
</ul>
<blockquote>
<p>We set up the one for all Branch integrated apps using our Node+Express link servers. Hereâ€™s the code we used in case thatâ€™s helpful:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aasa = fs.readFileSync(__dirname + <span class="string">'/static/apple-app-site-association'</span>);</span><br><span class="line">app.get(<span class="string">'/apple-app-site-association'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">     res.set(<span class="string">'Content-Type'</span>, <span class="string">'application/pkcs7-mime'</span>);</span><br><span class="line">     res.status(<span class="number">200</span>).send(aasa);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>å¯ä»¥ä»åŸæœ‰çš„schemeè¿‡æ¸¡è¿‡æ¥<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application openURL:(<span class="built_in">NSURL</span> *)url sourceApplication:(<span class="built_in">NSString</span> *)sourceApplication annotation:(<span class="keyword">id</span>)annotation &#123;</span><br><span class="line">    [<span class="keyword">self</span> handleRouting:url];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application continueUserActivity:(<span class="built_in">NSUserActivity</span> *)userActivity restorationHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSArray</span> *))restorationHandler &#123;</span><br><span class="line">    <span class="keyword">if</span> ([userActivity<span class="variable">.activityType</span> isEqualToString:<span class="built_in">NSUserActivityTypeBrowsingWeb</span>]) &#123;</span><br><span class="line">        [<span class="keyword">self</span> handleRouting:userActivity<span class="variable">.webpageURL</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)handleRouting:(<span class="built_in">NSURL</span> *)url &#123;</span><br><span class="line">....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>è§†é¢‘</strong>ä¼˜å…ˆæ¨è<br><a href="https://developer.apple.com/videos/play/wwdc2015/509/" target="_blank" rel="external">https://developer.apple.com/videos/play/wwdc2015/509/</a></p>
<p><strong>ä¼˜ç§€åšå®¢</strong><br><a href="https://blog.branch.io/how-to-setup-universal-links-to-deep-link-on-apple-ios-9" target="_blank" rel="external">https://blog.branch.io/how-to-setup-universal-links-to-deep-link-on-apple-ios-9</a></p>
<p><a href="https://blog.branch.io/ios-9.2-deep-linking-guide-transitioning-to-universal-links" target="_blank" rel="external">https://blog.branch.io/ios-9.2-deep-linking-guide-transitioning-to-universal-links</a></p>
<p><a href="http://blog.hokolinks.com/how-to-implement-apple-universal-links-on-ios-9/" target="_blank" rel="external">http://blog.hokolinks.com/how-to-implement-apple-universal-links-on-ios-9/</a></p>
<p><strong>å¯èƒ½å‡ºç°çš„bug</strong>ï¼ˆå·¨å‘ï¼Œä¹Ÿå¯èƒ½æ˜¯é…ç½®é—®é¢˜ï¼‰<br><a href="http://stackoverflow.com/questions/32751225/ios9-universal-links-does-not-work" target="_blank" rel="external">http://stackoverflow.com/questions/32751225/ios9-universal-links-does-not-work</a></p>
<h2 id="ç»“åˆå®ä¾‹ä»‹ç»_nginx_é…ç½®_-_æ›¾é“­">ç»“åˆå®ä¾‹ä»‹ç» nginx é…ç½® - æ›¾é“­</h2><h3 id="é»˜è®¤é…ç½®">é»˜è®¤é…ç½®</h3><p>DNS, nginx, tomcat, application</p>
<p><a href="https://api-pre.51offer.com/mobile/user/login" target="_blank" rel="external">https://api-pre.51offer.com/mobile/user/login</a></p>
<p>DNS: api-pre.51offer.com(host) -&gt; IP(nginx)</p>
<p>nginx: IP(nginx):80 -&gt; IP(tomcat):8080</p>
<p>tomcat: /mobile</p>
<p>application: /user/login (controller, function)</p>
<p>çœ‹ nginx é…ç½®</p>
<h3 id="ä¸¤ä¸ªé—®é¢˜">ä¸¤ä¸ªé—®é¢˜</h3><h4 id="è°ƒè¯•_Universal_Link">è°ƒè¯• Universal Link</h4><p><a href="https://api-pre.51offer.com/xyz.html" target="_blank" rel="external">https://api-pre.51offer.com/xyz.html</a><br><a href="https://api-pre.51offer.com/apple-site-app-config" target="_blank" rel="external">https://api-pre.51offer.com/apple-site-app-config</a></p>
<ul>
<li>è°ƒæ•´ tomcat content_path <a href="http://gitlab.51offer.inner/tool/tool-tms/commit/24b8c6f69ea0029b8cea8b7cbc46f3c2f355271d" target="_blank" rel="external">http://gitlab.51offer.inner/tool/tool-tms/commit/24b8c6f69ea0029b8cea8b7cbc46f3c2f355271d</a></li>
<li>è°ƒæ•´ application é™æ€æ–‡ä»¶è·¯å¾„</li>
<li>æ”¹ header: nginx</li>
</ul>
<h3 id="çº¿ä¸Š_fixbug">çº¿ä¸Š fixbug</h3><p><a href="http://www.51offer.com/aboutus/server.html?in_app=1" target="_blank" rel="external">http://www.51offer.com/aboutus/server.html?in_app=1</a></p>
<p>api.51offer.com</p>
<p><a href="https://api.51offer.com/aboutus/server.html?in_app=1" target="_blank" rel="external">https://api.51offer.com/aboutus/server.html?in_app=1</a><br><a href="https://api.51offer.com/aboutus/protocol.html?in_app=1" target="_blank" rel="external">https://api.51offer.com/aboutus/protocol.html?in_app=1</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«/">ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬60æœŸ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/22/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬60æœŸ/" class="article-date">
  	<time datetime="2016-07-22T14:45:00.000Z" itemprop="datePublished">2016-07-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/22/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬60æœŸ/">ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬60æœŸ</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="å¾®ä¿¡-æ”¯ä»˜å®-é“¶è”æ”¯ä»˜å¯¹æ¯”_-_ç‹èƒœ">å¾®ä¿¡-æ”¯ä»˜å®-é“¶è”æ”¯ä»˜å¯¹æ¯” - ç‹èƒœ</h2><h3 id="å¾®ä¿¡æ”¯ä»˜"><a href="https://pay.weixin.qq.com" target="_blank" rel="external">å¾®ä¿¡æ”¯ä»˜</a></h3><h4 id="ä¸šåŠ¡æµç¨‹"><a href="https://pay.weixin.qq.com/wiki/doc/api/app/app.php?chapter=8_3" target="_blank" rel="external">ä¸šåŠ¡æµç¨‹</a></h4><p><img src="https://pay.weixin.qq.com/wiki/doc/api/img/chapter8_3_1.png" alt="pay-weixin-timeline"></p>
<h3 id="æ”¯ä»˜å®"><a href="https://open.alipay.com" target="_blank" rel="external">æ”¯ä»˜å®</a></h3><h4 id="ä¸šåŠ¡æµç¨‹-1"><a href="https://doc.open.alipay.com/doc2/detail.htm?spm=a219a.7629140.0.0.8NhMga&amp;treeId=59&amp;articleId=103658&amp;docType=1" target="_blank" rel="external">ä¸šåŠ¡æµç¨‹</a></h4><p><img src="https://img.alicdn.com/top/i1/LB1n8NYKVXXXXbbXpXXXXXXXXXX" alt="pay-alipay-timeline"></p>
<h3 id="é“¶è”"><a href="https://open.unionpay.com" target="_blank" rel="external">é“¶è”</a></h3><h4 id="ä¸šåŠ¡æµç¨‹-2"><a href="https://open.unionpay.com/ajweb/product/detail?id=3" target="_blank" rel="external">ä¸šåŠ¡æµç¨‹</a></h4><p><img src="https://open.unionpay.com/upload/image/1416394316921062523.png" alt="pay-unionpay-timeline"></p>
<h3 id="ç»“è®º">ç»“è®º</h3><table>
<thead>
<tr>
<th style="text-align:left">æ”¯ä»˜å¹³å°</th>
<th style="text-align:left">æµç¨‹å›¾</th>
<th style="text-align:left">æ–‡æ¡£</th>
<th style="text-align:left">æ¥å£è®¾è®¡</th>
<th style="text-align:left">demo</th>
<th style="text-align:left">æµ‹è¯•ç›¸å…³</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">å¾®ä¿¡</td>
<td style="text-align:left">&hearts;&hearts;&hearts;&hearts;&hearts;</td>
<td style="text-align:left">&hearts;&hearts;&hearts;&hearts;&hearts;</td>
<td style="text-align:left">&hearts;&hearts;&hearts;&hearts;&hearts;</td>
<td style="text-align:left">&hearts;&hearts;&hearts;</td>
<td style="text-align:left">&hearts;&hearts;&hearts;&hearts;</td>
</tr>
<tr>
<td style="text-align:left">æ”¯ä»˜å®</td>
<td style="text-align:left">&hearts;&hearts;&hearts;&hearts;</td>
<td style="text-align:left">&hearts;&hearts;&hearts;</td>
<td style="text-align:left">&hearts;&hearts;&hearts;&hearts;</td>
<td style="text-align:left">&hearts;&hearts;</td>
<td style="text-align:left">&hearts;&hearts;</td>
</tr>
<tr>
<td style="text-align:left">é“¶è”</td>
<td style="text-align:left">&hearts;&hearts;&hearts;</td>
<td style="text-align:left">&hearts;&hearts;</td>
<td style="text-align:left">&hearts;&hearts;</td>
<td style="text-align:left">&hearts;&hearts;</td>
<td style="text-align:left">&hearts;&hearts;&hearts;&hearts;</td>
</tr>
</tbody>
</table>
<p>è¯´æ˜ï¼š</p>
<ul>
<li><p>è·¯ç¨‹å›¾</p>
<p>ä»å…¨é¢æ€§å’Œå®Œæ•´æ€§çœ‹ï¼Œå¾®ä¿¡ &gt; æ”¯ä»˜å® &gt; é“¶è”</p>
</li>
<li><p>æ–‡æ¡£ï¼š</p>
<p>å¾®ä¿¡æ›´ç®€æ´ï¼Œæ¸…æ™°ï¼Œå®Œæ•´ï¼›å…¶ä»–ä¸¤å®¶è¿˜æ˜¯ç›¸å¯¹ä¼ ç»Ÿçš„é£æ ¼ï¼Œå°¤å…¶æ˜¯é“¶è”</p>
</li>
<li><p>æ¥å£è®¾è®¡ï¼š</p>
<p>å¾®ä¿¡çš„æ¥å£è®¾è®¡æ›´ç®€æ´çµæ´»æ˜“ç”¨ï¼Œæ”¯ä»˜å®æ¬¡ä¹‹ï¼Œé“¶è”çš„å­—æ®µè¯´æ˜å¦ç±»ã€‚</p>
</li>
<li><p>demo:</p>
<p>å¾®ä¿¡demoè¿˜ç®—æ¸…æ¥šï¼Œä½†æ˜¯ç¾ä¸­ä¸è¶³é¡¹ç›®ç¼–ç éutf-8ï¼Œè¿˜å¾—ç”¨Notepad++æ‰æ­£ç¡®ç¼–ç æ˜¾ç¤ºï¼›æ”¯ä»˜å®å’Œé“¶è”çš„demoçœ‹èµ·æ¥æ™•ã€‚</p>
</li>
<li><p>æµ‹è¯•ï¼š</p>
<p>å¾®ä¿¡çš„æµ‹è¯•ç¯å¢ƒæ˜¯é€šè¿‡æ·»åŠ æ²™ç®±sandboxè·¯å¾„å®ç°ï¼›å¦å¤–ï¼Œå¾®ä¿¡æä¾›äº†æµ‹è¯•ç”¨ä¾‹ï¼Œèµä¸€ä¸ªã€‚æ”¯ä»˜å®æ²¡æœ‰çœ‹åˆ°æœ‰æµ‹è¯•ç¯å¢ƒã€‚é“¶è”åœ¨sdkçš„APIå‚æ•°ä¸­ï¼Œæä¾›äº†ç¯å¢ƒå‚æ•°è®¾ç½®ã€‚</p>
</li>
</ul>
<h2 id="iOSå“åº”è€…é“¾ä¸hit-testing_-_åˆ˜åº·">iOSå“åº”è€…é“¾ä¸hit-testing - åˆ˜åº·</h2><p>ä»Šå¤©æˆ‘ä»¬æ¥æ¢ç´¢ä¸€ä¸‹ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»å¾®ä¿¡æ‰«ä¸€æ‰«å°±èƒ½æ‰“å¼€æ‰«ç è§†å›¾ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»å±å¹•çš„æ—¶å€™ã€‚èƒŒåå‘ç”Ÿäº†äº›ä»€ä¹ˆï¼Ÿ</p>
<p>å½“ç”¨æˆ·é€šè¿‡ä»¥ä¸Šæ–¹å¼è§¦å‘ä¸€ä¸ªäº‹ä»¶æ—¶ï¼Œä¼šå°†ç›¸åº”çš„äº‹ä»¶å¯¹è±¡æ·»åŠ åˆ°<code>UIApplication</code>çš„äº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚<code>UIApplication</code>ä¼šå¾ªç¯çš„ä»é˜Ÿåˆ—ä¸­æ‹¿å‡ºç¬¬ä¸€ä¸ªäº‹ä»¶æ¥å¤„ç†ã€‚é¦–å…ˆå°†è¯¥äº‹ä»¶åˆ†å‘ç»™<code>UIApplication</code>çš„ä¸»çª—å£å¯¹è±¡(<strong>KeyWindow</strong>)ï¼Œç„¶åç”±ä¸»çª—å£å†³å®šå¦‚ä½•å°†äº‹ä»¶äº¤ç»™æœ€åˆé€‚çš„å“åº”è€…(<code>UIResponder</code>)æ¥å¤„ç†å–å†³äºäº‹ä»¶çš„ç±»å‹ã€‚è¿™é‡Œä¸»è¦åˆ†ä¸¤ç§æƒ…å†µï¼š</p>
<h3 id="è§¦æ‘¸äº‹ä»¶">è§¦æ‘¸äº‹ä»¶</h3><p><code>UIApplication</code>é€šè¿‡ä¸€ä¸ªè§¦æ‘¸æ£€æµ‹æ¥å†³å®šæœ€åˆé€‚æ¥å¤„ç†è¯¥äº‹ä»¶çš„å“åº”è€…ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå“åº”è€…æ˜¯<code>UIView</code>å¯¹è±¡ã€‚<br>å¯¹äºè§¦æ‘¸äº‹ä»¶ï¼Œwindowå¯¹è±¡ä¼šå°è¯•ç€é¦–å…ˆå°†äº‹ä»¶ä¼ é€’ç»™è§¦æ‘¸äº‹ä»¶å‘ç”Ÿç‚¹å¾—Viewã€‚è¿™ä¸ªViewè¢«è§†ä¸ºâ€œ<code>å‘½ä¸­æµ‹è¯•view</code>â€ (hit-test view)ã€‚</p>
<h3 id="æ‰‹åŠ¿å’Œè¿œç¨‹æ§åˆ¶äº‹ä»¶">æ‰‹åŠ¿å’Œè¿œç¨‹æ§åˆ¶äº‹ä»¶</h3><p>UIApplicationå¯»æ‰¾UIWindowä¸­çš„ç¬¬ä¸€å“åº”è€…ã€‚æ‰¾åˆ°ç¬¬ä¸€å“åº”è€…(<code>The First Responder</code>)åï¼Œä¼šå°†è¯¥äº‹ä»¶å¯¹è±¡æ´¾å‘ç»™è¯¥å“åº”è€…ä»¥ä¾¿å¤„ç†ã€‚</p>
<h3 id="äº‹ä»¶ä¼ é€’å“åº”é“¾">äº‹ä»¶ä¼ é€’å“åº”é“¾</h3><p>æœ€ç»ˆæ‰€æœ‰çš„äº‹ä»¶å“åº”è·¯å¾„éƒ½æ˜¯ä¸ºäº†å»å¯»æ‰¾é‚£ä¸ªèƒ½å¤Ÿå“åº”å¹¶å¤„ç†è¯¥äº‹ä»¶çš„å¯¹è±¡ã€‚å› æ­¤ï¼ŒUIkitä¼šé¦–å…ˆå‘é€è¯¥äº‹ä»¶ç»™æœ€é€‚åˆå¤„ç†è¯¥äº‹ä»¶çš„å¯¹è±¡ã€‚å¯¹äºè§¦æ‘¸äº‹ä»¶ï¼Œè¿™ä¸ªæœ€é€‚åˆå¤„ç†çš„å¯¹è±¡å°±æ˜¯ hit-test viewæ—¢â€œå‘½ä¸­æµ‹è¯•viewâ€,å¹¶ä¸”å¯¹äºå…¶å®ƒäº‹ä»¶ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯â€œç¬¬ä¸€å“åº”è€…â€ã€‚</p>
<h4 id="å‘½ä¸­æµ‹è¯•è¿”å›è§¦æ‘¸äº‹ä»¶å‘ç”Ÿç‚¹çš„view">å‘½ä¸­æµ‹è¯•è¿”å›è§¦æ‘¸äº‹ä»¶å‘ç”Ÿç‚¹çš„view</h4><p>ç³»ç»Ÿæ£€æµ‹åˆ°æ‰‹æŒ‡è§¦æ‘¸(<code>Touch</code>)æ“ä½œæ—¶ä¼šå°†å…¶æ”¾å…¥å½“å‰æ´»åŠ¨Applicationçš„äº‹ä»¶é˜Ÿåˆ—ï¼ŒUIApplicationä¼šä»äº‹ä»¶é˜Ÿåˆ—ä¸­å–å‡ºè§¦æ‘¸äº‹ä»¶å¹¶ä¼ é€’ç»™<code>key window</code>å¤„ç†,windowå¯¹è±¡é¦–å…ˆä¼šä½¿ç”¨<code>hitTest:withEvent:</code>æ–¹æ³•å¯»æ‰¾æ­¤æ¬¡Touchæ“ä½œåˆå§‹ç‚¹æ‰€åœ¨çš„è§†å›¾(View),å³éœ€è¦å°†è§¦æ‘¸äº‹ä»¶ä¼ é€’ç»™å…¶å¤„ç†çš„è§†å›¾:</p>
<p>ä¸ºäº†å»é˜æ˜è¿™ä¸ªè¿‡ç¨‹ï¼Œå‡è®¾ç”¨æˆ·è§¦æ‘¸ view E å¦‚å›¾æ‰€ç¤ºã€‚iOSä¼šä»¥è¿™æ ·çš„é¡ºåºå»å¯»æ‰¾å‘½ä¸­æµ‹è¯•viewé€šè¿‡æ£€æµ‹æ‰€æœ‰çš„å­view.<br><img src="http://oaclergq7.bkt.clouddn.com/hit-testing.png" alt="Alt text"></p>
<ol>
<li><p>è§¦æ‘¸ç‚¹æ˜¯å¦åœ¨view Açš„è¾¹ç•Œä¹‹å†…ï¼Œå¦‚æœæ˜¯å®ƒä¼šæ£€æµ‹å­è§†å›¾Bå’ŒC.</p>
</li>
<li><p>è§¦æ‘¸ç‚¹ä¸åœ¨view Bçš„è¾¹ç•Œä¹‹å†…ï¼Œä½†æ˜¯å®ƒåœ¨view Cçš„è¾¹ç•Œä¹‹å†…ï¼Œå› æ­¤å®ƒå°±å»æ£€æµ‹Cçš„å­è§†å›¾Då’ŒEã€‚</p>
</li>
<li><p>è§¦æ‘¸äº‹ä»¶ä¸åœ¨view Dçš„è¾¹ç•Œä¹‹å†…ï¼Œä½†æ˜¯åœ¨view Eçš„è¾¹ç•Œä¹‹å†…ã€‚view Eæ˜¯æ•´ä¸ªåŒ…å«è§¦æ‘¸äº‹ä»¶çš„viewå±‚çº§ä¸­æœ€åº•ç«¯çš„viewï¼Œå› æ­¤view Eå°±åæ­£è¨€é¡ºçš„æˆä¸ºäº†â€œå‘½ä¸­æµ‹è¯•viewâ€ã€‚</p>
</li>
</ol>
<p><strong>ä¾‹å¤–</strong><br>ä¸æ»¡è¶³ä¸€ä¸‹ä¸‰ä¸ªæ¡ä»¶çš„Responderæ˜¯ä¸èƒ½æ¥æ”¶è§¦æ‘¸äº‹ä»¶çš„ï¼š</p>
<ul>
<li>ä¸å…è®¸äº¤äº’ï¼šuserInteractionEnabled = NO</li>
<li>éšè—ï¼šå¦‚æœæŠŠçˆ¶æ§ä»¶éšè—ï¼Œé‚£ä¹ˆå­æ§ä»¶ä¹Ÿä¼šéšè—ï¼Œéšè—çš„æ§ä»¶ä¸èƒ½æ¥å—äº‹ä»¶</li>
<li>é€æ˜åº¦ï¼šå¦‚æœè®¾ç½®ä¸€ä¸ªæ§ä»¶çš„é€æ˜åº¦&lt;0.01ï¼Œä¼šç›´æ¥å½±å“å­æ§ä»¶çš„é€æ˜åº¦ã€‚alphaï¼š0.0~0.01ä¸ºé€æ˜ã€‚</li>
</ul>
<p><strong>æ³¨æ„ç‚¹</strong><br>ä¸€ä¸ªè§¦æ‘¸äº‹ä»¶å¯¹è±¡å°†ä¼šè¢«å…³è”äºå‘½ä¸­æµ‹è¯•viewçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œå³ä½¿è¿™ä¸ªè§¦æ‘¸åæ¥ç§»åˆ°äº†viewçš„è¾¹ç•Œä¹‹å¤–ã€‚</p>
<h3 id="å®ä¾‹">å®ä¾‹</h3><ol>
<li>åœ¨æ­¤ä¾‹å­ä¸­button,scrollviewåŒä¸ºtopViewçš„å­è§†å›¾ï¼Œä½†scrollviewè¦†ç›–åœ¨buttonä¹‹ä¸Šï¼Œè¿™æ ·åœ¨åœ¨buttonä¸Šçš„è§¦æ‘¸æ“ä½œè¿”å›çš„hit-test viewä¸ºscrollview,buttonæ— æ³•å“åº”ï¼Œå¯ä»¥ä¿®æ”¹topViewçš„hitTest:withEvent:æ–¹æ³•å¦‚ä¸‹:</li>
</ol>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">UIView</span> *)hitTest:(<span class="type">CGPoint</span>)point withEvent:(<span class="type">UIEvent</span> *)event</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">UIView</span>* <span class="literal">result</span> = [super hitTest:point withEvent:event];</span><br><span class="line">    <span class="type">CGPoint</span> buttonPoint = [_checkedButton convertPoint:point fromView:self];</span><br><span class="line">    <span class="keyword">if</span> ([_checkedButton pointInside:buttonPoint withEvent:event]) &#123;</span><br><span class="line">        <span class="keyword">return</span> _checkedButton;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>æ”¾å¼ƒè‡ªèº«å“åº”ï¼Œè®©å­è§†å›¾å»å“åº”äº‹ä»¶ï¼š</li>
</ol>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIView</span>*)hitTest:(<span class="built_in">CGPoint</span>)point withEvent:(<span class="built_in">UIEvent</span> *)event&#123;</span><br><span class="line">    <span class="comment">//å½“äº‹ä»¶æ˜¯ä¼ é€’ç»™æ­¤Viewå†…éƒ¨çš„å­Viewæ—¶ï¼Œè®©å­Viewè‡ªå·±æ•è·äº‹ä»¶ï¼Œå¦‚æœæ˜¯ä¼ é€’ç»™æ­¤Viewè‡ªå·±æ—¶ï¼Œæ”¾å¼ƒäº‹ä»¶æ•è·</span></span><br><span class="line">    <span class="built_in">UIView</span>* __tmpView = [<span class="keyword">super</span> hitTest:point withEvent:event];</span><br><span class="line">    <span class="keyword">if</span> (__tmpView == <span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> __tmpView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>æ‰©å¤§æŒ‰é’®å¯ç‚¹å‡»åŒºåŸŸï¼š</li>
</ol>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIView</span>*)hitTest:(<span class="built_in">CGPoint</span>) point withEvent:(<span class="built_in">UIEvent</span>*) event</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">CGRect</span> rect = [<span class="keyword">self</span> enlargedRect];</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">CGRectEqualToRect</span>(rect, <span class="keyword">self</span><span class="variable">.bounds</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="keyword">super</span> hitTest:point withEvent:event];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">CGRectContainsPoint</span>(rect, point) ? <span class="keyword">self</span> : <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åŠ é€Ÿåº“åœ¨æ•°å­¦è¿ç®—ä¸­çš„ä½¿ç”¨_-_æ¨å¿—å¹³">åŠ é€Ÿåº“åœ¨æ•°å­¦è¿ç®—ä¸­çš„ä½¿ç”¨ - æ¨å¿—å¹³</h2><p>@(iOS)[åŠ é€Ÿ|Accelerate]</p>
<blockquote>
<p>é™¤äº†åŠ å‡ä¹˜é™¤å¤–è¿˜æœ‰å¥½å¤šå¥½å¤šæ•°å­¦è¿ç®—éœ€è¦æˆ‘ä»¬å¤„ç†ï¼Œä½†æˆ‘ä»¬å¾ˆå¤šéƒ½æ²¡æœ‰ç”¨åˆ°ï¼Œæ„Ÿè§‰lowçˆ†äº†</p>
</blockquote>
<h3 id="Appleï¼šåŠ é€Ÿæ¡†æ¶æ–‡æ¡£"><a href="https://developer.apple.com/library/ios/documentation/Accelerate/Reference/vDSPRef/index.html#//apple_ref/doc/uid/TP40009464-CH13-12342" target="_blank" rel="external">Appleï¼šåŠ é€Ÿæ¡†æ¶æ–‡æ¡£</a></h3><blockquote>
<p>Any time youâ€™ve got to make some numbers happen, itâ€™s probably worth it to consider using Accelerate</p>
</blockquote>
<h3 id="ç¤ºä¾‹">ç¤ºä¾‹</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨¡æ‹Ÿéšæœºæ•°æ®</span></span><br><span class="line"><span class="keyword">var</span> doubles  = (<span class="number">0</span>...<span class="number">10000</span>).<span class="built_in">map</span> &#123;<span class="number">_</span> <span class="keyword">in</span> <span class="type">Double</span>(arc4random()%<span class="number">10000</span>)&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ±‚å’Œ</span></span><br><span class="line"><span class="comment">// å¸¸è§çš„åŠ æ³•æ±‚å’Œ</span></span><br><span class="line"><span class="keyword">let</span> reduceSum = doubles.<span class="built_in">reduce</span>(<span class="number">0</span>) &#123; $<span class="number">0</span>+$<span class="number">1</span> &#125;</span><br><span class="line"><span class="comment">// Accelerate å°è£…</span></span><br><span class="line"><span class="keyword">let</span> accSum = sum(doubles)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ±‚æœ€å¤§å€¼ï¼ˆæœ€å°å€¼ä¹Ÿä¸€æ ·ï¼‰</span></span><br><span class="line"><span class="keyword">let</span> maxOfArr = <span class="built_in">max</span>(doubles)</span><br><span class="line"><span class="keyword">let</span> maxOfArr2 = doubles.<span class="built_in">sort</span>(&gt;).first</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¹³å‡å€¼,å“ˆå“ˆå¤§æ•°æ®ç»Ÿè®¡ï¼Œå¯ä»¥æµ‹è¯•å‡†ç¡®ç‡</span></span><br><span class="line"><span class="keyword">let</span> meanValue = mean(doubles)</span><br><span class="line"><span class="keyword">let</span> meanValue2 = doubles.<span class="built_in">reduce</span>(<span class="number">0</span>) &#123; $<span class="number">0</span> + $<span class="number">1</span>/<span class="type">Double</span>(doubles.<span class="built_in">count</span>) &#125;</span><br><span class="line">meanValue2</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘é‡åŠ å‡ä¹˜ç§¯</span></span><br><span class="line"><span class="keyword">let</span> vector1 = [<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>] <span class="keyword">as</span> [<span class="type">Double</span>]</span><br><span class="line"><span class="keyword">let</span> vector2 = [<span class="number">3</span>,<span class="number">5</span>,<span class="number">2</span>] <span class="keyword">as</span> [<span class="type">Double</span>]</span><br><span class="line"><span class="keyword">let</span> sumArrs = add(vector1, y: vector2)</span><br></pre></td></tr></table></figure>
<p>è€—æ—¶ä¸Šå¯¹æ¯”æ˜¯ä¸æ˜¯<code>reduceï¼Œmap</code>ç­‰ç³»ç»Ÿçš„é«˜é˜¶å‡½æ•°è¢«<code>â€œåŠ é€Ÿåº“â€</code>ç§’äº†ï¼Œä½†ä½¿ç”¨ä¸Šè²Œä¼¼reduceï¼Œmapæ˜¯æ¯”è¾ƒçµæ´»çš„<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">let</span> newReduceSum = (<span class="number">0</span>...<span class="number">1000</span>).reduce(<span class="number">0</span>) &#123; <span class="variable">$0</span>+<span class="variable">$1</span> &#125;</span><br><span class="line">newReduceSum</span><br></pre></td></tr></table></figure></p>
<h3 id="å…¶ä»–è®¡ç®—çš„ä¸€ç‚¹çš„åº”ç”¨">å…¶ä»–è®¡ç®—çš„ä¸€ç‚¹çš„åº”ç”¨</h3><blockquote>
<p>å‡½æ•°æ··åˆç¤ºä¾‹: ä½¿ç”¨ä¸­æ–‡å˜é‡ğŸ˜„</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> å‡½æ•°ç‚¹é˜µå¯†åº¦ = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> é¢‘ç‡<span class="number">1</span> = <span class="number">4.0</span></span><br><span class="line"><span class="keyword">let</span> ç›¸ä½<span class="number">1</span> = <span class="number">0.0</span></span><br><span class="line"><span class="keyword">let</span> å¹…åº¦<span class="number">1</span> = <span class="number">1.0</span></span><br><span class="line"><span class="keyword">let</span> æ­£å¼¦å‡½æ•°<span class="number">1</span> = (<span class="number">0</span>..&lt;å‡½æ•°ç‚¹é˜µå¯†åº¦).<span class="built_in">map</span> &#123;</span><br><span class="line">    å¹…åº¦<span class="number">1</span> * sin(<span class="number">2.0</span> * <span class="type">M_PI</span> / <span class="type">Double</span>(å‡½æ•°ç‚¹é˜µå¯†åº¦) * <span class="type">Double</span>($<span class="number">0</span>) * é¢‘ç‡<span class="number">1</span> + ç›¸ä½<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> é¢‘ç‡<span class="number">2</span> = <span class="number">1.0</span></span><br><span class="line"><span class="keyword">let</span> ç›¸ä½<span class="number">2</span> = <span class="type">M_PI</span> / <span class="number">2.0</span></span><br><span class="line"><span class="keyword">let</span> å¹…åº¦<span class="number">2</span> = <span class="number">2.0</span></span><br><span class="line"><span class="keyword">let</span> æ­£å¼¦å‡½æ•°<span class="number">2</span> = (<span class="number">0</span>..&lt;å‡½æ•°ç‚¹é˜µå¯†åº¦).<span class="built_in">map</span> &#123;</span><br><span class="line">    å¹…åº¦<span class="number">2</span> * sin(<span class="number">2.0</span> * <span class="type">M_PI</span> / <span class="type">Double</span>(å‡½æ•°ç‚¹é˜µå¯†åº¦) * <span class="type">Double</span>($<span class="number">0</span>) * é¢‘ç‡<span class="number">2</span> + ç›¸ä½<span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> é¢‘ç‡<span class="number">3</span> = <span class="number">10.0</span></span><br><span class="line"><span class="keyword">let</span> ç›¸ä½<span class="number">3</span> = <span class="type">M_PI</span> / <span class="number">3.0</span></span><br><span class="line"><span class="keyword">let</span> å¹…åº¦<span class="number">3</span> = <span class="number">4.0</span></span><br><span class="line"><span class="keyword">let</span> æ­£å¼¦å‡½æ•°<span class="number">3</span> = (<span class="number">0</span>..&lt;å‡½æ•°ç‚¹é˜µå¯†åº¦).<span class="built_in">map</span> &#123;</span><br><span class="line">    å¹…åº¦<span class="number">3</span> * sin(<span class="number">2.0</span> * <span class="type">M_PI</span> / <span class="type">Double</span>(å‡½æ•°ç‚¹é˜µå¯†åº¦) * <span class="type">Double</span>($<span class="number">0</span>) * é¢‘ç‡<span class="number">3</span> + ç›¸ä½<span class="number">3</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> æ–°å‡½æ•°<span class="number">1</span> = add(æ­£å¼¦å‡½æ•°<span class="number">1</span>, y: æ­£å¼¦å‡½æ•°<span class="number">2</span>)</span><br><span class="line"><span class="keyword">let</span> æ–°å‡½æ•°<span class="number">2</span> = add(æ–°å‡½æ•°<span class="number">1</span>, y: æ­£å¼¦å‡½æ•°<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Xcode åˆ†æ æŸ¥çœ‹å›¾å½¢æ’å¸ƒï¼Œå°¤å…¶æ˜¯æ–°å‡½æ•°çš„å›¾å½¢</span></span><br><span class="line">æ–°å‡½æ•°<span class="number">1</span>.forEach &#123; <span class="type">XCPlaygroundPage</span>.currentPage.captureValue($<span class="number">0</span>, withIdentifier:<span class="string">"æ–°å‡½æ•°1"</span>) &#125;</span><br><span class="line">æ–°å‡½æ•°<span class="number">2</span>.forEach &#123; <span class="type">XCPlaygroundPage</span>.currentPage.captureValue($<span class="number">0</span>, withIdentifier:<span class="string">"æ–°å‡½æ•°2"</span>) &#125;</span><br><span class="line"></span><br><span class="line">æ­£å¼¦å‡½æ•°<span class="number">2</span>.forEach &#123; <span class="type">XCPlaygroundPage</span>.currentPage.captureValue($<span class="number">0</span>, withIdentifier:<span class="string">"æ­£å¼¦å‡½æ•°2"</span>) &#125;</span><br><span class="line"></span><br><span class="line">æ­£å¼¦å‡½æ•°<span class="number">1</span>.forEach &#123; <span class="type">XCPlaygroundPage</span>.currentPage.captureValue($<span class="number">0</span>, withIdentifier:<span class="string">"æ­£å¼¦å‡½æ•°1"</span>) &#125;</span><br></pre></td></tr></table></figure>
<h4 id="å‚…é‡Œå¶å˜æ¢é€šä¿—ç¯‡è®²è§£">å‚…é‡Œå¶å˜æ¢é€šä¿—ç¯‡<a href="https://www.douban.com/note/164400821" target="_blank" rel="external">è®²è§£</a></h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŸ¥çœ‹å›¾åƒå‘ç°â€˜æ–°å‡½æ•°2â€™å·¦å³æœ‰ä¸‰å¯¹æ³¢å³°ï¼Œå¾—å‡ºå®ƒç”±ä¸‰ä¸ªæ­£å¼¦æ³¢ç»„æˆï¼ˆå¯å¯¹åº”å¾—å‡ºæŒ¯å¹…ã€é¢‘ç‡åŠç›¸ä½ï¼‰</span></span><br><span class="line"><span class="keyword">let</span> å¿«é€Ÿå‚…é‡Œå¶è½¬æ¢ = fft(æ–°å‡½æ•°<span class="number">2</span>)</span><br><span class="line">å¿«é€Ÿå‚…é‡Œå¶è½¬æ¢.forEach &#123; <span class="type">XCPlaygroundPage</span>.currentPage.captureValue($<span class="number">0</span>, withIdentifier:<span class="string">"å¿«é€Ÿå‚…é‡Œå¶è½¬æ¢"</span>) &#125;</span><br></pre></td></tr></table></figure>
<h3 id="çŸ©é˜µè®¡ç®—">çŸ©é˜µè®¡ç®—</h3><blockquote>
<p>å¾ˆå¤šå›¾åƒå¤„ç†æ˜¯æ ¹æ®çŸ©é˜µåšå¤„ç†çš„ï¼Œåƒç´ è¶Šå¤§ï¼Œå¤„ç†æ€§èƒ½è¦æ±‚è¶Šé«˜</p>
</blockquote>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// ç®€å•çŸ©é˜µç¤ºä¾‹</span><br><span class="line"></span><br><span class="line">// â› <span class="number">1</span>  <span class="number">2</span> â      â› <span class="number">3</span>  <span class="number">2</span> â       â› <span class="number">5</span>  <span class="number">6</span> â</span><br><span class="line">// â¢      âŸ  *   â¢      âŸ   =   â¢      âŸ</span><br><span class="line">// â <span class="number">3</span> -<span class="number">4</span> â       â <span class="number">1</span>  <span class="number">2</span> â        â <span class="number">5</span> -<span class="number">2</span> â </span><br><span class="line"></span><br><span class="line">let A = Matrix(<span class="string">[[1, 2], [3, -4]]</span>)</span><br><span class="line">let B = Matrix(<span class="string">[[3, 2], [1, 2]]</span>)</span><br><span class="line">let C = A * B</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// åˆ©ç”¨é€†çŸ©é˜µæ±‚è§£</span><br><span class="line">// â› <span class="number">1</span>  <span class="number">1</span> â        â› <span class="number">3</span> â           â› <span class="number">2</span> â</span><br><span class="line">// â¢      âŸ * CC = â¢   âŸ    CC =   â¢   âŸ</span><br><span class="line">// â <span class="number">1</span> -<span class="number">1</span> â         â <span class="number">1</span> â            â <span class="number">1</span> â </span><br><span class="line"></span><br><span class="line">let AA = Matrix(<span class="string">[[1, 1], [1, -1]]</span>)</span><br><span class="line">let BB = Matrix(<span class="string">[[3], [1]]</span>)</span><br><span class="line">let CC = inv(AA) * BB</span><br></pre></td></tr></table></figure>
<h3 id="åº”ç”¨çš„åŠ é€Ÿåº“å‡½æ•°">åº”ç”¨çš„åŠ é€Ÿåº“å‡½æ•°</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="type">Accelerate</span></span><br><span class="line"></span><br><span class="line">public <span class="func"><span class="keyword">func</span> <span class="title">sum</span><span class="params">(x: [Double])</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> result: <span class="type">Double</span> = <span class="number">0.0</span></span><br><span class="line">    vDSP_sveD(x, <span class="number">1</span>, &amp;result, vDSP_Length(x.<span class="built_in">count</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public <span class="func"><span class="keyword">func</span> <span class="title">max</span><span class="params">(x: [Double])</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> result: <span class="type">Double</span> = <span class="number">0.0</span></span><br><span class="line">    vDSP_maxvD(x, <span class="number">1</span>, &amp;result, vDSP_Length(x.<span class="built_in">count</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public <span class="func"><span class="keyword">func</span> <span class="title">mean</span><span class="params">(x: [Double])</span></span> -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> result: <span class="type">Double</span> = <span class="number">0.0</span></span><br><span class="line">    vDSP_meanvD(x, <span class="number">1</span>, &amp;result, vDSP_Length(x.<span class="built_in">count</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public <span class="func"><span class="keyword">func</span> <span class="title">add</span><span class="params">(x: [Double], y: [Double])</span></span> -&gt; [<span class="type">Double</span>] &#123;</span><br><span class="line">    <span class="keyword">var</span> results = [<span class="type">Double</span>](y)</span><br><span class="line">    cblas_daxpy(<span class="type">Int32</span>(x.<span class="built_in">count</span>), <span class="number">1.0</span>, x, <span class="number">1</span>, &amp;results, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> results</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public <span class="func"><span class="keyword">func</span> <span class="title">fft</span><span class="params">(input: [Double])</span></span> -&gt; [<span class="type">Double</span>] &#123;</span><br><span class="line">    <span class="keyword">var</span> real = [<span class="type">Double</span>](input)</span><br><span class="line">    <span class="keyword">var</span> imaginary = [<span class="type">Double</span>](<span class="built_in">count</span>: input.<span class="built_in">count</span>, repeatedValue: <span class="number">0.0</span>)</span><br><span class="line">    <span class="keyword">var</span> splitComplex = <span class="type">DSPDoubleSplitComplex</span>(realp: &amp;real, imagp: &amp;imaginary)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> length = vDSP_Length(floor(log2(<span class="type">Float</span>(input.<span class="built_in">count</span>))))</span><br><span class="line">    <span class="keyword">let</span> radix = <span class="type">FFTRadix</span>(kFFTRadix2)</span><br><span class="line">    <span class="keyword">let</span> weights = vDSP_create_fftsetupD(length, radix)</span><br><span class="line">    vDSP_fft_zipD(weights, &amp;splitComplex, <span class="number">1</span>, length, <span class="type">FFTDirection</span>(<span class="type">FFT_FORWARD</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> magnitudes = [<span class="type">Double</span>](<span class="built_in">count</span>: input.<span class="built_in">count</span>, repeatedValue: <span class="number">0.0</span>)</span><br><span class="line">    vDSP_zvmagsD(&amp;splitComplex, <span class="number">1</span>, &amp;magnitudes, <span class="number">1</span>, vDSP_Length(input.<span class="built_in">count</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> normalizedMagnitudes = [<span class="type">Double</span>](<span class="built_in">count</span>: input.<span class="built_in">count</span>, repeatedValue: <span class="number">0.0</span>)</span><br><span class="line">    vDSP_vsmulD(sqrt(magnitudes), <span class="number">1</span>, [<span class="number">2.0</span> / <span class="type">Double</span>(input.<span class="built_in">count</span>)], &amp;normalizedMagnitudes, <span class="number">1</span>, vDSP_Length(input.<span class="built_in">count</span>))</span><br><span class="line"></span><br><span class="line">    vDSP_destroy_fftsetupD(weights)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> normalizedMagnitudes</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«/">ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬59æœŸ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/15/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬59æœŸ/" class="article-date">
  	<time datetime="2016-07-15T15:30:00.000Z" itemprop="datePublished">2016-07-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/15/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬59æœŸ/">ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬59æœŸ</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="é—²èŠå‰åç«¯åˆ†ç¦»_-_æ›¾é“­">é—²èŠå‰åç«¯åˆ†ç¦» - æ›¾é“­</h2><ul>
<li>ç°çŠ¶ä¸é—®é¢˜</li>
<li>çœ‹çœ‹å†å²</li>
<li>çœ‹çœ‹æ–¹æ¡ˆ</li>
<li>ä¸€äº›å¯ç¤º</li>
</ul>
<h2 id="å¦‚ä½•ä¼˜é›…çš„è‡ªå®šä¹‰Xib_-_åˆ˜åº·">å¦‚ä½•ä¼˜é›…çš„è‡ªå®šä¹‰Xib - åˆ˜åº·</h2><h4 id="å…ˆåˆ›å»ºä¸€ä¸ªUIViewæ–‡ä»¶å’Œä¸€ä¸ªXibæ–‡ä»¶ï¼Œåœ¨Xibæ–‡ä»¶é‡Œè®¾ç½®å¦‚ä¸‹ï¼š">å…ˆåˆ›å»ºä¸€ä¸ªUIViewæ–‡ä»¶å’Œä¸€ä¸ªXibæ–‡ä»¶ï¼Œåœ¨Xibæ–‡ä»¶é‡Œè®¾ç½®å¦‚ä¸‹ï¼š</h4><ul>
<li>size: Freeform</li>
<li>Status Bar: None</li>
</ul>
<h4 id="ä½¿ç”¨-init(frame:_CGRect)è€Œä¸æ˜¯-awakeFromNib()ï¼š">ä½¿ç”¨<strong><code>-init(frame: CGRect)</code></strong>è€Œä¸æ˜¯<strong><code>-awakeFromNib()</code></strong>ï¼š</h4><p>ä¸ºäº†èƒ½åœ¨Storyboardä¸­ä½¿ç”¨è‡ªå®šä¹‰viewï¼Œéœ€è¦å®ç°<code>initWithCoder</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">    <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line">    setupXib()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">required <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">    <span class="keyword">super</span>.<span class="keyword">init</span>(coder: aDecoder)</span><br><span class="line">    setupXib()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åŠ è½½Xibå…³é”®ä»£ç ">åŠ è½½Xibå…³é”®ä»£ç </h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">loadViewFromNib</span><span class="params">()</span></span> -&gt; <span class="type">UIView</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> bundle = <span class="type">NSBundle</span>(forClass: <span class="keyword">self</span>.<span class="keyword">dynamicType</span>)</span><br><span class="line">    <span class="keyword">let</span> nib = <span class="type">UINib</span>(nibName: <span class="string">"WeiboHeader"</span>, bundle: bundle)</span><br><span class="line">    <span class="keyword">let</span> view = nib.instantiateWithOwner(<span class="keyword">self</span>, options: <span class="literal">nil</span>)[<span class="number">0</span>] <span class="keyword">as</span>! <span class="type">UIView</span></span><br><span class="line">    <span class="keyword">return</span> view</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="è®¾ç½®Xibæ–‡ä»¶çš„Files_Ownerï¼Œè€Œä¸æ˜¯è®¾ç½®Viewçš„Custom_Class">è®¾ç½®<code>Xib</code>æ–‡ä»¶çš„<strong><code>Files Owner</code></strong>ï¼Œè€Œä¸æ˜¯è®¾ç½®Viewçš„<code>Custom Class</code></h4><p>å¦‚æœéœ€è¦UIViewå’ŒXibæ–‡ä»¶å»ºç«‹æ§ä»¶å±æ€§å…³è”ï¼Œæ˜¯è®¾ç½®Xibæ–‡ä»¶çš„File`s Ownerï¼Œè€Œä¸æ˜¯è®¾ç½®Viewçš„Custom Class</p>
<p><img src="http://oaclergq7.bkt.clouddn.com/filesowner.jpg" alt="Image show"><br>è®¾ç½®äº†File`s Ownerå°±å¯ä»¥åƒå¾€å¸¸ä¸€æ ·æ‹–çº¿äº†!</p>
<h4 id="åœ¨Storyboardä¸­ä½¿ç”¨Xib">åœ¨Storyboardä¸­ä½¿ç”¨Xib</h4><p>1.åœ¨SBä¸­åŠ å…¥ä¸€ä¸ªUIViewï¼Œå°†å…¶Classè®¾ç½®æˆ<code>WeiboHeader</code><br>2.ä½¿ç”¨<strong><code>@IBInspectable</code></strong></p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">@IBInspectable var <span class="built_in">background</span>: UIImage? &#123;</span><br><span class="line">    <span class="built_in">get</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> backgroundImageView.<span class="built_in">image</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">set</span> &#123;</span><br><span class="line">        backgroundImageView.<span class="built_in">image</span> = newValue</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@IBInspectable var avatar: UIImage? &#123;</span><br><span class="line">    <span class="built_in">get</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> avatarImageView.<span class="built_in">image</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">set</span> &#123;</span><br><span class="line">        avatarImageView.<span class="built_in">image</span> = newValue</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@IBInspectable var name: <span class="keyword">String</span>? &#123;</span><br><span class="line">    <span class="built_in">get</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> nameLabel.<span class="built_in">text</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">set</span> &#123;</span><br><span class="line">        nameLabel.<span class="built_in">text</span> = newValue</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ äº†<code>@IBInspectable</code>ä¹‹åï¼Œå°±å¯ä»¥åƒç³»ç»Ÿè‡ªå¸¦çš„æ§ä»¶ä¸€æ ·è®¾ç½®å±æ€§äº†~</p>
<h2 id="å•å…ƒæµ‹è¯•_-_å´æ˜">å•å…ƒæµ‹è¯• - å´æ˜</h2><ul>
<li>æ³¨ï¼šåŸºäº<a href="http://chriszou.com/" target="_blank" rel="external">å°åˆ›</a>åˆ†äº«çš„æ€»ç»“</li>
</ul>
<h4 id="æ˜ç¡®æ¦‚å¿µ">æ˜ç¡®æ¦‚å¿µ</h4><ul>
<li>å•å…ƒæµ‹è¯• or é›†æˆæµ‹è¯•ï¼š</li>
<li>å•å…ƒæµ‹è¯•åœ¨<a href="https://zh.wikipedia.org/wiki/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95" target="_blank" rel="external">ç»´åŸºç™¾ç§‘</a>æ˜¯è¿™æ ·å®šä¹‰çš„</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å•å…ƒæµ‹è¯•ï¼ˆè‹±è¯­ï¼š<span class="keyword">Unit</span> Testingï¼‰åˆç§°ä¸ºæ¨¡å—æµ‹è¯•, æ˜¯é’ˆå¯¹ç¨‹åºæ¨¡å—ï¼ˆè½¯ä»¶è®¾è®¡çš„æœ€å°å•ä½ï¼‰æ¥è¿›è¡Œæ­£ç¡®æ€§æ£€éªŒçš„æµ‹è¯•å·¥ä½œã€‚ç¨‹åºå•å…ƒæ˜¯åº”ç”¨çš„æœ€å°å¯æµ‹è¯•éƒ¨ä»¶ã€‚åœ¨è¿‡ç¨‹åŒ–ç¼–ç¨‹ä¸­ï¼Œä¸€ä¸ªå•å…ƒå°±æ˜¯å•ä¸ªç¨‹åºã€å‡½æ•°ã€è¿‡ç¨‹ç­‰ï¼›å¯¹äºé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œæœ€å°å•å…ƒå°±æ˜¯æ–¹æ³•ï¼ŒåŒ…æ‹¬åŸºç±»ï¼ˆè¶…ç±»ï¼‰ã€æŠ½è±¡ç±»ã€æˆ–è€…æ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰ä¸­çš„æ–¹æ³•ã€‚</span><br></pre></td></tr></table></figure>
<p>é›†æˆæµ‹è¯•åœ¨<a href="https://zh.wikipedia.org/wiki/%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95" target="_blank" rel="external">ç»´åŸºç™¾ç§‘</a>çš„å®šä¹‰<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é›†æˆæµ‹è¯•,æ•´åˆæµ‹è¯•åˆç§°ç»„è£…æµ‹è¯•ï¼Œå³å¯¹ç¨‹åºæ¨¡å—é‡‡ç”¨ä¸€æ¬¡æ€§æˆ–å¢æ®–æ–¹å¼ç»„è£…èµ·æ¥ï¼Œå¯¹ç³»ç»Ÿçš„æ¥å£è¿›è¡Œæ­£ç¡®æ€§æ£€éªŒçš„æµ‹è¯•å·¥ä½œã€‚æ•´åˆæµ‹è¯•ä¸€èˆ¬åœ¨å•å…ƒæµ‹è¯•ä¹‹åã€ç³»ç»Ÿæµ‹è¯•ä¹‹å‰è¿›è¡Œã€‚å®è·µè¡¨æ˜ï¼Œæœ‰æ—¶æ¨¡å—è™½ç„¶å¯ä»¥å•ç‹¬å·¥ä½œï¼Œä½†æ˜¯å¹¶ä¸èƒ½ä¿è¯ç»„è£…èµ·æ¥ä¹Ÿå¯ä»¥åŒæ—¶å·¥ä½œ</span><br></pre></td></tr></table></figure></p>
<p>æœ‰æ²¡æœ‰ç†è§£?é‚£æˆ‘ä»¬åœ¨å€Ÿé‰´ä¸‹ã€Šå•å…ƒæµ‹è¯•çš„è‰ºæœ¯ã€‹å¯¹å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•çš„å®šä¹‰ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ä¸ªå•å…ƒæµ‹è¯•æ—¶ä¸€æ®µè‡ªåŠ¨åŒ–çš„ä»£ç ï¼Œè¿™æ®µä»£ç è°ƒç”¨è¢«æµ‹è¯•çš„å·¥ä½œå•å…ƒï¼Œä¹‹åå¯¹è¿™ä¸ªå•å…ƒçš„å•ä¸ªæœ€ç»ˆç»“æœçš„æŸäº›å‡è®¾è¿›è¡Œæ£€éªŒã€‚å•å…ƒæµ‹è¯•å‡ ä¹éƒ½æ˜¯ç”¨å•å…ƒæµ‹è¯•æ¡†æ¶ç¼–å†™ã€‚å•å…ƒæµ‹è¯•å®¹æ˜“ç¼–å†™ï¼Œèƒ½å¿«é€Ÿè¿è¡Œã€‚å•å…ƒæµ‹è¯•å¯é ï¼Œå¯è¯»ï¼Œå¹¶ä¸”å¯ç»´æŠ¤ã€‚åªè¦äº§å“ä»£ç ä¸å‘ç”Ÿå˜åŒ–ï¼Œå•å…ƒæµ‹è¯•çš„ç»“æœæ˜¯ç¨³å®šçš„ã€‚</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é›†æˆæµ‹è¯•æ˜¯å¯¹ä¸€ä¸ªå·¥ä½œå•å…ƒè¿›è¡Œçš„æµ‹è¯•ï¼Œè¿™ä¸ªæµ‹è¯•å¯¹è¢«æµ‹è¯•çš„å·¥ä½œå•å…ƒæ²¡æœ‰å®Œå…¨æ§åˆ¶ï¼Œå¹¶ä½¿ç”¨è¯¥å•å…ƒçš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªçœŸå®ä¾èµ–ç‰©ï¼Œä¾‹å¦‚æ—¶é—´ï¼Œç½‘ç»œï¼Œæ•°æ®åº“ï¼Œçº¿ç¨‹æˆ–éšæœºæ•°äº§ç”Ÿå™¨ç­‰ã€‚</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨åº”è¯¥äº†è§£å§ï¼Œæ²¡æœ‰äº†è§£ä¸è¦ç´§ï¼Œæˆ‘ä»¬å†é€šè¿‡ä»–ä»¬å…³ç³»æ¯”å¯¹<br> é‚£å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•çš„å…³ç³»æ˜¯æ€ä¹ˆæ ·äº†ï¼Ÿ<br> <img src="http://7xod3k.com1.z0.glb.clouddn.com/qtijqabixtlihxsuujkwnlzelrqnwqnz" alt="å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•"><br> <a href="http://chriszou.com/2016/04/13/android-unit-testing-start-from-what.html" target="_blank" rel="external">é“¾æ¥</a></p>
<h4 id="ä¼˜ç‚¹">ä¼˜ç‚¹</h4><ul>
<li>ä¿è¯ä»£ç è´¨é‡ï¼Œé˜²æ­¢bugæˆ–å°½æ—©å‘ç°bugçš„ä½œç”¨</li>
<li>æ”¹å–„ä»£ç çš„è®¾è®¡ï¼ŒèŠ‚çº¦å¼€å‘è°ƒè¯•æ—¶é—´</li>
<li>å¤§å¤§å‡å°‘é‡æ„ä¸­æ‰‹åŠ¨éªŒè¯æ­£ç¡®æ€§çš„æ—¶é—´ã€‚</li>
<li><p>åœ¨å†™å•å…ƒæµ‹è¯•çš„æ—¶å€™ä¹Ÿèƒ½å‘ç°æ–¹æ³•ä¹ƒè‡³ç³»ç»Ÿç»“æ„è®¾è®¡çš„ä¸åˆç†</p>
</li>
<li><p>å‰é¢éƒ½æ˜¯å®˜æ–¹æ–‡å­—ï¼Œç°åœ¨è®²ç‚¹å®åœ¨çš„ã€‚å•å…ƒæµ‹è¯•å°±æ˜¯æµ‹è¯•æ–¹æ³•ï¼Œæ–¹æ³•æˆ‘ä»¬åˆåˆ†ä¸ºä¸¤ç§</p>
<ul>
<li>æœ‰è¿”å›å€¼æ–¹æ³•</li>
<li>æ— è¿”å›å€¼æ–¹æ³•</li>
</ul>
</li>
<li><p>æœ‰è¿”å›å€¼æ–¹æ³•ï¼Œæˆ‘ä»¬æµ‹è¯•è¿™ä¸ªæ–¹æ³•ç›´æ¥é€šè¿‡æµ‹è¯•è¿™ä¸ªæ–¹æ³•è¿”å›çš„å€¼æ˜¯å¦è·Ÿä½ é¢„æœŸä¸€æ ·ã€‚æˆ‘ä»¬å°±ä»¥ä¸€ä¸ªç™»é™†çš„demoæ¥è§£æå§</p>
<ul>
<li><p>ç¯å¢ƒ</p>
<ul>
<li>IDE:Android Studio</li>
<li><p>Javaæµ‹è¯•åº“:junitï¼Œåœ¨build.gradleé…ç½®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">test</span>Compile <span class="string">'junit:junit:4.12'</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1534431-784a1cb7911ccafa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç›®å½•ç»“æ„"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleUnitTest</span> </span>&#123;</span><br><span class="line">    <span class="annotation">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addition_isCorrect</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        assertEquals(<span class="number">4</span>, <span class="number">2</span> + <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ˜¯æ–°è¿‘ä¸€ä¸ªAndroidæ–°å»ºçš„é¡¹ç›®ï¼Œç”Ÿæˆçš„å•å…ƒæµ‹è¯•ï¼Œç›´æ¥é€šè¿‡ç‚¹å‡»æ–¹æ³•çš„è¿è¡Œå°±èƒ½çœ‹çš„ç»“æœäº†ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1534431-6287758ce0be0d42.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä»£ç "></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1534431-82ee776821842f50.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è¿è¡Œç»“æœ"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1534431-d33f48cff28cc3a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä»£ç "></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1534431-a0b2da8b0c4418b7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é”™è¯¯è¿è¡Œç»“æœ"><br>å®é™…å¼€å‘ä¸­æˆ‘ä»¬ä¹Ÿæ˜¯é€šè¿‡get()è·å–æŒ‡å®šå€¼æ¯”è¾ƒè¿™ä¸ªåº”è¯¥æ¯”è¾ƒå®¹æ˜“ç†è§£ã€‚é‡ç‚¹å°±æ˜¯ç¬¬äºŒä¸ªäº†</p>
<ul>
<li>æ— è¿”å›å€¼æ–¹æ³•ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡æ–¹æ³•å†…æŸä¸ªå¯¹è±¡çš„æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨å¹¶ä¸”è°ƒç”¨å‚æ•°ä¸€æ ·ã€‚è¿™é‡Œå°±è¦ç”¨åˆ°mockï¼Œmockå…¶å®å°±æ˜¯è™šæ‹Ÿä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åæ ¹æ®è¿™ä¸ªå¯¹è±¡æ–¹æ³•åˆ¤æ–­æ˜¯å¦è¢«è°ƒç”¨ï¼Œmockç›®å‰æ¯”è¾ƒæˆç†Ÿçš„æ¡†æ¶æ˜¯Mockitoï¼Œæ‰€æœ‰æˆ‘ä»¬è¿™é‡Œè¦å¼•ç”¨Mockitoæ¡†æ¶</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dependencies</span> &#123;    </span><br><span class="line"><span class="keyword">compile</span> <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])    </span><br><span class="line">androidTestCompile(<span class="string">'com.android.support.test.espresso:espresso-core:2.2.2'</span>, </span><br><span class="line">&#123;        </span><br><span class="line">  <span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">'com.android.support'</span>, module: <span class="string">'support-annotations'</span>    &#125;)</span><br><span class="line">   </span><br><span class="line"> <span class="keyword">compile</span> <span class="string">'com.android.support:appcompat-v7:23.4.0'</span>    </span><br><span class="line"><span class="keyword">compile</span> <span class="string">'com.android.support.constraint:constraint-layout:1.0.0-alpha4'</span>    </span><br><span class="line"><span class="comment">//ä»¥ä¸‹æµ‹è¯•æ¡†æ¶    </span></span><br><span class="line">testCompile <span class="string">"junit:junit:4.12"</span>    </span><br><span class="line"><span class="comment">//mockito    </span></span><br><span class="line">testCompile <span class="string">"org.mockito:mockito-core:1.+"</span>&#125;</span><br></pre></td></tr></table></figure>
<p>å…ˆçœ‹ä»£ç è¿™ä¸ªæ˜¯ä¸€ä¸ªç®€å•çš„loginä»£ç <br>Activity</p>
 <figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span>, <span class="title">ILoginView</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> EditText mUserNameView;</span><br><span class="line">    <span class="keyword">private</span> EditText mPassWordView;</span><br><span class="line">    <span class="keyword">private</span> LoginPresenter mPresenter;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        findViewById(R.id.login).setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">        mUserNameView = (EditText) findViewById(R.id.username);</span><br><span class="line">        mPassWordView = (EditText) findViewById(R.id.password);</span><br><span class="line">        mPresenter = <span class="keyword">new</span> LoginPresenter(<span class="keyword">this</span>, HttpClient.getInstance());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (v.getId()) &#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.login:</span><br><span class="line">                String username = mUserNameView.getText().toString();</span><br><span class="line">                String password = mPassWordView.getText().toString();</span><br><span class="line">                <span class="keyword">if</span> (TextUtils.isEmpty(username)) &#123;</span><br><span class="line">                    Toast.makeText(<span class="keyword">this</span>, <span class="string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (TextUtils.isEmpty(password)) &#123;</span><br><span class="line">                    Toast.makeText(<span class="keyword">this</span>, <span class="string">"å¯†ç ä¸èƒ½ä¸ºç©º"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                mPresenter.login(username, password);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">startHomeView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Toast.makeText(<span class="keyword">this</span>, <span class="string">"è·³è½¬ä¸»é¡µ"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onError</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Toast.makeText(<span class="keyword">this</span>, <span class="string">"å¯†ç é”™è¯¯"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ILoginViewæ¥å£</p>
 <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ILoginView</span> &#123;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * è·³è½¬ä¸»é¡µ</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">startHomeView</span>(<span class="params"></span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * é”™è¯¯</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onError</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>HttpClient</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpClient</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> HttpClient mClient;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> HttpClient <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (mClient == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (HttpClient.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (mClient == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    mClient = <span class="keyword">new</span> HttpClient();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mClient;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Callback</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String phone)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onError</span><span class="params">(String error)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String username, String password, Callback callback)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ä¸ºäº†ç®€å•,æ²¡æœ‰å®é™…æ“ä½œç½‘ç»œè¯·æ±‚åªæ˜¯ç®€å•åˆ¤æ–­è¿”å›ç»“æœ</span></span><br><span class="line">        <span class="keyword">if</span> (username.length() &lt; <span class="number">5</span>) &#123;</span><br><span class="line">            callback.onError(<span class="string">"ç”¨æˆ·åå¤ªçŸ­"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            callback.onSuccess(<span class="string">"110110"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>LoginPresenter</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginPresenter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ILoginView mLoginView;</span><br><span class="line">    <span class="keyword">private</span> HttpClient mClient;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LoginPresenter</span><span class="params">(@NonNull ILoginView mLoginView,@NonNull HttpClient client)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mLoginView = mLoginView;</span><br><span class="line">        <span class="keyword">this</span>.mClient = client;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">login</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">        mClient.login(username, password, <span class="keyword">new</span> HttpClient.Callback() &#123;</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(String phone)</span> </span>&#123;</span><br><span class="line">                mLoginView.startHomeView();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onError</span><span class="params">(String <span class="keyword">error</span>)</span> </span>&#123;</span><br><span class="line">                mLoginView.onError();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function">String <span class="title">getDevice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"nexus6p"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å•å…ƒæµ‹è¯•ï¼Œmockå‡ºæ¥çš„å¯¹è±¡ä¸€å®šè¦setåˆ°è¿™ä¸ªLoginPresenterå¯¹è±¡ä¸­ï¼Œè¦ä¸ç„¶æŠ¥é”™org.mockito.exceptions.misusing.NotAMockException</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginPresenterTest</span> </span>&#123;    </span><br><span class="line"><span class="keyword">private</span> LoginPresenter mPresenter;    </span><br><span class="line"><span class="keyword">private</span> ILoginView mLoginView;    </span><br><span class="line"><span class="keyword">private</span> HttpClient mClient;    </span><br><span class="line"><span class="comment">//åˆå§‹åŒ–,æ¯æµ‹è¯•ä¸€ä¸ªæ–¹æ³•éƒ½ä¼šæ‰è¿™ä¸ª    </span></span><br><span class="line"><span class="annotation">@Before</span>    </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;        </span><br><span class="line">mLoginView = Mockito.mock(ILoginView.class);        </span><br><span class="line">mClient = Mockito.mock(HttpClient.class);        </span><br><span class="line">mPresenter = <span class="keyword">new</span> LoginPresenter(mLoginView, mClient);   </span><br><span class="line"> &#125;    </span><br><span class="line"><span class="annotation">@Test</span>    </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;        </span><br><span class="line"><span class="comment">//æ— è¿”å›å€¼æ–¹æ³•        </span></span><br><span class="line">mPresenter.login(<span class="string">"123456"</span>, <span class="string">"123456"</span>);   </span><br><span class="line">     Mockito.verify(mClient).login(<span class="string">"123456"</span>, <span class="string">"123456"</span>, <span class="keyword">null</span>);    </span><br><span class="line">&#125;    </span><br><span class="line"><span class="annotation">@Test</span>    </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loginTest</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;        </span><br><span class="line"><span class="comment">//æ— è¿”å›å€¼æ–¹æ³•        </span></span><br><span class="line">mPresenter.loginTest(<span class="string">"123456"</span>, <span class="string">"123456"</span>);        </span><br><span class="line">Mockito.verify(mClient).login(<span class="string">"123456"</span>, <span class="string">"123456"</span>, <span class="keyword">null</span>);    </span><br><span class="line">&#125;    </span><br><span class="line"><span class="annotation">@Test</span>    </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getDevice</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;        </span><br><span class="line"><span class="comment">//æœ‰è¿”å›å€¼æ–¹æ³•"        </span></span><br><span class="line">Assert.assertEquals(mPresenter.getDevice(), <span class="string">"nexus6p"</span>);    </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œçœ‹ç»“æœ</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1534431-6e66d663c451a176.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç»“æœ"><br>å¯ä»¥çœ‹å‡ºloginæ–¹æ³•æœ‰é—®é¢˜ï¼Œè¿™ä¸ªé”™è¯¯æ˜¯æ­£å¸¸çš„ï¼Œå°±æ˜¯æˆ‘è¦çš„ç»“æœï¼Œå¯æ˜¯loginTestæ–¹æ³•è¿è¡Œæ­£å¸¸ï¼Œæœ€ä¸»è¦çš„æ˜¯ä»–ä»¬callbackä¸ºnullï¼Œloginæ–¹æ³•æ‰§è¡Œçš„callbackä¸æ˜¯nullï¼Œæ‰€æœ‰loginæ–¹æ³•æ‰§è¡Œçš„æ—¶å€™éªŒè¯å‡ºæ¥å°±æ˜¯ä¸ä¸€è‡´çš„ã€‚</p>
<ul>
<li>èµ„æ–™<ul>
<li><a href="">Demoåœ°å€</a></li>
<li><a href="http://chriszou.com/" target="_blank" rel="external">å°åˆ›</a></li>
<li><a href="http://tech.meituan.com/" target="_blank" rel="external">ç¾å›¢ç‚¹è¯„æŠ€æœ¯å›¢é˜Ÿ</a></li>
<li><a href="http://www.ituring.com.cn/book/1336" target="_blank" rel="external">å•å…ƒæµ‹è¯•çš„è‰ºæœ¯</a></li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«/">ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬58æœŸ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/17/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬58æœŸ/" class="article-date">
  	<time datetime="2016-06-17T10:30:00.000Z" itemprop="datePublished">2016-06-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/17/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬58æœŸ/">ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬58æœŸ</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Java_Annotation_-_ç‹èƒœ">Java Annotation - ç‹èƒœ</h2><h3 id="Annotationæ˜¯ä»€ä¹ˆ">Annotationæ˜¯ä»€ä¹ˆ</h3><blockquote>
<p>ç»´åŸºç™¾ç§‘: A form of syntactic metadaa that can be added to Java source code. ä¹Ÿå°±æ˜¯è¯´ï¼ŒAnnotationçš„å¼•å…¥æ˜¯ä¸ºäº†ä»Javaè¯­è¨€å±‚é¢ä¸Šï¼Œä¸ºJavaæºä»£ç æä¾›å…ƒæ•°æ®çš„æ”¯æŒã€‚<a href="http://en.wikipedia.org/wiki/Java_annotation" target="_blank" rel="external">å‚è§ç»´åŸºç™¾ç§‘</a></p>
</blockquote>
<h3 id="Annotationçš„ç”¨é€”">Annotationçš„ç”¨é€”</h3><blockquote>
<p>è¡¨è±¡ï¼Œæ›¿ä»£ä¹‹å‰JDK1.4å¼€å‘ä¸­ï¼Œå¤§é‡ç¹ççš„é…ç½®é¡¹ï¼ŒAnnotationçš„å‡ºç°å…¶å®å¯ä»¥æå¤§ç®€åŒ–é…ç½®æ–‡ä»¶çš„æ•°é‡å’Œéœ€è¦å…³æ³¨é…ç½®çš„å†…å®¹ã€‚ä½†å…¶å®ï¼Œæ³¨è§£å¸¦æ¥çš„ç›Šå¤„è¿œä¸è‡³äºæ­¤ã€‚</p>
</blockquote>
<h3 id="Annotationçš„åˆ†ç±»">Annotationçš„åˆ†ç±»</h3><ul>
<li><p>æ–‡æ¡£æ ‡æ³¨å‹</p>
<p>ä¸»è¦æ˜¯@Documented,ç”¨ä»¥æ ‡æ³¨æ˜¯å¦åœ¨javadocä¸­</p>
</li>
<li><p>ç¼–è¯‘æ£€æŸ¥å‹</p>
<p>ä¸»è¦åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œç»™Javaç¼–è¯‘å™¨è‹¥å¹²æŒ‡ä»¤ï¼Œæ£€æŸ¥Javaä»£ç ä¸­æ˜¯å¦å­˜åœ¨è‹¥å¹²é—®é¢˜ï¼Œ æ”¹å˜ç¼–è¯‘å™¨çš„åŠ¨ä½œæˆ–è€…è¡Œä¸ºï¼Œé€šè¿‡Annotationçš„ä½¿ç”¨ï¼Œå¯ä»¥è°ƒæ•´å’Œæ§åˆ¶ç¼–è¯‘å™¨çš„ä½¿ç”¨ä»¥åŠè®©ç¼–è¯‘å™¨æä¾›å…³äºä»£ç çš„æ›´å¤šçš„æ£€æŸ¥å’ŒéªŒè¯ã€‚ä¸»è¦æœ‰ï¼š@Overrideï¼Œ@SuppressWarning</p>
</li>
<li><p>ä»£ç åˆ†æå‹</p>
<p>æ­¤ç±»Annotationæ˜¯åœ¨æˆ‘ä»¬å¼€å‘ä¸­ä½¿ç”¨æœ€å¤šçš„ï¼Œä¸»è¦æ˜¯é€šè¿‡Annotationæä¾›ç»™ä»£ç æ›´å¤šçš„é¢å¤–ç‰¹æ€§å’Œè®¾ç½®ï¼Œåœ¨Javaè¿è¡Œè¿‡ç¨‹ä¸­å‘æŒ¥ä½œç”¨ã€‚å¸¸è§çš„æ˜¯åœ¨Springæˆ–è€…Hibernateç­‰æ¡†æ¶ä¸­å‡ºç°çš„@Controllerï¼Œ@Serviceï¼Œ@Beanï¼Œ @Table, @Enittyç­‰ç­‰.</p>
</li>
</ul>
<h3 id="è‡ªå®šä¹‰ç”Ÿå‘½å‘¨æœŸä¸ºRuntimeç±»å‹Annotation">è‡ªå®šä¹‰ç”Ÿå‘½å‘¨æœŸä¸ºRuntimeç±»å‹Annotation</h3><p>Runtimeçš„å¤„ç†ä¸»è¦ä¾èµ–äºåå°„çš„æ¥å£ï¼Œåœ¨å­—èŠ‚ç ä¸­å¯»æ‰¾Annotationçš„æ¥å£å’Œè¾“å…¥å‚æ•°ï¼Œæå–å…¶å†…å®¹å’Œæ•°å€¼ã€‚å¤§éƒ¨åˆ†çš„æƒ…å†µä¸‹æ˜¯åŸºäºä»£ç†æ¨¡å¼ï¼ŒåŠ¨æ€ç”Ÿæˆç›¸åº”çš„ä»£ç†ç±»å®ä¾‹ï¼Œç„¶åé€šè¿‡ä»£ç†ç±»ï¼Œè°ƒç”¨ç›¸åº”çš„InvocationHandlerï¼Œåœ¨InvocationHandlerä¹‹å†…å®ŒæˆAnnotationæ‰€è¦æ‰§è¡Œçš„åŠ¨ä½œï¼›ç„¶åå†ç»§ç»­è°ƒç”¨åŸæ¥çš„æ–¹æ³•ï¼Œç»§ç»­æ‰§è¡Œã€‚</p>
<p><strong>ç”¨æˆ·åœ¨å®šä¹‰Runtimeç±»å‹çš„Annotationæ—¶ï¼Œéœ€è¦çš„æ­¥éª¤ï¼š</strong></p>
<ul>
<li>å®šä¹‰Annotation</li>
<li>å®šä¹‰Annotationçš„å¤„ç†å™¨ç±»ã€é€šè¿‡Reflectã€InvocationHandlerã€Proxy.newProxyInstance()æ¥å¤„ç†å…·ä½“çš„é€»è¾‘ã€</li>
<li>é€‰æ‹©åˆé€‚çš„è°ƒç”¨Annotationçš„æ—¶æœºå’Œåˆ‡å…¥ç‚¹ã€‚</li>
</ul>
<h3 id="ç¤ºä¾‹">ç¤ºä¾‹</h3><p><img src="http://7xsk2b.com1.z0.glb.clouddn.com/image/custom-annotation-demo.png" alt="custom-annotation-demo.png"></p>
<p>è‡ªå®šä¹‰ä¸€ä¸ª@OnClickæ³¨è§£ï¼Œé€šè¿‡åœ¨æ–¹æ³•å‰é¢åŠ å…¥è¿™ä¸ªæ³¨è§£ï¼Œä»è€Œä¸ºæŒ‡å®šçš„ç»„ä»¶åŠ¨æ€æ·»åŠ äº‹ä»¶ç›‘å¬æ–¹æ³•ã€‚</p>
<ul>
<li><p>å®šä¹‰OnClickæ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="annotation">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="annotation">@interface</span> OnClick &#123;</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®šä¹‰OnClickProxyFactoryæ¥å¤„ç†åŠ¨æ€ç»‘å®šæ–¹æ³•çš„é€»è¾‘</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OnClickProxyFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * å¤„ç†OnClickæ³¨è§£</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> target åŒ…å«OnClickæ³¨è§£çš„ç›®æ ‡å¯¹è±¡</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">handleOnClickAnnotation</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class&lt;?&gt; clsTarget = target.getClass();</span><br><span class="line">            <span class="comment">// æ£€ç´¢ç›®æ ‡å¯¹è±¡çš„æ‰€æœ‰æ–¹æ³•, å¦‚æœå«æœ‰OnClickæ³¨è§£, åˆ™ä¸ºæ³¨è§£ä¸­å£°æ˜çš„å±æ€§å¯¹è±¡åŠ¨æ€æ·»åŠ AddActionListeneræ–¹æ³•</span></span><br><span class="line">            <span class="keyword">for</span> (Method method : clsTarget.getDeclaredMethods()) &#123;</span><br><span class="line">                OnClick onClickAnnotation = method.getAnnotation(OnClick.class);</span><br><span class="line">                <span class="keyword">if</span> (onClickAnnotation != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    Field field = clsTarget.getDeclaredField(onClickAnnotation.value());</span><br><span class="line">                    field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                    autoAddActionlistener(field.get(target), getActionListenerProxy(target, method));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * ä¸ºç›®æ ‡å¯¹è±¡æ·»åŠ addActionListeneræ–¹æ³•, è¯¥æ–¹æ³•çš„å‚æ•°ActionListenerä¸ºActionListenerä»£ç†å¯¹è±¡</span><br><span class="line">     * <span class="doctag">@param</span> target è¢«æ·»åŠ ActionListeneræ–¹æ³•çš„äº‹ä»¶æºå¯¹è±¡</span><br><span class="line">     * <span class="doctag">@param</span> actionListenerProxy ActionListenerä»£ç†å¯¹è±¡</span><br><span class="line">     * <span class="doctag">@throws</span> NoSuchMethodException</span><br><span class="line">     * <span class="doctag">@throws</span> InvocationTargetException</span><br><span class="line">     * <span class="doctag">@throws</span> IllegalAccessException</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">autoAddActionlistener</span><span class="params">(Object target, Object actionListenerProxy)</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException </span>&#123;</span><br><span class="line">        <span class="comment">// è·å–JButtonçš„addActionListeneræ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        Method methodAddActionListener = target.getClass().getMethod(<span class="string">"addActionListener"</span>, ActionListener.class);</span><br><span class="line">        <span class="comment">// ä¸ºJButtonå¯¹è±¡æ·»åŠ addActionListeneræ–¹æ³•</span></span><br><span class="line">        methodAddActionListener.invoke(target, actionListenerProxy);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * è·å–ActionListenerçš„ä»£ç†å¯¹è±¡</span><br><span class="line">     * <span class="doctag">@param</span> target æŒ‡å®šçš„ä»£ç†å¯¹è±¡</span><br><span class="line">     * <span class="doctag">@param</span> targetMethod æŒ‡å®šçš„ä»£ç†å¯¹è±¡çš„æ–¹æ³•</span><br><span class="line">     * <span class="doctag">@return</span></span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getActionListenerProxy</span><span class="params">(<span class="keyword">final</span> Object target, <span class="keyword">final</span> Method targetMethod)</span> </span>&#123;</span><br><span class="line">        InvocationHandler handler = <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> targetMethod.invoke(target);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(target.getClass().getClassLoader(), <span class="keyword">new</span> Class[] &#123;ActionListener.class&#125;, handler);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨UIåˆå§‹åŒ–æ—¶ï¼Œè°ƒç”¨æ³¨è§£çš„è§£æå’ŒåŠ¨æ€å¤„ç†</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UI</span> <span class="keyword">extends</span> <span class="title">JFrame</span></span>&#123;</span><br><span class="line">    <span class="comment">// çœç•¥......</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UI</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="comment">// çœç•¥......</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// é€šè¿‡OnClickProxyFactoryå·¥å‚æ¥å¤„ç†OnClickæ³¨è§£</span></span><br><span class="line">      OnClickProxyFactory.handleOnClickAnnotation(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="annotation">@OnClick</span>(<span class="string">"btnBlue"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBlueBackground</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      panel.setBackground(Color.BLUE);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="annotation">@OnClick</span>(<span class="string">"btnRed"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRedBackground</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      panel.setBackground(Color.RED);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="annotation">@OnClick</span>(<span class="string">"btnSayHello"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      JOptionPane.showConfirmDialog(<span class="keyword">null</span>, <span class="string">"Hello World!"</span>, <span class="string">"Tips"</span>, JOptionPane.YES_OPTION);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>å…·ä½“çš„ç¤ºä¾‹æºç ï¼Œç§»æ­¥ <a href="https://github.com/wangsheng/helloJavaSE" target="_blank" rel="external">Github-helloJavaSE</a></p>
<h3 id="å‚è€ƒ">å‚è€ƒ</h3><ul>
<li><a href="http://blog.csdn.net/blueheart20/article/details/18725801" target="_blank" rel="external">Java AnnotationåŸç†åˆ†æ(ä¸€)</a></li>
<li><a href="http://blog.csdn.net/blueheart20/article/details/18761847" target="_blank" rel="external">Java AnnotationåŸç†åˆ†æ(äºŒ)</a></li>
<li><a href="http://blog.csdn.net/blueheart20/article/details/18765891" target="_blank" rel="external">Java AnnotationåŸç†åˆ†æ(ä¸‰)</a></li>
<li><a href="http://blog.csdn.net/blueheart20/article/details/18810693" target="_blank" rel="external">Java AnnotationåŸç†åˆ†æ(å››)</a></li>
</ul>
<h2 id="Xcode_MarkDownçš„ä»£ç æ–‡æ¡£_(_for_swift_)">Xcode MarkDownçš„ä»£ç æ–‡æ¡£ ( for swift )</h2><p>@(iOS)[Markdown, Document]</p>
<h3 id="markdownåœ¨swiftä¸­çš„åº”ç”¨">markdownåœ¨swiftä¸­çš„åº”ç”¨</h3><h4 id="goals">goals</h4><ul>
<li>æè¿°å„ä¸ªå±æ€§ã€å‡½æ•°å’Œç±»çš„çœŸæ­£ç”¨é€”</li>
<li>é«˜äº®å‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºï¼ˆå‚æ•°å’Œè¿”å›å€¼ï¼‰</li>
<li>å‡ ä¸ªæœˆåè¿˜èƒ½æ¸…æ™°åœ°è®°å¾—æ¯ä¸ªå‡½æ•°å±æ€§æ˜¯ä¸ºäº†ä»€ä¹ˆ</li>
<li>ä½¿ç”¨å·¥å…·åˆ¶ä½œå…·æœ‰ä¸“ä¸šå¤–è§‚çš„ä½¿ç”¨æ‰‹å†Œï¼ˆæ¯”å¦‚ï¼šä½¿ç”¨ <a href="https://github.com/realm/jazzy" target="_blank" rel="external">Jazzy</a>ï¼‰</li>
<li>Xcode é‡Œå†™çš„ä»£ç æ–‡æ¡£èƒ½è¢«é¢„è§ˆ</li>
</ul>
<h4 id="markdown_grammar">markdown grammar</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="header">#text#ï¼šæ–‡æœ¬æ ‡é¢˜</span></span><br><span class="line"></span><br><span class="line"><span class="strong">**text**</span>ï¼šä½¿æ–‡æœ¬å…·æœ‰åŠ ç²—çš„æ•ˆæœ</span><br><span class="line"></span><br><span class="line"><span class="emphasis">*text*</span>ï¼šä½¿æ–‡æœ¬å…·æœ‰æ–œä½“çš„æ•ˆæœ</span><br><span class="line"></span><br><span class="line"><span class="bullet">* </span>textï¼šä½¿æ–‡æœ¬æˆä¸ºä¸€ä¸ªæ— åºåˆ—è¡¨çš„å…ƒç´ ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæœ‰ä¸ª * åé¢éœ€è¦æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚åŒæ ·ï¼Œå¯ä»¥ä½¿ç”¨ + æˆ– - å®ç°è¿™ä¸ªçš„åŠŸèƒ½</span><br><span class="line"></span><br><span class="line">1.textï¼šä½¿æ–‡æœ¬æˆä¸ºä¸€ä¸ªæœ‰åºåˆ—è¡¨çš„å…ƒç´ </span><br><span class="line"></span><br><span class="line">[<span class="link_label">linked text</span>](<span class="link_url">http://some-url.com</span>)ï¼šä½¿æ–‡æœ¬æˆä¸ºå¯ä»¥ç‚¹å‡»çš„è¶…é“¾æ¥</span><br><span class="line"></span><br><span class="line">![<span class="link_label">image show</span>](<span class="link_url">http://www.appcoda.com/wp-content/uploads/2016/05/t52_3_help_inspector1.png</span>)ï¼šå¯ä»¥æ˜¾ç¤ºå›¾ç‰‡</span><br><span class="line"></span><br><span class="line"><span class="blockquote">&gt; textï¼šåˆ›å»ºä¸€ä¸ªå—å¼•ç”¨ã€‚</span></span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ 4 ä¸ªç©ºæ ¼æˆ– 1 ä¸ª tab æ¥ç¼©è¿›æ‰€å†™çš„ä»£ç å—ï¼Œç­‰ä»·äº HTML ä¸­çš„ \\ æ ‡ç­¾ã€‚å¯ä»¥ç»§ç»­ä½¿ç”¨ 4 ä¸ªç©ºæ ¼æˆ– 1 ä¸ª tab æ¥æ·»åŠ å¦ä¸€ä¸ªç¼©è¿›</span><br><span class="line"></span><br><span class="line">å¦‚æœä¸æƒ³ä½¿ç”¨ç©ºæ ¼æˆ– tab çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ <span class="code">` ã€‚æ¯”å¦‚ï¼Œ `</span>var myProperty` ä¼šæ˜¾ç¤ºæˆ var myProperty</span><br><span class="line"></span><br><span class="line">å¦ä¸€ç§åˆ›å»ºä»£ç å—çš„æ–¹æ³•æ˜¯æ·»åŠ  4 ä¸ª <span class="code">`ï¼Œå¹¶ä»ä¸‹ä¸€è¡Œå¼€å§‹å†™å…·ä½“çš„ä»£ç ï¼Œæœ€åæ·»åŠ  4 ä¸ª `</span> è¡¨ç¤ºç»“æŸ</span><br><span class="line"></span><br><span class="line">åæ–œæ ä¿®é¥° Markdown çš„ç‰¹æ®Šå­—ç¬¦å°±å¯ä»¥é¿å… Markdown è¯­æ³•çš„è§£æäº†ã€‚æ¯”å¦‚ï¼Œ \<span class="strong">**this\**</span> å°±ä¸ä¼šäº§ç”ŸåŠ ç²—çš„æ•ˆæœ</span><br></pre></td></tr></table></figure>
<p>æ³¨é‡ŠåŒºåŸŸï¼š 3 ä¸ªæ–œçº¿ï¼ˆ///ï¼‰æˆ–ä»¥ä¸‹é¢çš„å½¢å¼å¼€å¤´ï¼š<br><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">*</span>/</span><br></pre></td></tr></table></figure></p>
<h5 id="Case">Case</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">    It calculates and returns the outcome of the division of the two parameters.</span><br><span class="line"></span><br><span class="line">    ## Important Notes ##</span><br><span class="line">    1. Both parameters are **double** numbers.</span><br><span class="line">    2. For a proper result the second parameter *must be other than 0*.</span><br><span class="line">    3. If the second parameter is 0 then the function will return nil.</span><br><span class="line"></span><br><span class="line">*/</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">performDivision</span>ï¼ˆ<span class="title">number1</span>: <span class="title">Double</span>, <span class="title">number2</span>: <span class="title">Double</span>ï¼‰ -&gt; <span class="title">Double</span>! </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> number2 != <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> number1 / number2</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/05/t52_2_quickhelp2.png" alt="case image"></p>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/05/t52_3_help_inspector1.png" alt="quick look"></p>
<h4 id="å…³é”®è¯">å…³é”®è¯</h4><ul>
<li>Parameter</li>
<li>Returns</li>
<li>Remark</li>
<li>SeeAlso</li>
<li>Precondiction</li>
<li>Requires</li>
<li>Todo</li>
<li>Version</li>
<li>Author</li>
<li>Note</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">    Another complicated function.</span><br><span class="line"></span><br><span class="line">    - Parameter fullname: The fullname that will be broken into its parts.</span><br><span class="line">    - Returns: A *tuple* with the first and last name.</span><br><span class="line"></span><br><span class="line">    - Remark:</span><br><span class="line">        There's a counterpart function that concatenates the first and last name into a full name.</span><br><span class="line"></span><br><span class="line">    - SeeAlso:  `createFullNameï¼ˆ_:lastname:ï¼‰`</span><br><span class="line"></span><br><span class="line">    - Precondition: `fullname` should not be nil.</span><br><span class="line">    - Requires: Both first and last name should be parts of the full name, separated with a *space character*.</span><br><span class="line"></span><br><span class="line">    - Todo: Support middle name in the next version.</span><br><span class="line"></span><br><span class="line">    - Warning: A wonderful **crash** will be the result of a `nil` argument.</span><br><span class="line"></span><br><span class="line">    - Version: 1.1</span><br><span class="line"></span><br><span class="line">    - Author: Myself Only</span><br><span class="line"></span><br><span class="line">    - Note: Too much documentation for such a small function.</span><br><span class="line"> */</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">breakFullName</span>ï¼ˆ<span class="title">fullname</span>: <span class="title">String</span>) -&gt; ï¼ˆ<span class="title">firstname</span>: <span class="title">String</span>, <span class="title">lastname</span>: <span class="title">String</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> fullnameInPieces = fullname.componentsSeparatedByStringï¼ˆ<span class="string">" "</span>ï¼‰</span><br><span class="line">    <span class="keyword">return</span> ï¼ˆfullnameInPieces[<span class="number">0</span>], fullnameInPieces[<span class="number">1</span>]ï¼‰</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/05/t52_10_keywords5.png" alt="å…¨å…³é”®å­—"></p>
<h3 id="Jazzy_è‡ªåŠ¨äº§ç”Ÿä»£ç æ–‡æ¡£">Jazzy è‡ªåŠ¨äº§ç”Ÿä»£ç æ–‡æ¡£</h3><blockquote>
<p><a href="https://github.com/realm/jazzy" target="_blank" rel="external">Jazzy</a> æ˜¯ä¸€æ¬¾å¯ä»¥ä¸º Swift å’Œ Objective-C ä»£ç äº§ç”Ÿå…·æœ‰ Apple é£æ ¼çš„ä»£ç æ–‡æ¡£å·¥å…·ã€‚</p>
<h4 id="æ•ˆæœå¦‚ä¸‹">æ•ˆæœå¦‚ä¸‹</h4><p><img src="http://www.appcoda.com/wp-content/uploads/2016/05/t52_15_jazzy_results.png" alt="jazzy æ•ˆæœ"></p>
</blockquote>
<h5 id="ä¸‹é¢ä»¥Alamofireä¸ºä¾‹å­ï¼š">ä¸‹é¢ä»¥<code>Alamofire</code>ä¸ºä¾‹å­ï¼š</h5><blockquote>
<p>jazzy â€”help æŸ¥çœ‹å¸®åŠ©</p>
<ul>
<li>cd Alamofire çš„é¡¹ç›®path</li>
<li>jazzy â€”output /Users/xcodeyang/Desktop/jazzy_document </li>
</ul>
</blockquote>
<p><strong><a href="http://swift.gg/2016/06/15/swift-markdown/" target="_blank" rel="external">å‚è€ƒåšå®¢åœ°å€</a></strong></p>
<h2 id="Android_Appå…±äº«æ–‡ä»¶Uriä¸èƒ½ä¸ºfile://_-_å´æ˜">Android Appå…±äº«æ–‡ä»¶Uriä¸èƒ½ä¸ºfile://  - å´æ˜</h2><ul>
<li>å…ˆçœ‹å¼‚å¸¸ä¿¡æ¯:</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">E/StrictMode: null</span><br><span class="line">              java<span class="class">.lang</span><span class="class">.Throwable</span>: file:<span class="comment">// Uri exposed through Intent.getData()</span></span><br><span class="line">                  at android<span class="class">.os</span><span class="class">.StrictMode</span><span class="class">.onFileUriExposed</span>(StrictMode<span class="class">.java</span>:<span class="number">1757</span>)</span><br><span class="line">                  at android<span class="class">.net</span><span class="class">.Uri</span><span class="class">.checkFileUriExposed</span>(Uri<span class="class">.java</span>:<span class="number">2346</span>)</span><br><span class="line">                  at android<span class="class">.content</span><span class="class">.Intent</span><span class="class">.prepareToLeaveProcess</span>(Intent<span class="class">.java</span>:<span class="number">8045</span>)</span><br><span class="line">                  at android<span class="class">.app</span><span class="class">.Instrumentation</span><span class="class">.execStartActivity</span>(Instrumentation<span class="class">.java</span>:<span class="number">1506</span>)</span><br><span class="line">                  at android<span class="class">.app</span><span class="class">.Activity</span><span class="class">.startActivityForResult</span>(Activity<span class="class">.java</span>:<span class="number">3930</span>)</span><br><span class="line">                  at android<span class="class">.app</span><span class="class">.Activity</span><span class="class">.startActivityForResult</span>(Activity<span class="class">.java</span>:<span class="number">3890</span>)</span><br><span class="line">                  at android<span class="class">.support</span><span class="class">.v4</span><span class="class">.app</span><span class="class">.FragmentActivity</span><span class="class">.startActivityForResult</span>(FragmentActivity<span class="class">.java</span>:<span class="number">843</span>)</span><br><span class="line">                  at android<span class="class">.app</span><span class="class">.Activity</span><span class="class">.startActivity</span>(Activity<span class="class">.java</span>:<span class="number">4213</span>)</span><br><span class="line">                  at android<span class="class">.support</span><span class="class">.v4</span><span class="class">.app</span><span class="class">.ActivityCompatJB</span><span class="class">.startActivity</span>(ActivityCompatJB<span class="class">.java</span>:<span class="number">26</span>)</span><br><span class="line">                  at android<span class="class">.support</span><span class="class">.v4</span><span class="class">.app</span><span class="class">.ActivityCompat</span><span class="class">.startActivity</span>(ActivityCompat<span class="class">.java</span>:<span class="number">133</span>)</span><br><span class="line">                  at com<span class="class">.horizon</span><span class="class">.offer</span><span class="class">.mail</span><span class="class">.maildetail</span><span class="class">.impl</span><span class="class">.ImageAnnexWrapper</span><span class="class">.openFile</span>(ImageAnnexWrapper<span class="class">.java</span>:<span class="number">26</span>)</span><br><span class="line">                  at com<span class="class">.horizon</span><span class="class">.offer</span><span class="class">.mail</span><span class="class">.maildetail</span><span class="class">.MailDetailActivity</span><span class="class">.openAnnexFile</span>(MailDetailActivity<span class="class">.java</span>:<span class="number">184</span>)</span><br><span class="line">                  at com<span class="class">.horizon</span><span class="class">.offer</span><span class="class">.mail</span><span class="class">.maildetail</span><span class="class">.adapter</span><span class="class">.MailAnnexAdapter</span><span class="variable">$MailAnnexViewHolder</span>$<span class="number">1</span>.<span class="function"><span class="title">onClick</span><span class="params">(MailAnnexAdapter.java:<span class="number">75</span>)</span></span></span><br><span class="line">                  at android<span class="class">.view</span><span class="class">.View</span><span class="class">.performClick</span>(View<span class="class">.java</span>:<span class="number">5204</span>)</span><br><span class="line">                  at android<span class="class">.view</span><span class="class">.View</span><span class="variable">$PerformClick</span>.<span class="function"><span class="title">run</span><span class="params">(View.java:<span class="number">21153</span>)</span></span></span><br><span class="line">                  at android<span class="class">.os</span><span class="class">.Handler</span><span class="class">.handleCallback</span>(Handler<span class="class">.java</span>:<span class="number">739</span>)</span><br><span class="line">                  at android<span class="class">.os</span><span class="class">.Handler</span><span class="class">.dispatchMessage</span>(Handler<span class="class">.java</span>:<span class="number">95</span>)</span><br><span class="line">                  at android<span class="class">.os</span><span class="class">.Looper</span><span class="class">.loop</span>(Looper<span class="class">.java</span>:<span class="number">148</span>)</span><br><span class="line">                  at android<span class="class">.app</span><span class="class">.ActivityThread</span><span class="class">.main</span>(ActivityThread<span class="class">.java</span>:<span class="number">5417</span>)</span><br><span class="line">                  at java<span class="class">.lang</span><span class="class">.reflect</span><span class="class">.Method</span><span class="class">.invoke</span>(Native Method)</span><br><span class="line">                  at com<span class="class">.android</span><span class="class">.internal</span><span class="class">.os</span><span class="class">.ZygoteInit</span><span class="variable">$MethodAndArgsCaller</span>.<span class="function"><span class="title">run</span><span class="params">(ZygoteInit.java:<span class="number">726</span>)</span></span></span><br><span class="line">                  at com<span class="class">.android</span><span class="class">.internal</span><span class="class">.os</span><span class="class">.ZygoteInit</span><span class="class">.main</span>(ZygoteInit<span class="class">.java</span>:<span class="number">616</span>)</span><br></pre></td></tr></table></figure>
<p>åœ¨StrictMode(ä¸¥æ ¼)æ¨¡å¼ä¸‹ï¼ŒAppä¹‹é—´å…±äº«èµ„æºæŠ¥çš„å¼‚å¸¸ã€‚</p>
<ul>
<li>å‡ºç°è¿™ä¸ªå¼‚å¸¸çš„ä»£ç </li>
</ul>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> void openFile(@NonNull Activity activity, @NonNull <span class="keyword">File</span> <span class="keyword">file</span>) &#123;</span><br><span class="line">        <span class="type">Intent</span> <span class="type">intent</span> = new <span class="type">Intent</span>(<span class="type">Intent</span>.ACTION_VIEW);</span><br><span class="line">        <span class="type">intent</span>.addCategory(<span class="type">Intent</span>.CATEGORY_DEFAULT);</span><br><span class="line">        <span class="type">intent</span>.addFlags(<span class="type">Intent</span>.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">        /**å¼‚å¸¸è¿™è¡Œä»£ç **/</span><br><span class="line">        <span class="type">intent</span>.setDataAndType(Uri.fromFile(<span class="keyword">file</span>), <span class="string">"image/*"</span>);</span><br><span class="line">        ActivityCompat.startActivity(activity, <span class="type">intent</span>, null);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>æ‰“å°</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Uri.<span class="function"><span class="title">fromFile</span><span class="params">(file)</span></span></span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºä¿¡æ¯</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Uri</span> uri=file:<span class="comment"><span class="markdown">///storage/emulated/0/download/9text.jpg</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>å„æ–¹è¯´æ˜<ul>
<li><a href="https://developer.android.com/preview/behavior-changes.html#sharing-files" target="_blank" rel="external">Android Nä¸­è¯´æ˜Uriä¸èƒ½ä»¥file://çš„åŸå› </a><ul>
<li>ä¼ é€’è½¯ä»¶åŒ…ç½‘åŸŸå¤–çš„ file:// URI å¯èƒ½ç»™æ¥æ”¶å™¨ç•™ä¸‹æ— æ³•è®¿é—®çš„è·¯å¾„ã€‚</li>
<li>è®¿é—®æƒé™æ§åˆ¶ </li>
</ul>
</li>
</ul>
</li>
<li><a href="https://developer.android.com/preview/behavior-changes.html#sharing-files" target="_blank" rel="external">è§£å†³åŠæ³•</a><ul>
<li><a href="https://developer.android.com/reference/android/support/v4/content/FileProvider.html" target="_blank" rel="external">FileProvider</a></li>
</ul>
</li>
<li><p>æ€»ç»“</p>
<ul>
<li><p>å¼€å§‹æœç´¢Uri.fromFile(file)å¹¶åˆ†ææºç </p>
 <figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">  * Creates a Uri from a file. The URI has the form</span><br><span class="line">  * "file://&lt;absolute path&gt;". Encodes path characters with the exception of</span><br><span class="line">  * '/'.</span><br><span class="line">  *</span><br><span class="line">  * &lt;p&gt;Example: "file:///tmp/android.txt"</span><br><span class="line">  *</span><br><span class="line">  * @throws NullPointerException if file is null</span><br><span class="line">  * @return a Uri for the given file</span><br><span class="line">  */</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> Uri fromFile(<span class="keyword">File</span> <span class="keyword">file</span>) &#123;</span><br><span class="line">     <span class="keyword">if</span> (<span class="keyword">file</span> == <span class="keyword">null</span>) &#123;</span><br><span class="line">         <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">"file"</span>);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     PathPart path = PathPart.fromDecoded(<span class="keyword">file</span>.getAbsolutePath());</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">new</span> HierarchicalUri(</span><br><span class="line">             <span class="string">"file"</span>, Part.EMPTY, path, Part.<span class="keyword">NULL</span>, Part.<span class="keyword">NULL</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p> æ²¡æœ‰æ‰¾åˆ°ç›¸å…³è§£å†³æ–¹æ¡ˆã€‚</p>
</li>
<li><a href="https://developer.android.com/reference/android/os/StrictMode.VmPolicy.Builder.html#detectFileUriExposure(" target="_blank" rel="external">StrictModeçš„FileUriExposedExceptionå¼‚å¸¸æ£€æµ‹</a>)ä¸­æœ‰æåˆ°FileProviderçš„ä½¿ç”¨</li>
<li>æˆ‘å†™çš„ä¸€ä¸ª<a href="https://github.com/milin411/FileIntentDemo.git" target="_blank" rel="external">demo</a></li>
<li>ç»™ä»¥åæé†’appä¹‹é—´å…±äº«æ•°æ®ä¼ Uriä¸èƒ½ä¼ file://</li>
</ul>
</li>
<li><p>å‚è€ƒèµ„æ–™</p>
<ul>
<li><a href="https://developer.android.com/reference/android/os/StrictMode.html" target="_blank" rel="external">StrictMode</a> </li>
<li><a href="http://www.jianshu.com/p/5572b42fc63f" target="_blank" rel="external">Android Uriå’ŒJava URIçš„åŒºåˆ«</a></li>
<li><a href="http://blog.csdn.net/dlutbrucezhang/article/details/8917303" target="_blank" rel="external">Androidçš„Uri</a> </li>
<li><a href="http://blog.csdn.net/harvic880925/article/details/44679239" target="_blank" rel="external">Uriè¯¦è§£ä¹‹â€”â€”Uriç»“æ„ä¸ä»£ç æå–</a></li>
<li><a href="http://blog.csdn.net/zhangyingli/article/details/37902367" target="_blank" rel="external">æ ¹æ® Android Trainingè¯¾ç¨‹å†™çš„FileProviderå°ä¾‹å­</a></li>
<li><a href="https://developer.android.com/preview/behavior-changes.html#sharing-files" target="_blank" rel="external">FileUriExposedException å¼‚å¸¸</a></li>
<li><a href="https://developer.android.com/reference/android/support/v4/content/FileProvider.html" target="_blank" rel="external">FileProvider</a></li>
<li><a href="http://blog.csdn.net/zhangyingli/article/details/37902367" target="_blank" rel="external">FileProviderä½¿ç”¨</a></li>
</ul>
</li>
</ul>
<h2 id="è°“è¯_-_åˆ˜åº·">è°“è¯ - åˆ˜åº·</h2><ul>
<li>NSPredicateæ˜¯Foundationæ¡†æ¶ä¸­çš„ä¸€ä¸ªç±»ã€‚</li>
<li>ä½œç”¨ï¼šæŒ‡å®šæ•°æ®è¢«è·å–å’Œè¿‡æ»¤çš„æ–¹å¼ã€‚æä¾›äº†ç±»ä¼¼äºè‡ªç„¶è¯­è¨€ä¸€æ ·å®šä¹‰ä¸€ä¸ªé›†åˆè¢«æœå¯»çš„é€»è¾‘æ¡ä»¶ã€‚</li>
</ul>
<p>ä¸ºäº†è¯æ˜NSPredicateçš„å¼ºå¤§åŠŸèƒ½ï¼Œå…ˆå†™ä¸€ä¸ªPersonç±»ï¼Œåšå‡†å¤‡å·¥ä½œã€‚</p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">class <span class="keyword">Person</span>: NSObject &#123;</span><br><span class="line">    var name: String</span><br><span class="line">    var age: Int</span><br><span class="line">    init(name: String, age: Int) &#123;</span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        super.init()</span><br><span class="line">    &#125;</span><br><span class="line">    override var description: String &#123;</span><br><span class="line">        return <span class="string">"name: \(self.name), age: \(self.age)"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var colleagues = NSMutableArray()</span><br><span class="line">colleagues.addObject(<span class="keyword">Person</span>(name: <span class="string">"Arthur"</span>, age: 45))</span><br><span class="line">colleagues.addObject(<span class="keyword">Person</span>(name: <span class="string">"Michael"</span>, age: 23))</span><br><span class="line">colleagues.addObject(<span class="keyword">Person</span>(name: <span class="string">"Kenny"</span>, age: 25))</span><br><span class="line">colleagues.addObject(<span class="keyword">Person</span>(name: <span class="string">"Bella"</span>, age: 24))</span><br><span class="line">colleagues.addObject(<span class="keyword">Person</span>(name: <span class="string">"Vincent"</span>, age: 36))</span><br><span class="line">colleagues.addObject(<span class="keyword">Person</span>(name: <span class="string">"Adolph"</span>, age: 39))</span><br></pre></td></tr></table></figure>
<h3 id="åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨</h3><p><strong>æ‰¾å‡ºå¹´é¾„ä¸º24å²çš„äºº:</strong></p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> predicateByAge = <span class="type">NSPredicate</span>(format: <span class="string">"age == 24"</span>)</span><br><span class="line"><span class="keyword">let</span> <span class="literal">result</span> = colleagues.filteredArrayUsingPredicate(predicateByAge)</span><br></pre></td></tr></table></figure>
<p><strong>å‚æ•°å¯ä»¥ä¼ å…¥:</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">let age = <span class="function"><span class="title">NSNumber</span><span class="params">(int: <span class="number">25</span>)</span></span></span><br><span class="line">let predicateByPassAge = <span class="function"><span class="title">NSPredicate</span><span class="params">(format: <span class="string">"age == %@"</span>, age)</span></span></span><br><span class="line">let result1 = colleagues.<span class="function"><span class="title">filteredArrayUsingPredicate</span><span class="params">(predicateByPassAge)</span></span></span><br></pre></td></tr></table></figure>
<p><strong>ä¹Ÿå¯ä¼ å…¥è¦å¯¹æ¯”çš„å±æ€§ï¼Œè¿™é‡Œæ˜¯age. å±æ€§çš„key:</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let pridicateByAge1 = <span class="function"><span class="title">NSPredicate</span><span class="params">(format: <span class="string">"%K == %@"</span>, <span class="string">"age"</span>, NSNumber(int: <span class="number">36</span>)</span></span>)</span><br><span class="line">let result2 = colleagues.<span class="function"><span class="title">filteredArrayUsingPredicate</span><span class="params">(pridicateByAge1)</span></span></span><br></pre></td></tr></table></figure>
<p><strong>æŒ‡å®šé€šé…çš„å˜é‡ï¼Œè¿™é‡Œç”¨24æ¥æ›¿ä»£age:</strong></p>
<figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">let</span> pridicateByAge2 = NSPredicate <span class="params">(format: <span class="string">"age == $age"</span>)</span></span><br><span class="line"><span class="built_in">let</span> result3 = colleagues.filteredArrayUsingPredicate<span class="params">(pridicateByAge2.predicateWithSubstitutionVariables<span class="params">([<span class="string">"age"</span>: NSNumber<span class="params">(int: <span class="number">24</span>)</span>])</span>)</span></span><br></pre></td></tr></table></figure>
<h4 id="è¯­æ³•å°ç»“">è¯­æ³•å°ç»“</h4><ul>
<li>ä½¿ç”¨<code>%@</code>å¯¹åº”æ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œæ—¥æœŸçš„æ›¿ä»£å€¼</li>
<li>ä½¿ç”¨<code>%K</code>å¯¹åº”è¦æ¯”è¾ƒçš„å±æ€§ï¼Œä¹Ÿå°±æ˜¯KVCä¸­çš„key</li>
<li>ä½¿ç”¨$å˜é‡åæ¥è¡¨ç¤ºé€šé…çš„å˜é‡ï¼Œç„¶å<code>predicateWithSubstitutionVariables</code>æ¥å†³å®šå…·ä½“çš„å˜é‡å€¼</li>
</ul>
<h3 id="åŸºæœ¬æ¯”è¾ƒ">åŸºæœ¬æ¯”è¾ƒ</h3><p><strong>æ‰¾å‡ºå¹´é¾„å¤§äº40å²çš„åŒäº‹:</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let predicateAgeOver40 = <span class="function"><span class="title">NSPredicate</span><span class="params">(format: <span class="string">"age &gt; 40"</span>)</span></span></span><br><span class="line">let boss = colleagues.<span class="function"><span class="title">filteredArrayUsingPredicate</span><span class="params">(predicateAgeOver40)</span></span></span><br></pre></td></tr></table></figure>
<p><strong>æ‰¾å‡ºå¹´é¾„åœ¨22å²~35å²çš„äºº:</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let minAge = <span class="function"><span class="title">NSNumber</span><span class="params">(int: <span class="number">22</span>)</span></span></span><br><span class="line">let maxAge = <span class="function"><span class="title">NSNumber</span><span class="params">(int: <span class="number">35</span>)</span></span></span><br><span class="line">let predicateByAge3 = <span class="function"><span class="title">NSPredicate</span><span class="params">(format: <span class="string">"age BETWEEN &#123;%@, %@&#125;"</span>, minAge, maxAge)</span></span></span><br><span class="line">let result4 = colleagues.<span class="function"><span class="title">filteredArrayUsingPredicate</span><span class="params">(predicateByAge3)</span></span></span><br></pre></td></tr></table></figure>
<h4 id="è¯­æ³•å°ç»“-1">è¯­æ³•å°ç»“</h4><ul>
<li><code>&gt;</code> å¤§äº</li>
<li><code>&gt;=</code> å¤§äºç­‰äº</li>
<li><code>&lt;</code> å°äº</li>
<li><code>&lt;=</code> å°äºç­‰äº</li>
<li><code>==</code> ç­‰äº</li>
<li><code>!=</code> æˆ–è€… <code>&lt;&gt;</code> ä¸ç­‰äº</li>
<li><code>BETWEEN</code> ä»‹äºä¸¤è€…ä¹‹é—´,åŒ…æ‹¬ä¸Šä¸‹é™</li>
</ul>
<h3 id="å¤åˆæ¯”è¾ƒ">å¤åˆæ¯”è¾ƒ</h3><ul>
<li><code>&amp;&amp;</code> æˆ–è€…<code>AND</code> é€»è¾‘ä¸</li>
<li><code>||</code> æˆ–è€… <code>OR</code> é€»è¾‘æˆ–</li>
<li><code>!</code>æˆ–è€…<code>NOT</code> é€»è¾‘é</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let predicateByCompare = <span class="function"><span class="title">NSPredicate</span><span class="params">(format: <span class="string">"age &lt; 30 OR age &gt;= 40"</span>)</span></span></span><br><span class="line">let result5 = colleagues.<span class="function"><span class="title">filteredArrayUsingPredicate</span><span class="params">(predicateByCompare)</span></span></span><br></pre></td></tr></table></figure>
<h3 id="å­—ç¬¦ä¸²æ¯”è¾ƒ">å­—ç¬¦ä¸²æ¯”è¾ƒ</h3><ul>
<li><code>BEGINSWITH</code> å·¦è¾¹è¡¨è¾¾å¼ä»¥å³è¾¹è¡¨è¾¾å¼å¼€å¤´</li>
<li><code>CONTAINS</code> å·¦è¾¹è¡¨è¾¾å¼åŒ…å«å³è¾¹è¡¨è¾¾å¼</li>
<li><code>ENDSWITH</code> å·¦è¾¹è¡¨è¾¾å¼ä»¥å³è¾¹è¡¨è¾¾å¼ç»“å°¾</li>
<li><code>LIKE</code> å·¦è¾¹è¡¨è¾¾å¼å’Œå³è¾¹è¡¨è¾¾å¼ç›¸ä¼¼ï¼ˆç®€å•çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œ?åŒ¹é…ä¸€ä¸ªå­—ç¬¦ï¼Œ*åŒ¹é…0ä¸ªæˆ–è€…å¤šä¸ªå­—ç¬¦ï¼‰</li>
<li><code>MATCHES</code> å¯ä»¥å®ç°è¾ƒä¸ºå¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</li>
<li>ç”¨æ–¹æ‹¬å·åŠ <code>cd</code>æ¥ä¸åŒºåˆ†å¤§å°å†™å’Œå˜éŸ³ç¬¦å·</li>
<li><code>IN</code> å·¦è¾¹çš„è¡¨è¾¾å¼åœ¨å³è¾¹çš„é›†åˆé‡Œ</li>
</ul>
<p><strong>æ‰¾å‡ºåå­—ä»¥â€œAâ€å¼€å¤´çš„åŒäº‹:</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let pridivateByName1 = <span class="function"><span class="title">NSPredicate</span><span class="params">(format: <span class="string">"name BEGINSWITH %@"</span>, <span class="string">"A"</span>)</span></span></span><br><span class="line">let result6 = colleagues.<span class="function"><span class="title">filteredArrayUsingPredicate</span><span class="params">(pridivateByName1)</span></span></span><br></pre></td></tr></table></figure>
<p><strong>åå­—é‡ŒåŒ…å«in,ä¸åŒºåˆ†å¤§å°å†™ï¼Œå¹¶ä¸”å¹´é¾„å¤§äºç­‰äº24:</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let pridivateByName2 = <span class="function"><span class="title">NSPredicate</span><span class="params">(format: <span class="string">"name CONTAINS %@ &amp;&amp; age &gt;= %@"</span>, <span class="string">"in"</span>, NSNumber(int: <span class="number">24</span>)</span></span>)</span><br><span class="line">let result7 = colleagues.<span class="function"><span class="title">filteredArrayUsingPredicate</span><span class="params">(pridivateByName2)</span></span></span><br></pre></td></tr></table></figure>
<p><strong>å¤åˆæ­£åˆ™è¡¨è¾¾å¼<code>T[a-z]*k</code>:</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let privatedivateByName3 = <span class="function"><span class="title">NSPredicate</span><span class="params">(format: <span class="string">"name MATCHES 'T[a-z]*k'"</span>)</span></span></span><br><span class="line">let result8 = colleagues.<span class="function"><span class="title">filteredArrayUsingPredicate</span><span class="params">(privatedivateByName3)</span></span></span><br></pre></td></tr></table></figure>
<p><strong>åå­—æ˜¯ä¸¤è€…ä¸­çš„ä¸€ä¸ª:</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let privatedivateByName4 = <span class="function"><span class="title">NSPredicate</span><span class="params">(format: <span class="string">"name IN &#123;'Bella', 'Jack Tomphon'&#125;"</span>)</span></span></span><br><span class="line">let result9 = colleagues.<span class="function"><span class="title">filteredArrayUsingPredicate</span><span class="params">(privatedivateByName4)</span></span></span><br></pre></td></tr></table></figure>
<h3 id="åŸºäºBlockçš„è°“è¯">åŸºäºBlockçš„è°“è¯</h3><p><strong>åŸºäºBlockèƒ½å¤Ÿçµæ´»çš„å®šåˆ¶è°“è¯ï¼Œè¿™é‡Œç®€å•çš„Blockå®šä¹‰<code>age &gt; 24</code>:</strong></p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> blockPredicate = <span class="type">NSPredicate</span> &#123; (person: <span class="type">AnyObject</span>!, _) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">var</span> <span class="literal">result</span> = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> castResult = person <span class="keyword">as</span>? <span class="type">Person</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> castResult.age &gt; <span class="number">24</span> &#123;</span><br><span class="line">            <span class="literal">result</span> = <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">result</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> result10 = colleagues.filteredArrayUsingPredicate(blockPredicate)</span><br></pre></td></tr></table></figure>
<h3 id="Arrayä½¿ç”¨è°“è¯å‚è€ƒï¼š">Arrayä½¿ç”¨è°“è¯å‚è€ƒï¼š</h3><p><a href="http://stackoverflow.com/questions/24382580/filteredarrayusingpredicate-does-not-exist-in-swift-array" target="_blank" rel="external">StackOverFlow</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«/">ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬57æœŸ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/27/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬57æœŸ/" class="article-date">
  	<time datetime="2016-05-27T10:30:00.000Z" itemprop="datePublished">2016-05-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/27/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬57æœŸ/">ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬57æœŸ</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Java_Runtime_åŠ¨æ€ä»£ç†_-_ç‹èƒœ">Java Runtime åŠ¨æ€ä»£ç† - ç‹èƒœ</h2><p>ä½¿ç”¨è¿‡Springçš„æœ‹å‹åº”è¯¥å¯¹AOPã€Aspected Oriented Programeã€å¾ˆç†Ÿæ‚‰ï¼Œé‚£ä¹ˆæ˜¯å¦è¢«é‡Œé¢çš„å‰ç½®å¢å¼ºã€åç½®å¢å¼ºã€ç¯ç»•å¢å¼ºæ‰€éœ‡æ’¼å‘¢ï¼Ÿæœ‰æ²¡æœ‰æƒ³è¿‡è¿™èƒŒåçš„æŠ€æœ¯å®ç°å‘¢ï¼Ÿå…¶å®JDKçš„åŠ¨æ€ä»£ç†å°±èƒ½å®ç°ã€‚ä¸‹é¢åšä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæ¥é˜è¿°å¦‚ä½•åœ¨Runtimeæ—¶ï¼ŒåŠ¨æ€å¢å¼ºåŸæœ‰çš„æ–¹æ³•ã€‚</p>
<h3 id="å‰æç¯å¢ƒ">å‰æç¯å¢ƒ</h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª<code>Waiter</code>ç±»ï¼Œé‡Œé¢å«æœ‰ä¸¤ä¸ªæ–¹æ³•:</p>
<ul>
<li>welcome() // æ¬¢è¿å…‰ä¸´!</li>
<li>bye() // è°¢è°¢æƒ é¡¾!</li>
</ul>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æ¬¢è¿å…‰ä¸´!</span><br><span class="line">è°¢è°¢æƒ é¡¾!</span><br><span class="line"></span><br><span class="line"><span class="keyword">Process</span> finished <span class="keyword">with</span> <span class="keyword">exit</span> code <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>åæ¥å‘ç°æ¬¢è¿é¡¾å®¢å’Œé€åˆ«é¡¾å®¢ä¸å¤Ÿç¤¼è²Œï¼Œéœ€è¦åœ¨æ¬¢è¿ä¹‹å‰è¯´ã€æ‚¨å¥½ï¼ã€ï¼Œé€åˆ«é¡¾å®¢åè¯´ã€ç¥æ‚¨æ„‰å¿«!ã€ã€‚ä½†æˆ‘ä»¬ä¸å¸Œæœ›åŠ¨åŸæœ‰çš„ä¸šåŠ¡ç±»<code>Waiter</code>ï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°å‘¢ï¼Ÿ</p>
<h3 id="å®ç°æ­¥éª¤">å®ç°æ­¥éª¤</h3><ol>
<li><p>åˆ›å»ºä¸€ä¸ªä¸šåŠ¡å¯¹è±¡ã€å¿…é¡»è¦æœ‰æ¥å£ã€, æ‰§è¡Œä¸šåŠ¡æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Receptor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">welcome</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bye</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Waiter</span> <span class="keyword">implements</span> <span class="title">Receptor</span></span>&#123;</span><br><span class="line">      <span class="annotation">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">welcome</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          System.out.println(<span class="string">"æ¬¢è¿å…‰ä¸´!"</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="annotation">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bye</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          System.out.println(<span class="string">"è°¢è°¢æƒ é¡¾!"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ›å»ºä¸€ä¸ªå…·æœ‰å…¬ç”¨ä»£ç çš„å¯¹è±¡ï¼Œå¹¶å°†è¿™äº›å…¬ç”¨ä»£ç å£°æ˜æˆæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PoliteWords</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"æ‚¨å¥½!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHappy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ç¥æ‚¨æ„‰å¿«!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ›å»ºä¸€ä¸ªå¯ä»¥ä½¿ç”¨å…¬ç”¨ä»£ç å¯¹è±¡çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥å¯¹è¦è¢«å¤„ç†çš„ç›®æ ‡å¯¹è±¡å®æ–½æ–¹æ³•æ‹¦æˆªï¼Œæ‰§è¡Œå…¬ç”¨ä»£ç å¯¹è±¡ä¸­çš„æ–¹æ³•ã€‚å€ŸåŠ©JDKæä¾›çš„APIã€InvocationHandlerã€</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReceptorHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line">    <span class="comment">// çœç•¥...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * é‡å†™invokeæ–¹æ³•,ä»è€Œè¾¾åˆ°å¢å¼ºç›®æ ‡å¯¹è±¡çš„ç›®çš„</span><br><span class="line">     *</span><br><span class="line">     * <span class="doctag">@param</span> proxy å¢å¼ºåçš„å¯¹è±¡</span><br><span class="line">     * <span class="doctag">@param</span> method ç›®æ ‡å¯¹è±¡ä¸Šæ­£åœ¨è¢«è°ƒç”¨çš„æ–¹æ³•</span><br><span class="line">     * <span class="doctag">@param</span> args ç›®æ ‡å¯¹è±¡ä¸Šæ­£åœ¨è¢«è°ƒç”¨çš„æ–¹æ³•æ‰€ä¼ é€’çš„å‚æ•°</span><br><span class="line">     * <span class="doctag">@return</span> ç›®æ ‡å¯¹è±¡æ­£åœ¨è¢«è°ƒç”¨çš„æ–¹æ³•æ‰§è¡Œçš„ç»“æœ</span><br><span class="line">     * <span class="doctag">@throws</span> Throwable</span><br><span class="line">     */</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        Object result;</span><br><span class="line">        <span class="keyword">if</span> (method.getName().equals(<span class="string">"welcome"</span>)) &#123;<span class="comment">// welcomeä¹‹å‰sayHello</span></span><br><span class="line">            interceptor.sayHello();</span><br><span class="line">            result = method.invoke(target, args);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.getName().equals(<span class="string">"bye"</span>)) &#123;<span class="comment">// byeä¹‹åsayHappy</span></span><br><span class="line">            result = method.invoke(target, args);</span><br><span class="line">            interceptor.sayHappy();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result = method.invoke(target, args);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ›å»ºä¸€ä¸ªå¯ä»¥è·å–å¢å¼ºäº†åŠŸèƒ½ä¹‹åå¯¹è±¡çš„ä»£ç†å·¥å‚ï¼Œå·¥å‚çš„ä½œç”¨å°±æ˜¯è¿”å›å¢å¼ºåçš„ä»£ç†Proxy, ä»–çš„ç±»å‹åº”è¯¥å’Œç›®æ ‡å¯¹è±¡çš„æ¥å£ç±»å‹ç›¸åŒã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReceptorProxyFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getProxy</span><span class="params">(Object target)</span> </span>&#123;</span><br><span class="line">        ReceptorHandler handler = <span class="keyword">new</span> ReceptorHandler();</span><br><span class="line">        handler.setTarget(target);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(), handler);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼–å†™æµ‹è¯•ç±»ï¼ˆå¯é€‰ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestProxy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Waiter target = <span class="keyword">new</span> Waiter();</span><br><span class="line">        Receptor receptor = (Receptor) ReceptorProxyFactory.getProxy(target);</span><br><span class="line">        receptor.welcome();</span><br><span class="line">        receptor.bye();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>å…·ä½“çš„ç¤ºä¾‹æºç ï¼Œç§»æ­¥ <a href="https://github.com/wangsheng/helloJavaSE" target="_blank" rel="external">Github-helloJavaSE</a></p>
<h3 id="æ‰§è¡Œç»“æœ">æ‰§è¡Œç»“æœ</h3><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ‚¨å¥½<span class="exclamation_mark">!</span></span><br><span class="line">æ¬¢è¿å…‰ä¸´<span class="exclamation_mark">!</span></span><br><span class="line">è°¢è°¢æƒ é¡¾<span class="exclamation_mark">!</span></span><br><span class="line">ç¥æ‚¨æ„‰å¿«<span class="exclamation_mark">!</span></span><br><span class="line"></span><br><span class="line"><span class="variable">Process</span> <span class="function_or_atom">finished</span> <span class="function_or_atom">with</span> <span class="function_or_atom">exit</span> <span class="function_or_atom">code</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„:</strong> JDKåŠ¨æ€ä»£ç†åªèƒ½ä»£ç†æ¥å£ç±»å‹çš„å¯¹è±¡ï¼Œå¹¶ä¸”è¿”å›æ¥å£ç±»å‹ã€‚å¦‚æœè¦å¢å¼ºé‚£äº›æ²¡æœ‰æ¥å£çš„å¯¹è±¡ï¼ŒJDKåŠ¨æ€ä»£ç†ä¸èƒ½å®ç°ï¼Œè¦ä¾èµ– <a href="https://github.com/cglib/cglib" target="_blank" rel="external">CGLIB</a> æŠ€æœ¯ã€‚</p>
<h2 id="Androidè½¬åœºåŠ¨ç”»">Androidè½¬åœºåŠ¨ç”»</h2><ul>
<li><p>startActivity()</p>
  <figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">	Intent intent = new Intent<span class="list">(<span class="keyword">MainActivity</span>.this,OtherActivity.class)</span><span class="comment">;</span></span><br><span class="line">startActivity<span class="list">(<span class="keyword">intent</span>)</span><span class="comment">;</span></span><br><span class="line">overridePendingTransition<span class="list">(<span class="keyword">R</span>.anim.push_up_in,R.anim.push_up_out)</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ActivityCompat</p>
</li>
</ul>
<figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ActivityCompat.startActivity<span class="params">(<span class="params">(Activity)</span> context, intent, null)</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> static void startActivity(Activity activity, <span class="type">Intent</span> <span class="type">intent</span>, @Nullable Bundle options) &#123;</span><br><span class="line">    <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= <span class="number">16</span>) &#123;</span><br><span class="line">        ActivityCompatJB.startActivity(activity, <span class="type">intent</span>, options);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        activity.startActivity(<span class="type">intent</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Android 4.1ï¼ˆAPI16)ä»¥ä¸‹è½¬åœºåŠ¨ç”»</li>
</ul>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AIntent intent = new Intent<span class="list">(<span class="keyword">MainActivity</span>.this,OtherActivity.class)</span><span class="comment">;</span></span><br><span class="line">startActivity<span class="list">(<span class="keyword">intent</span>)</span><span class="comment">;</span></span><br><span class="line">overridePendingTransition<span class="list">(<span class="keyword">R</span>.anim.push_up_in,R.anim.push_up_out)</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>Android 4.1ï¼ˆAPI16ï¼‰ä»¥ä¸Šè½¬åœºåŠ¨ç”»</p>
<ul>
<li><a href="https://developer.android.com/reference/android/app/ActivityOptions.html" target="_blank" rel="external">ActivityOptions</a><ul>
<li>Android 4.1ï¼ˆAPI16ï¼‰æä¾›äº†ä¸€ä¸ªæ–°ç±»ActivityOptions,ç”¨æ¥å®ç°Activityçš„åˆ‡æ¢åŠ¨ç”»ã€‚</li>
</ul>
</li>
<li><p>ActivityOptionså¸¸ç”¨ä½¿ç”¨ </p>
<ul>
<li><p>makeClipRevealAnimation(View source, int startX, int startY, int width, int height)</p>
<figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Added <span class="keyword">in</span> API level <span class="number">23</span></span><br><span class="line"><span class="string">``</span><span class="string">``</span> </span><br><span class="line">- makeCustomAnimation(Context context, <span class="keyword">int</span> enterResId, <span class="keyword">int</span> exitResId)</span><br></pre></td></tr></table></figure>
<p>Added in API level 16</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- makeScaleUpAnimation(View source, <span class="built_in">int</span> startX, <span class="built_in">int</span> startY, <span class="built_in">int</span> <span class="variable">width</span>, <span class="built_in">int</span> <span class="variable">height</span>)</span><br></pre></td></tr></table></figure>
<p>Added in API level 16</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="subst">-</span> makeSceneTransitionAnimation(Activity activity, <span class="built_in">Pair</span><span class="attribute">...</span><span class="subst">&lt;</span>View, <span class="built_in">String</span><span class="subst">&gt;</span> sharedElements)</span><br></pre></td></tr></table></figure>
<p>Added in API level 21</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- <span class="function"><span class="title">makeSceneTransitionAnimation</span><span class="params">(Activity activity, View sharedElement, String sharedElementName)</span></span></span><br></pre></td></tr></table></figure>
<p>Added in API level 21</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- <span class="function"><span class="title">makeTaskLaunchBehind</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<p>Added in API level 21</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- makeThumbnailScaleUpAnimation(View <span class="keyword">source</span>, Bitmap thumbnail, <span class="keyword">int</span> startX, <span class="keyword">int</span> startY)</span><br></pre></td></tr></table></figure>
<p>Added in API level 16</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">	</span><br><span class="line">-<span class="ruby"> <span class="constant">ActivityOptions</span>å…¼å®¹åŒ…ï¼š<span class="constant">ActivityOptionsCompat</span></span><br><span class="line"></span>	-<span class="ruby"> è‡ªå®šä¹‰åŠ¨ç”»<span class="symbol">:makeCustomAnimation</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>public static ActivityOptions makeCustomAnimation(Context context,</p>
<pre><code><span class="keyword">int</span> enterResId, <span class="keyword">int</span> exitResId) {
</code></pre><p>return makeCustomAnimation(context, enterResId, exitResId, null, null);</p>
<pre><code>}
</code></pre><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">		</span><br><span class="line">enterResId:å¼€å¯çš„åŠ¨ç”»</span><br><span class="line">exitResIdï¼šé€€å‡ºçš„åŠ¨ç”»</span><br><span class="line">		</span><br><span class="line">-<span class="ruby"> makeThumbnailAspectScaleDownAnimation</span><br><span class="line"></span>-<span class="ruby"> makeClipRevealAnimation</span><br><span class="line"></span>		-<span class="ruby"> <span class="constant">Android</span> <span class="constant">API19</span>ä»¥ä¸Šä½¿ç”¨</span><br><span class="line"></span>-<span class="ruby"> makeScaleUpAnimation</span><br><span class="line"></span>		-<span class="ruby"> æ”¾å¤§åŠ¨ç”»ï¼Œä»æŒ‡å®šviewçš„æŒ‡å®šä½ç½®å¼€å§‹æ”¾å¤§ </span><br><span class="line"></span>-<span class="ruby"> makeSceneTransitionAnimation</span><br><span class="line"></span>		-<span class="ruby"> å…±äº«viewæ”¾å¤§æ•ˆæœï¼Œä»…æ”¯æŒ<span class="constant">API</span>&gt;=<span class="number">21</span> </span><br><span class="line"></span>-<span class="ruby"> åº•å±‚å®ç°åŠ¨ç”»ï¼šä»€ä¹ˆåŠ¨ç”»å®ç°ï¼Ÿ</span></span><br></pre></td></tr></table></figure>
<p>ActivityTransitionState</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">	</span><br></pre></td></tr></table></figure>
<p>public void startExitOutTransition(Activity activity, Bundle options) {<br>  if (!activity.getWindow().hasFeature(Window.FEATURE_ACTIVITY_TRANSITIONS)) {</p>
<pre><code><span class="keyword">return</span>;
</code></pre><p>  }<br>  ActivityOptions activityOptions = new ActivityOptions(options);<br>  mEnterTransitionCoordinator = null;<br>  //æ˜¯å¦è½¬åœºåŠ¨ç”»<br>  if (activityOptions.getAnimationType() == ActivityOptions.ANIM_SCENE_TRANSITION) {</p>
<pre><code>int key = activityOptions.getExitCoordinatorKey<span class="params">()</span>;
int index = mExitTransitionCoordinators.indexOfKey<span class="params">(key)</span>;
<span class="keyword">if</span> <span class="params">(index &gt;= <span class="number">0</span>)</span> {
    mCalledExitCoordinator = mExitTransitionCoordinators.valueAt<span class="params">(index)</span>.get<span class="params">()</span>;
    mExitTransitionCoordinators.removeAt<span class="params">(index)</span>;
    <span class="keyword">if</span> <span class="params">(mCalledExitCoordinator != null)</span> {
        mExitingFrom = mCalledExitCoordinator.getAcceptedNames<span class="params">()</span>;
        mExitingTo = mCalledExitCoordinator.getMappedNames<span class="params">()</span>;
        mExitingToView = mCalledExitCoordinator.copyMappedViews<span class="params">()</span>;
        mCalledExitCoordinator.startExit<span class="params">()</span>;
    }
}
</code></pre><p>  }<br>}</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">	-<span class="ruby"> <span class="constant">Transition</span>è§£æ</span><br><span class="line"></span>		-<span class="ruby"> [<span class="constant">Android</span>æœ€æ–°åŠ¨ç”»æ¡†æ¶å®Œå…¨è§£æï¼ˆäºŒï¼‰â€”â€”<span class="constant">Transitions</span> <span class="constant">Framework</span>](<span class="symbol">http:</span>/<span class="regexp">/blog.csdn.net/l</span>664675249/article/details/<span class="number">50195847</span><span class="comment">#t0)</span></span><br><span class="line"></span>		-<span class="ruby"> [<span class="constant">Android</span>æœ€æ–°åŠ¨ç”»æ¡†æ¶å®Œå…¨è§£æï¼ˆä¸€ï¼‰â€”â€” <span class="constant">Animator</span>(<span class="constant">Property</span> <span class="constant">Animation</span>)](<span class="symbol">http:</span>/<span class="regexp">/blog.csdn.net/l</span>664675249/article/details/<span class="number">50204503</span>)</span><br><span class="line"></span>-<span class="ruby"> <span class="constant">FragmentTransaction</span>åŠ¨ç”»</span><br><span class="line"></span>	-<span class="ruby"> setCustomAnimations(int enter, int exit, int popEnter, int popExit)</span></span><br></pre></td></tr></table></figure>
<p>Added in API level 13</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- setCustomAnimations(<span class="keyword">int</span> enter, <span class="keyword">int</span> <span class="built_in">exit</span>)</span><br></pre></td></tr></table></figure>
<p>Added in API level 11</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- <span class="function"><span class="title">setTransition</span><span class="params">(int transit)</span></span></span><br></pre></td></tr></table></figure>
<p>Added in API level 1<br>TRANSIT_NONE, TRANSIT_FRAGMENT_OPEN, or TRANSIT_FRAGMENT_CLOSE</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>åº•å±‚æºç :ä»€ä¹ˆåŠ¨ç”»å®ç°ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>BackStackState</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">	</span><br></pre></td></tr></table></figure>
<p>public void run() {<br>  if (FragmentManagerImpl.DEBUG) Log.v(TAG, â€œRun: â€œ + this);</p>
<p>  if (mAddToBackStack) {</p>
<pre><code><span class="keyword">if</span> (mIndex &lt; <span class="number">0</span>) {
    <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"addToBackStack() called after commit()"</span>);
}
</code></pre><p>  }</p>
<p>  bumpBackStackNesting(1);</p>
<p>  TransitionState state = null;<br>  SparseArray<fragment> firstOutFragments = null;<br>  SparseArray<fragment> lastInFragments = null;<br>  if (SUPPORTS_TRANSITIONS &amp;&amp; mManager.mCurState &gt;= Fragment.CREATED) {</fragment></fragment></p>
<pre><code>firstOutFragments = new SparseArray<span class="variable">&lt;Fragment&gt;</span>();
lastInFragments = new SparseArray<span class="variable">&lt;Fragment&gt;</span>();

calculateFragments(firstOutFragments, lastInFragments);

<span class="keyword">state</span> = beginTransition(firstOutFragments, lastInFragments, false);
</code></pre><p>  }</p>
<p>  int transitionStyle = state != null ? 0 : mTransitionStyle;<br>  int transition = state != null ? 0 : mTransition;<br>  Op op = mHead;<br>  while (op != null) {</p>
<pre><code><span class="typename">int</span> enterAnim = state != <span class="literal">null</span> ? 0 : op.enterAnim;
<span class="typename">int</span> exitAnim = state != <span class="literal">null</span> ? 0 : op.exitAnim;
<span class="keyword">switch</span> (op.cmd) {
    <span class="keyword">case</span> <span class="string">OP_ADD:</span> {
        Fragment f = op.fragment;
        f.mNextAnim = enterAnim;
        mManager.addFragment(f, <span class="literal">false</span>);
    } <span class="keyword">break</span>;
    <span class="keyword">case</span> <span class="string">OP_REPLACE:</span> {
        Fragment f = op.fragment;
        <span class="typename">int</span> containerId = f.mContainerId;
        <span class="keyword">if</span> (mManager.mAdded != <span class="literal">null</span>) {
            <span class="keyword">for</span> (<span class="typename">int</span> i = mManager.mAdded.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) {
                Fragment old = mManager.mAdded.get(i);
                <span class="keyword">if</span> (FragmentManagerImpl.DEBUG) Log.v(TAG,
                        <span class="string">"OP_REPLACE: adding="</span> + f + <span class="string">" old="</span> + old);
                <span class="keyword">if</span> (old.mContainerId == containerId) {
                    <span class="keyword">if</span> (old == f) {
                        op.fragment = f = <span class="literal">null</span>;
                    } <span class="keyword">else</span> {
                        <span class="keyword">if</span> (op.removed == <span class="literal">null</span>) {
                            op.removed = <span class="keyword">new</span> ArrayList&lt;Fragment&gt;();
                        }
                        op.removed.add(old);
                        old.mNextAnim = exitAnim;
                        <span class="keyword">if</span> (mAddToBackStack) {
                            old.mBackStackNesting += <span class="number">1</span>;
                            <span class="keyword">if</span> (FragmentManagerImpl.DEBUG) Log.v(TAG, <span class="string">"Bump nesting of "</span>
                                    + old + <span class="string">" to "</span> + old.mBackStackNesting);
                        }
                        mManager.removeFragment(old, transition, transitionStyle);
                    }
                }
            }
        }
        <span class="keyword">if</span> (f != <span class="literal">null</span>) {
            f.mNextAnim = enterAnim;
            mManager.addFragment(f, <span class="literal">false</span>);
        }
    } <span class="keyword">break</span>;
    <span class="keyword">case</span> <span class="string">OP_REMOVE:</span> {
        Fragment f = op.fragment;
        f.mNextAnim = exitAnim;
        mManager.removeFragment(f, transition, transitionStyle);
    } <span class="keyword">break</span>;
    <span class="keyword">case</span> <span class="string">OP_HIDE:</span> {
        Fragment f = op.fragment;
        f.mNextAnim = exitAnim;
        mManager.hideFragment(f, transition, transitionStyle);
    } <span class="keyword">break</span>;
    <span class="keyword">case</span> <span class="string">OP_SHOW:</span> {
        Fragment f = op.fragment;
        f.mNextAnim = enterAnim;
        mManager.showFragment(f, transition, transitionStyle);
    } <span class="keyword">break</span>;
    <span class="keyword">case</span> <span class="string">OP_DETACH:</span> {
        Fragment f = op.fragment;
        f.mNextAnim = exitAnim;
        mManager.detachFragment(f, transition, transitionStyle);
    } <span class="keyword">break</span>;
    <span class="keyword">case</span> <span class="string">OP_ATTACH:</span> {
        Fragment f = op.fragment;
        f.mNextAnim = enterAnim;
        mManager.attachFragment(f, transition, transitionStyle);
    } <span class="keyword">break</span>;
<span class="label">    default:</span> {
        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Unknown cmd: "</span> + op.cmd);
    }
}
op = op.next;
</code></pre><p>  }</p>
<p>  mManager.moveToState(mManager.mCurState, transition, transitionStyle, true);</p>
<p>  if (mAddToBackStack) {</p>
<pre><code>mManager.addBackStackState(<span class="keyword">this</span>);
</code></pre><p>  }<br>}<br>````</p>
</li>
<li><a href="http://www.jianshu.com/p/fd71d65f0ec6" target="_blank" rel="external">ä¸ºä»€ä¹ˆä¸å»ºè®®ç”¨FragmentTransactionåŠ¨ç”»</a></li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/43536355" target="_blank" rel="external">AndroidåŠ¨ç”»</a></li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«/">ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬56æœŸ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/20/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬56æœŸ/" class="article-date">
  	<time datetime="2016-05-20T14:35:00.000Z" itemprop="datePublished">2016-05-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/20/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬56æœŸ/">ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬56æœŸ</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="RunTimeç®€ä»‹åŠå®è·µ_-_åˆ˜åº·">RunTimeç®€ä»‹åŠå®è·µ - åˆ˜åº·</h2><h4 id="å‰è¨€">å‰è¨€</h4><p>ä»Šå¹´å¹´åˆçš„é¢è¯•ä¸­ï¼ŒåŸºæœ¬ä¸Šè¶…è¿‡äº†60%çš„å…¬å¸ä¼šé—®RunTimeçš„ä¸€äº›ç”¨æ³•ã€‚<br>åœ¨å¾ˆå¤šå¼€æºé¡¹ç›®ä¸­ç”¨åˆ°äº†RunTimeçš„æ–¹æ³•ï¼Œä½¿æˆ‘ä»¬ç†è§£èµ·æ¥æ¯”è¾ƒåƒåŠ›ã€‚<br>RunTimeç¡®å®å¾ˆå¼ºå¤§ï¼Œå€ŸåŠ©å®ƒå¯ä»¥å®ç°å¾ˆé…·çš„åŠŸèƒ½ã€‚æ¯”å¦‚<code>JSPatch</code>ã€‚<br>æˆ‘æœ¬èº«å¯¹äºRunTimeçš„ç†è§£ä¹Ÿæ²¡æœ‰å¾ˆæ·±å…¥ï¼Œæ‰€ä»¥è¿™é‡Œè®¨è®ºçš„ä¸»è¦æ˜¯RunTimeçš„å…·ä½“åº”ç”¨åœºæ™¯ã€‚æ­¤ç•ªæ¢ç´¢å¸Œæœ›èƒ½èµ·åˆ°æŠ›ç –å¼•ç‰çš„ä½œç”¨ï¼Œå¤§å®¶å¯ä»¥å°†RunTimeåº”ç”¨èµ·æ¥ã€‚</p>
<h4 id="ç®€ä»‹">ç®€ä»‹</h4><ul>
<li>RunTimeç®€ç§°è¿è¡Œæ—¶ã€‚æ˜¯ä¸€å¥—åº•å±‚çš„<code>Cè¯­è¨€API</code>ï¼ŒåŒ…å«å¾ˆå¤šå¼ºå¤§å®ç”¨çš„Cè¯­è¨€æ•°æ®ç±»å‹å’ŒCè¯­è¨€å‡½æ•°ï¼Œå¹³æ—¶æˆ‘ä»¬ç¼–å†™çš„ObjCä»£ç ï¼Œåº•å±‚éƒ½æ˜¯åŸºäºruntimeå®ç°çš„ã€‚ObjCå°±æ˜¯è¿è¡Œæ—¶æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯åœ¨è¿è¡Œæ—¶å€™çš„ä¸€äº›æœºåˆ¶ï¼Œå…¶ä¸­æœ€ä¸»è¦çš„æ˜¯æ¶ˆæ¯æœºåˆ¶ã€‚æ¯”å¦‚ï¼š</li>
</ul>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span>å‘é€æ¶ˆæ¯<span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line">Person<span class="keyword">*</span> p = [[Person alloc] init];</span><br><span class="line"></span><br><span class="line">// è°ƒç”¨å¯¹è±¡æ–¹æ³•</span><br><span class="line">[p eat];</span><br><span class="line">// æœ¬è´¨æ˜¯å‘å¯¹è±¡å‘é€æ¶ˆæ¯ï¼š objc_msgSend(p, <span class="comment">@selector(eat));</span></span><br><span class="line"></span><br><span class="line">// è°ƒç”¨ç±»æ–¹æ³•çš„æ–¹å¼æœ‰ä¸¤ç§</span><br><span class="line">// ç¬¬ä¸€ç§é€šè¿‡ç±»åè°ƒç”¨</span><br><span class="line">[Person eat];</span><br><span class="line">// ç¬¬äºŒç§é€šè¿‡ç±»å¯¹è±¡è°ƒç”¨</span><br><span class="line">[[Person class] eat];</span><br><span class="line">// ç”¨ç±»åè°ƒç”¨ç±»æ–¹æ³•ï¼Œåº•å±‚ä¼šè‡ªåŠ¨æŠŠç±»åè½¬æ¢æˆç±»å¯¹è±¡è°ƒç”¨</span><br><span class="line">// æœ¬è´¨ï¼šè®©ç±»å¯¹è±¡å‘é€æ¶ˆæ¯ï¼šobjc_msgSend([Person class], <span class="comment">@selector(eat));</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å¯¹äºCè¯­è¨€ï¼Œå‡½æ•°çš„è°ƒç”¨åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šå†³å®šè°ƒç”¨å“ªä¸ªå‡½æ•°ã€‚</li>
<li>å¯¹äºOCçš„å‡½æ•°ï¼Œå±äºåŠ¨æ€è°ƒç”¨è¿‡ç¨‹ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™å¹¶ä¸èƒ½å†³å®šçœŸæ­£è°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œåªæœ‰åœ¨çœŸæ­£è¿è¡Œçš„æ—¶å€™æ‰ä¼šæ ¹æ®å‡½æ•°çš„åç§°æ‰¾åˆ°å¯¹åº”çš„å‡½æ•°æ¥è°ƒç”¨ã€‚</li>
<li>äº‹å®è¯æ˜ï¼š<ul>
<li>åœ¨ç¼–è¯‘é˜¶æ®µï¼ŒOCå¯ä»¥<strong>è°ƒç”¨ä»»ä½•å‡½æ•°</strong>ï¼Œå³ä½¿è¿™ä¸ªå‡½æ•°å¹¶æœªå®ç°ï¼Œåªè¦å£°æ˜è¿‡å°±ä¸ä¼šæŠ¥é”™ã€‚</li>
<li>åœ¨ç¼–è¯‘é˜¶æ®µï¼ŒCè¯­è¨€è°ƒç”¨<strong>æœªå®ç°çš„å‡½æ•°</strong>å°±ä¼šæŠ¥é”™ã€‚</li>
</ul>
</li>
</ul>
<h4 id="å®è·µ">å®è·µ</h4><h5 id="ä¸€-_æ–¹æ³•äº¤æ¢">ä¸€. æ–¹æ³•äº¤æ¢</h5><ul>
<li>å¼€å‘ä½¿ç”¨åœºæ™¯:ç³»ç»Ÿè‡ªå¸¦çš„æ–¹æ³•åŠŸèƒ½ä¸å¤Ÿï¼Œç»™ç³»ç»Ÿè‡ªå¸¦çš„æ–¹æ³•æ‰©å±•ä¸€äº›åŠŸèƒ½ï¼Œå¹¶ä¸”ä¿æŒåŸæœ‰çš„åŠŸèƒ½ã€‚<ul>
<li>æ–¹å¼ä¸€:ç»§æ‰¿ç³»ç»Ÿçš„ç±»ï¼Œé‡å†™æ–¹æ³•.</li>
<li>æ–¹å¼äºŒ:ä½¿ç”¨runtimeï¼Œäº¤æ¢æ–¹æ³•.</li>
</ul>
</li>
</ul>
<p>ä¾‹å¦‚ï¼Œæœ‰éœ€æ±‚å¦‚ä¸‹ï¼š<br><strong>ç»™imageNamedæ–¹æ³•æä¾›åŠŸèƒ½ï¼Œæ¯æ¬¡åŠ è½½å›¾ç‰‡å°±åˆ¤æ–­å›¾ç‰‡æ˜¯å¦åŠ è½½æˆåŠŸã€‚</strong></p>
<p>runtimeå®ç°æ€è·¯ï¼š</p>
<ol>
<li>å†™ä¸€ä¸ªUIImageåˆ†ç±»ï¼Œåœ¨åˆ†ç±»ä¸­å®šä¹‰ä¸€ä¸ªèƒ½åŠ è½½å›¾ç‰‡å¹¶ä¸”èƒ½æ‰“å°çš„æ–¹æ³•+ (instancetype)imageWithName:(NSString *)name;</li>
<li>äº¤æ¢imageNamedå’ŒimageWithNameçš„å®ç°ï¼Œå°±èƒ½è°ƒç”¨imageWithNameï¼Œé—´æ¥è°ƒç”¨imageWithNameçš„å®ç°ã€‚</li>
</ol>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIImage</span> (<span class="title">image</span>)</span></span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)load</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// äº¤æ¢æ–¹æ³•</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–imageWithNameæ–¹æ³•åœ°å€</span></span><br><span class="line">    Method imageWithName = class_getClassMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(imageWithName:));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–imageWithNameæ–¹æ³•åœ°å€</span></span><br><span class="line">    Method imageName = class_getClassMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(imageNamed:));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// äº¤æ¢æ–¹æ³•åœ°å€ï¼Œç›¸å½“äºäº¤æ¢å®ç°æ–¹å¼</span></span><br><span class="line">    method_exchangeImplementations(imageWithName, imageName);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ—¢èƒ½åŠ è½½å›¾ç‰‡åˆèƒ½æ‰“å°</span></span><br><span class="line">+ (instancetype)imageWithName:(<span class="built_in">NSString</span> *)name</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œè°ƒç”¨imageWithNameï¼Œç›¸å½“äºè°ƒç”¨imageName</span></span><br><span class="line">    <span class="built_in">UIImage</span> *image = [<span class="keyword">self</span> imageWithName:name];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (image == <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"åŠ è½½ç©ºçš„å›¾ç‰‡"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> image;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h5 id="äºŒ-_åŠ¨æ€æ·»åŠ æ–¹æ³•">äºŒ. åŠ¨æ€æ·»åŠ æ–¹æ³•</h5><ul>
<li>å¼€å‘ä½¿ç”¨åœºæ™¯ï¼šå¦‚æœä¸€ä¸ªç±»ï¼Œæ–¹æ³•éå¸¸å¤šï¼ŒåŠ è½½ç±»åˆ°å†…å­˜çš„æ—¶å€™ä¹Ÿæ¯”è¾ƒè€—è´¹èµ„æºï¼Œå› ä¸ºéœ€è¦ç»™æ¯ä¸ªæ–¹æ³•ç”Ÿæˆæ˜ å°„è¡¨ã€‚å¯ä»¥ä½¿ç”¨åŠ¨æ€ç»™æŸä¸ªç±»æ·»åŠ æ–¹æ³•è§£å†³ã€‚</li>
<li>é¢è¯•é¢˜ï¼šæœ‰æ²¡æœ‰ä½¿ç”¨<code>performSelector</code>ï¼Œå…¶å®ä¸»è¦æƒ³é—®ä½ æœ‰æ²¡æœ‰åŠ¨æ€æ·»åŠ è¿‡æ–¹æ³•ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œç»™personç±»å¢åŠ walkçš„åŠŸèƒ½ï¼Œ é»˜è®¤personï¼Œæ²¡æœ‰å®ç°walkæ–¹æ³•ï¼Œé€šè¿‡performSelectorè°ƒç”¨ä¼šæŠ¥é”™ã€‚ä½†å½“æˆ‘åŠ¨æ€æ·»åŠ äº†æ–¹æ³•è°ƒç”¨<code>[p performSelector:@selector(walk)]</code>å°±ä¸ä¼šæŠ¥é”™äº†ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é»˜è®¤æ–¹æ³•éƒ½æœ‰ä¸¤ä¸ªéšå¼å‚æ•°</span></span><br><span class="line"><span class="keyword">void</span> walk(<span class="keyword">id</span> <span class="keyword">self</span>, SEL sel)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@ %@"</span>,<span class="keyword">self</span>,<span class="built_in">NSStringFromSelector</span>(sel));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“ä¸€ä¸ªå¯¹è±¡è°ƒç”¨æœªå®ç°çš„æ–¹æ³•ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•å¤„ç†,å¹¶ä¸”ä¼šæŠŠå¯¹åº”çš„æ–¹æ³•åˆ—è¡¨ä¼ è¿‡æ¥.</span></span><br><span class="line"><span class="comment">// è¿™å„¿å¯ä»¥ç”¨æ¥åˆ¤æ–­ï¼Œæœªå®ç°çš„æ–¹æ³•æ˜¯ä¸æ˜¯æˆ‘ä»¬æƒ³è¦åŠ¨æ€æ·»åŠ çš„æ–¹æ³•</span></span><br><span class="line">+ (<span class="built_in">BOOL</span>)resolveInstanceMethod:(SEL)sel</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (sel == <span class="keyword">@selector</span>(walk)) &#123;</span><br><span class="line">        <span class="comment">// åŠ¨æ€æ·»åŠ walkæ–¹æ³•</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šç»™å“ªä¸ªç±»æ·»åŠ æ–¹æ³•</span></span><br><span class="line">        <span class="comment">// ç¬¬äºŒä¸ªå‚æ•°ï¼šæ·»åŠ æ–¹æ³•çš„æ–¹æ³•ç¼–å·</span></span><br><span class="line">        <span class="comment">// ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šæ·»åŠ æ–¹æ³•çš„å‡½æ•°å®ç°ï¼ˆå‡½æ•°åœ°å€ï¼‰</span></span><br><span class="line">        <span class="comment">// ç¬¬å››ä¸ªå‚æ•°ï¼šå‡½æ•°çš„ç±»å‹ï¼Œ(è¿”å›å€¼+å‚æ•°ç±»å‹) v:void @:å¯¹è±¡-&gt;self :è¡¨ç¤ºSEL-&gt;_cmd</span></span><br><span class="line">        class_addMethod(<span class="keyword">self</span>, sel, walk, <span class="string">"v@:"</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> resolveInstanceMethod:sel];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="ä¸‰-_ç»™åˆ†ç±»æ·»åŠ å±æ€§">ä¸‰. ç»™åˆ†ç±»æ·»åŠ å±æ€§</h5><ul>
<li>åŸç†ï¼šç»™ä¸€ä¸ªç±»å£°æ˜å±æ€§ï¼Œå…¶å®æœ¬è´¨å°±æ˜¯ç»™è¿™ä¸ªç±»æ·»åŠ å…³è”ï¼Œå¹¶ä¸æ˜¯ç›´æ¥æŠŠè¿™ä¸ªå€¼çš„å†…å­˜ç©ºé—´æ·»åŠ åˆ°ç±»å­˜ç©ºé—´ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼šç»™<code>NSObject</code>æ·»åŠ ä¸€ä¸ª<code>name</code>å±æ€§ã€‚<br>æ€è·¯ï¼šåœ¨NSObjectä¸­ï¼ŒsetNameæ–¹æ³•ä¸­è®¾ç½®å…³è”å€¼ï¼Œnameæ–¹æ³•ä¸­é€šè¿‡å–å‡ºå…³è”å€¼ã€‚è¾¾åˆ°æ·»åŠ å±æ€§çš„æ•ˆæœã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰å…³è”çš„key</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> *key = <span class="string">"name"</span>;</span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSObject</span> (<span class="title">Property</span>)</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)name</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®å…³è”çš„keyï¼Œè·å–å…³è”çš„å€¼ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> objc_getAssociatedObject(<span class="keyword">self</span>, key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setName:(<span class="built_in">NSString</span> *)name</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šç»™å“ªä¸ªå¯¹è±¡æ·»åŠ å…³è”</span></span><br><span class="line">    <span class="comment">// ç¬¬äºŒä¸ªå‚æ•°ï¼šå…³è”çš„keyï¼Œé€šè¿‡è¿™ä¸ªkeyè·å–</span></span><br><span class="line">    <span class="comment">// ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šå…³è”çš„value</span></span><br><span class="line">    <span class="comment">// ç¬¬å››ä¸ªå‚æ•°ï¼šå…³è”çš„ç­–ç•¥</span></span><br><span class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, key, name, OBJC_ASSO<span class="built_in">CIATION_RETAIN_NONATOMIC</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h5 id="å››-_æ›´ä¾¿æ·çš„archive/unarchive">å››. æ›´ä¾¿æ·çš„archive/unarchive</h5><p>éœ€æ±‚ï¼šå®ç°å¯¹è±¡çš„å½’æ¡£å’Œè§£æ¡£<br>æ€è·¯ï¼šåˆ©ç”¨Runtimeå®ç°å¿«é€Ÿéå†å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œå‡å°‘å¤§é‡ç±»ä¼¼äº<code>self.property=[aDecoder decodeObjectForKey:type];</code>ä»¥åŠ<code>[aCoder encodeObject:self.property forKey:type]</code>è¿™ç§ä»£ç ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)encodeWithCoder:(<span class="built_in">NSCoder</span> *)encoder&#123;</span><br><span class="line">    <span class="comment">//å½’æ¡£å­˜å‚¨è‡ªå®šä¹‰å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//è·å¾—æŒ‡å‘è¯¥ç±»æ‰€æœ‰å±æ€§çš„æŒ‡é’ˆ</span></span><br><span class="line">    objc_property_t *properties = class_copyPropertyList([Person class], &amp;count);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i =<span class="number">0</span>; i &lt; count; i ++) &#123;</span><br><span class="line">        <span class="comment">//è·å¾—</span></span><br><span class="line">        objc_property_t property = properties[i];</span><br><span class="line">        <span class="comment">//æ ¹æ®objc_property_tè·å¾—å…¶å±æ€§çš„åç§°---&gt;Cè¯­è¨€çš„å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *name = property_getName(property);</span><br><span class="line">        <span class="built_in">NSString</span> *key = [<span class="built_in">NSString</span> stringWithUTF8String:name];</span><br><span class="line">        <span class="comment">// ç¼–ç æ¯ä¸ªå±æ€§,åˆ©ç”¨kVCå–å‡ºæ¯ä¸ªå±æ€§å¯¹åº”çš„æ•°å€¼</span></span><br><span class="line">        [encoder encodeObject:[<span class="keyword">self</span> valueForKeyPath:key] forKey:key];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithCoder:(<span class="built_in">NSCoder</span> *)decoder&#123;</span><br><span class="line">    <span class="comment">//å½’æ¡£å­˜å‚¨è‡ªå®šä¹‰å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//è·å¾—æŒ‡å‘è¯¥ç±»æ‰€æœ‰å±æ€§çš„æŒ‡é’ˆ</span></span><br><span class="line">    objc_property_t *properties = class_copyPropertyList([Person class], &amp;count);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i =<span class="number">0</span>; i &lt; count; i ++) &#123;</span><br><span class="line">        objc_property_t property = properties[i];</span><br><span class="line">        <span class="comment">//æ ¹æ®objc_property_tè·å¾—å…¶å±æ€§çš„åç§°---&gt;Cè¯­è¨€çš„å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *name = property_getName(property);</span><br><span class="line">        <span class="built_in">NSString</span> *key = [<span class="built_in">NSString</span> stringWithUTF8String:name];</span><br><span class="line">        <span class="comment">//è§£ç æ¯ä¸ªå±æ€§,åˆ©ç”¨kVCå–å‡ºæ¯ä¸ªå±æ€§å¯¹åº”çš„æ•°å€¼</span></span><br><span class="line">        [<span class="keyword">self</span> setValue:[decoder decodeObjectForKey:key] forKeyPath:key];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="äº”-_å­—å…¸è½¬æ¨¡å‹">äº”. å­—å…¸è½¬æ¨¡å‹</h5><p>éœ€æ±‚ï¼šèƒ½ä¸èƒ½è‡ªåŠ¨æ ¹æ®ä¸€ä¸ªå­—å…¸ï¼Œç”Ÿæˆå¯¹åº”çš„å±æ€§ã€‚</p>
<ul>
<li>æ€è·¯ä¸€ï¼šKVCã€‚é€šè¿‡KVCæ–¹æ³•<code>setValuesForKeysWithDictionary</code>å¯ä»¥è¿›è¡Œè½¬æ¢ã€‚<ul>
<li>å¼Šç«¯ï¼šå¿…é¡»ä¿è¯æ¨¡å‹ä¸­çš„å±æ€§å’Œå­—å…¸ä¸­çš„keyä¸€ä¸€å¯¹åº”ã€‚<ul>
<li>å¦‚æœä¸ä¸€è‡´ï¼Œå°±ä¼šè°ƒç”¨<code>[&lt;Status 0x7fa74b545d60&gt; setValue:forUndefinedKey:]</code>æŠ¥keyæ‰¾ä¸åˆ°çš„é”™ã€‚</li>
<li>åˆ†æ:æ¨¡å‹ä¸­çš„å±æ€§å’Œå­—å…¸çš„keyä¸ä¸€ä¸€å¯¹åº”ï¼Œç³»ç»Ÿå°±ä¼šè°ƒç”¨setValue:forUndefinedKey:æŠ¥é”™ã€‚</li>
<li>è§£å†³:é‡å†™å¯¹è±¡çš„setValue:forUndefinedKey:,æŠŠç³»ç»Ÿçš„æ–¹æ³•è¦†ç›–ï¼Œ å°±èƒ½ç»§ç»­ä½¿ç”¨KVCï¼Œå­—å…¸è½¬æ¨¡å‹äº†ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>æ€è·¯äºŒï¼šRunTimeã€‚åˆ©ç”¨è¿è¡Œæ—¶ï¼Œéå†æ¨¡å‹ä¸­æ‰€æœ‰å±æ€§ï¼Œæ ¹æ®æ¨¡å‹çš„å±æ€§åï¼Œå»å­—å…¸ä¸­æŸ¥æ‰¾keyï¼Œå–å‡ºå¯¹åº”çš„å€¼ï¼Œç»™æ¨¡å‹çš„å±æ€§èµ‹å€¼ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSObject</span> (<span class="title">Model</span>)</span></span><br><span class="line"></span><br><span class="line">+ (instancetype)modelWithDict:(<span class="built_in">NSDictionary</span> *)dict</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ€è·¯ï¼šéå†æ¨¡å‹ä¸­æ‰€æœ‰å±æ€§-ã€‹ä½¿ç”¨è¿è¡Œæ—¶</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 0.åˆ›å»ºå¯¹åº”çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">id</span> objc = [[<span class="keyword">self</span> alloc] init];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 1.åˆ©ç”¨runtimeç»™å¯¹è±¡ä¸­çš„æˆå‘˜å±æ€§èµ‹å€¼</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// class_copyIvarList:è·å–ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜å±æ€§</span></span><br><span class="line">    <span class="comment">// Ivarï¼šæˆå‘˜å±æ€§çš„æ„æ€</span></span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¡¨ç¤ºè·å–å“ªä¸ªç±»ä¸­çš„æˆå‘˜å±æ€§</span></span><br><span class="line">    <span class="comment">// ç¬¬äºŒä¸ªå‚æ•°ï¼šè¡¨ç¤ºè¿™ä¸ªç±»æœ‰å¤šå°‘æˆå‘˜å±æ€§ï¼Œä¼ å…¥ä¸€ä¸ªIntå˜é‡åœ°å€ï¼Œä¼šè‡ªåŠ¨ç»™è¿™ä¸ªå˜é‡èµ‹å€¼</span></span><br><span class="line">    <span class="comment">// è¿”å›å€¼Ivar *ï¼šæŒ‡çš„æ˜¯ä¸€ä¸ªivaræ•°ç»„ï¼Œä¼šæŠŠæ‰€æœ‰æˆå‘˜å±æ€§æ”¾åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œé€šè¿‡è¿”å›çš„æ•°ç»„å°±èƒ½å…¨éƒ¨è·å–åˆ°ã€‚</span></span><br><span class="line">    <span class="comment">/* ç±»ä¼¼ä¸‹é¢è¿™ç§å†™æ³•</span><br><span class="line">     </span><br><span class="line">     Ivar ivar;</span><br><span class="line">     Ivar ivar1;</span><br><span class="line">     Ivar ivar2;</span><br><span class="line">     // å®šä¹‰ä¸€ä¸ªivarçš„æ•°ç»„a</span><br><span class="line">     Ivar a[] = &#123;ivar,ivar1,ivar2&#125;;</span><br><span class="line">     </span><br><span class="line">     // ç”¨ä¸€ä¸ªIvar *æŒ‡é’ˆæŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ </span><br><span class="line">     Ivar *ivarList = a;</span><br><span class="line">     </span><br><span class="line">     // æ ¹æ®æŒ‡é’ˆè®¿é—®æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ </span><br><span class="line">     ivarList[0];</span><br><span class="line">     </span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> count;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–ç±»ä¸­çš„æ‰€æœ‰æˆå‘˜å±æ€§</span></span><br><span class="line">    Ivar *ivarList = class_copyIvarList(<span class="keyword">self</span>, &amp;count);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">        <span class="comment">// æ ¹æ®è§’æ ‡ï¼Œä»æ•°ç»„å–å‡ºå¯¹åº”çš„æˆå‘˜å±æ€§</span></span><br><span class="line">        Ivar ivar = ivarList[i];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–æˆå‘˜å±æ€§å</span></span><br><span class="line">        <span class="built_in">NSString</span> *name = [<span class="built_in">NSString</span> stringWithUTF8String:ivar_getName(ivar)];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¤„ç†æˆå‘˜å±æ€§å-&gt;å­—å…¸ä¸­çš„key</span></span><br><span class="line">        <span class="comment">// ä»ç¬¬ä¸€ä¸ªè§’æ ‡å¼€å§‹æˆªå–</span></span><br><span class="line">        <span class="built_in">NSString</span> *key = [name substringFromIndex:<span class="number">1</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ ¹æ®æˆå‘˜å±æ€§åå»å­—å…¸ä¸­æŸ¥æ‰¾å¯¹åº”çš„value</span></span><br><span class="line">        <span class="keyword">id</span> value = dict[key];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// äºŒçº§è½¬æ¢:å¦‚æœå­—å…¸ä¸­è¿˜æœ‰å­—å…¸ï¼Œä¹Ÿéœ€è¦æŠŠå¯¹åº”çš„å­—å…¸è½¬æ¢æˆæ¨¡å‹</span></span><br><span class="line">        <span class="comment">// åˆ¤æ–­ä¸‹valueæ˜¯å¦æ˜¯å­—å…¸</span></span><br><span class="line">        <span class="keyword">if</span> ([value isKindOfClass:[<span class="built_in">NSDictionary</span> class]]) &#123;</span><br><span class="line">            <span class="comment">// å­—å…¸è½¬æ¨¡å‹</span></span><br><span class="line">            <span class="comment">// è·å–æ¨¡å‹çš„ç±»å¯¹è±¡ï¼Œè°ƒç”¨modelWithDict</span></span><br><span class="line">            <span class="comment">// æ¨¡å‹çš„ç±»åå·²çŸ¥ï¼Œå°±æ˜¯æˆå‘˜å±æ€§çš„ç±»å‹</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// è·å–æˆå‘˜å±æ€§ç±»å‹</span></span><br><span class="line">            <span class="built_in">NSString</span> *type = [<span class="built_in">NSString</span> stringWithUTF8String:ivar_getTypeEncoding(ivar)];</span><br><span class="line">            <span class="comment">// ç”Ÿæˆçš„æ˜¯è¿™ç§@"@\"User\"" ç±»å‹ -ã€‹ @"User"  åœ¨OCå­—ç¬¦ä¸²ä¸­ \" -&gt; "ï¼Œ\æ˜¯è½¬ä¹‰çš„æ„æ€ï¼Œä¸å ç”¨å­—ç¬¦</span></span><br><span class="line">            <span class="comment">// è£å‰ªç±»å‹å­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="built_in">NSRange</span> range = [type rangeOfString:<span class="string">@"\""</span>];</span><br><span class="line">            </span><br><span class="line">            type = [type substringFromIndex:range<span class="variable">.location</span> + range<span class="variable">.length</span>];</span><br><span class="line">            </span><br><span class="line">            range = [type rangeOfString:<span class="string">@"\""</span>];</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// è£å‰ªåˆ°å“ªä¸ªè§’æ ‡ï¼Œä¸åŒ…æ‹¬å½“å‰è§’æ ‡</span></span><br><span class="line">            type = [type substringToIndex:range<span class="variable">.location</span>];</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æ ¹æ®å­—ç¬¦ä¸²ç±»åç”Ÿæˆç±»å¯¹è±¡</span></span><br><span class="line">            Class modelClass = <span class="built_in">NSClassFromString</span>(type);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (modelClass) &#123; <span class="comment">// æœ‰å¯¹åº”çš„æ¨¡å‹æ‰éœ€è¦è½¬</span></span><br><span class="line">                </span><br><span class="line">                <span class="comment">// æŠŠå­—å…¸è½¬æ¨¡å‹</span></span><br><span class="line">                value  =  [modelClass modelWithDict:value];</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä¸‰çº§è½¬æ¢ï¼šNSArrayä¸­ä¹Ÿæ˜¯å­—å…¸ï¼ŒæŠŠæ•°ç»„ä¸­çš„å­—å…¸è½¬æ¢æˆæ¨¡å‹.</span></span><br><span class="line">        <span class="comment">// åˆ¤æ–­å€¼æ˜¯å¦æ˜¯æ•°ç»„</span></span><br><span class="line">        <span class="keyword">if</span> ([value isKindOfClass:[<span class="built_in">NSArray</span> class]]) &#123;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­å¯¹åº”ç±»æœ‰æ²¡æœ‰å®ç°å­—å…¸æ•°ç»„è½¬æ¨¡å‹æ•°ç»„çš„åè®®</span></span><br><span class="line">            <span class="keyword">if</span> ([<span class="keyword">self</span> respondsToSelector:<span class="keyword">@selector</span>(arrayContainModelClass)]) &#123;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// è½¬æ¢æˆidç±»å‹ï¼Œå°±èƒ½è°ƒç”¨ä»»ä½•å¯¹è±¡çš„æ–¹æ³•</span></span><br><span class="line">                <span class="keyword">id</span> idSelf = <span class="keyword">self</span>;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// è·å–æ•°ç»„ä¸­å­—å…¸å¯¹åº”çš„æ¨¡å‹</span></span><br><span class="line">                <span class="built_in">NSString</span> *type =  [idSelf arrayContainModelClass][key];</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// ç”Ÿæˆæ¨¡å‹</span></span><br><span class="line">                Class classModel = <span class="built_in">NSClassFromString</span>(type);</span><br><span class="line">                <span class="built_in">NSMutableArray</span> *arrM = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">                <span class="comment">// éå†å­—å…¸æ•°ç»„ï¼Œç”Ÿæˆæ¨¡å‹æ•°ç»„</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">NSDictionary</span> *dict <span class="keyword">in</span> value) &#123;</span><br><span class="line">                    <span class="comment">// å­—å…¸è½¬æ¨¡å‹</span></span><br><span class="line">                    <span class="keyword">id</span> model =  [classModel modelWithDict:dict];</span><br><span class="line">                    [arrM addObject:model];</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// æŠŠæ¨¡å‹æ•°ç»„èµ‹å€¼ç»™value</span></span><br><span class="line">                value = arrM;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (value) &#123; <span class="comment">// æœ‰å€¼ï¼Œæ‰éœ€è¦ç»™æ¨¡å‹çš„å±æ€§èµ‹å€¼</span></span><br><span class="line">            <span class="comment">// åˆ©ç”¨KVCç»™æ¨¡å‹ä¸­çš„å±æ€§èµ‹å€¼</span></span><br><span class="line">            [objc setValue:value forKey:key];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> objc;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<h4 id="Swift_Runtime">Swift Runtime</h4><ul>
<li>çº¯Swiftçš„ç±»ï¼Œä¸èƒ½é€šè¿‡runtimeè·å–åˆ°å±æ€§ä¸æ–¹æ³•ã€‚æ¯”å¦‚tupleï¼šçº¯Swiftç±»çš„å‡½æ•°è°ƒç”¨å·²ç»ä¸å†æ˜¯OCçš„è¿è¡Œæ—¶å‘æ¶ˆæ¯objc_msgsendï¼Œè€Œæ˜¯ç±»ä¼¼C++çš„vtableï¼Œåœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šäº†è°ƒç”¨ä»€ä¹ˆå‡½æ•°ï¼Œæ‰€ä»¥runtimeè·å–ä¸åˆ°ã€‚</li>
<li>ç»§æ‰¿äºNSObjectçš„ç±»ä¾ç„¶æ‹¥æœ‰åŠ¨æ€æ€§ï¼Œæ‰€ä»¥å¯ä»¥æ‹¿çš„åˆ°ã€‚</li>
<li>@objc<ul>
<li>@objcæ˜¯ç”¨æ¥å°†Swiftçš„APIå¯¼å‡ºç»™OCä¸OC runtimeä½¿ç”¨çš„ï¼Œå¦‚æœä½ ç»§æ‰¿NSObjectçš„ç±»ï¼Œå°†ä¼šè¢«è‡ªåŠ¨çš„åŠ å…¥è¿™ä¸ªæ ‡è¯†ã€‚</li>
</ul>
</li>
<li>dynamic<ul>
<li>åŠ äº†@objcæ ‡è¯†çš„æ–¹æ³•ã€å±æ€§éƒ½æ— æ³•ä¿è¯éƒ½ä¼šè¢«è¿è¡Œæ—¶è°ƒç”¨ï¼Œå› ä¸ºSwiftä¼šåšé™æ€ä¼˜åŒ–ã€‚è¦æƒ³å®Œå…¨è¢«åŠ¨æ€è°ƒç”¨å°±è¦ä½¿ç”¨dynamicä¿®é¥°è¯äº†ã€‚ä½¿ç”¨è¿™ä¸ªæ ‡è¯†ä¹Ÿä¼šéšå½¢çš„åŠ å…¥@objcã€‚è¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆä¸Šè¾¹VCä¸­çš„æ–¹æ³•æ— æ³•è¢«æ›¿æ¢äº†ï¼Œè¢«Swiftä¼˜åŒ–æˆé™æ€è°ƒç”¨äº†ï¼Œè€ŒViewDidAppearæœ¬èº«ä¸ºOCçš„æ–¹æ³•ï¼Œæ‹¥æœ‰åŠ¨æ€ç‰¹æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬åŠ å…¥dynamicå…³é”®å­—</li>
</ul>
</li>
</ul>
<h4 id="å°ç»“">å°ç»“</h4><ul>
<li>Runtimeæ˜¯è¿è¡Œæ—¶ç‰¹æ€§ ï¼Œæ–¹æ³•è°ƒç”¨çš„æœ¬è´¨æ˜¯ç»™å¯¹è±¡å‘æ¶ˆæ¯ï¼š<code>objc_msgSend</code></li>
<li><strong>class_getClassMethod</strong>: è·å–ç±»æ–¹æ³•åœ°å€</li>
<li><strong>class_getInstanceMethod</strong>: è·å–å®ä¾‹æ–¹æ³•åœ°å€</li>
<li><strong>method_exchangeImplementations</strong>ï¼šäº¤æ¢æ–¹æ³•çš„å®ç°</li>
<li><strong><code>+ (BOOL)resolveInstanceMethod:(SEL)sel</code></strong>: å½“ä¸€ä¸ªå¯¹è±¡è°ƒç”¨æœªå®ç°çš„æ–¹æ³•ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•å¤„ç†,å¹¶ä¸”ä¼šæŠŠå¯¹åº”çš„æ–¹æ³•åˆ—è¡¨ä¼ è¿‡æ¥.</li>
<li><strong>class_addMethod</strong>ï¼šç»™å®ä¾‹æ·»åŠ æ–¹æ³•</li>
<li><strong>objc_setAssociatedObject</strong>ï¼šç»™å¯¹è±¡è®¾ç½®å…³è”å€¼</li>
<li><strong>objc_getAssociatedObject</strong>ï¼šè·å–å¯¹è±¡çš„å…³è”å€¼</li>
<li><strong>class_copyPropertyList</strong>ï¼šè·å¾—æŒ‡å‘è¯¥ç±»æ‰€æœ‰å±æ€§çš„æŒ‡é’ˆ</li>
<li><strong>property_getName</strong>ï¼šå–å‡ºå±æ€§æŒ‡é’ˆå¯¹åº”çš„åç§°ï¼Œè¿”å›å­—ç¬¦ä¸²(char*)</li>
<li><strong>class_copyIvarList</strong>ï¼šè·å–æŒ‡å‘è¯¥ç±»æ‰€æœ‰æˆå‘˜å±æ€§æŒ‡é’ˆ</li>
<li><strong>ivar_getName</strong>ï¼šå–å‡ºæˆå‘˜å±æ€§å¯¹åº”çš„åç§°</li>
</ul>
<h4 id="å‚è€ƒ">å‚è€ƒ</h4><p>Runtimeç®€ä»‹ï¼š <a href="http://www.jianshu.com/p/94657b7d31d0" target="_blank" rel="external">http://www.jianshu.com/p/94657b7d31d0</a><br>Swift Runtime: <a href="http://www.jianshu.com/p/9c36a5b7820a" target="_blank" rel="external">http://www.jianshu.com/p/9c36a5b7820a</a><br>MJExtension: <a href="https://github.com/CoderMJLee/MJExtension" target="_blank" rel="external">https://github.com/CoderMJLee/MJExtension</a></p>
<h2 id="SourceTree_rebase_ç”¨æ³•_-_æ›¾é“­">SourceTree rebase ç”¨æ³• - æ›¾é“­</h2><h4 id="push_with_-rebase">push with <code>--rebase</code></h4><h4 id="push_å‰è°ƒæ•´æœ¬åœ°çš„_commits_tree">push å‰è°ƒæ•´æœ¬åœ°çš„ commits tree</h4><ul>
<li>Add some commits append to the branch</li>
<li>Right-click on a commit and hit <code>Rebase children of &lt;commit-id&gt; interactively...</code></li>
<li>Try <code>reorder</code> or <code>squash</code> or <code>edit message</code> or <code>delete</code></li>
<li>Click <code>OK</code></li>
<li>Enjoy <code>the history tree</code></li>
</ul>
<blockquote>
<p>æ³¨æ„:</p>
<ul>
<li>ä»…é€‚ç”¨äº local branch è¿˜æ²¡æœ‰ push çš„æƒ…å†µ!!!</li>
<li>push æ—¶ä¸è¦ä½¿ç”¨ <code>-f</code> å‚æ•°</li>
</ul>
</blockquote>
<h4 id="å‚è€ƒ-1">å‚è€ƒ</h4><ul>
<li><a href="http://gitbook.liuhui998.com/4_2.html" target="_blank" rel="external">Git Book ä¸­æ–‡ç‰ˆ - rebase</a></li>
<li><a href="https://segmentfault.com/q/1010000000430041" target="_blank" rel="external">å›¢é˜Ÿå¼€å‘é‡Œé¢‘ç¹ä½¿ç”¨ git rebase æ¥ä¿æŒæ ‘çš„æ•´æ´å¥½å—? - SegmentFault</a></li>
<li><a href="https://ihower.tw/blog/archives/8076" target="_blank" rel="external">ä¸‰å€‹ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç³»çµ±çš„å»ºè­° | ihower { blogging }</a> æ¨èæ­¤äººåšå®¢</li>
<li><a href="http://blogs.atlassian.com/2014/06/interactive-rebase-sourcetree/" target="_blank" rel="external">Interactive rebase in SourceTree | Atlassian Blogs</a></li>
</ul>
<h4 id="é™„å¸¦ä¸€æ">é™„å¸¦ä¸€æ</h4><ul>
<li>å¯¹äºåŒä¸€ä¸ª repo, æœ¬åœ° clone ä¸€ä»½å³å¯, ç”¨ branchs åˆ‡æ¢ä¸åŒçŠ¶æ€. å¦åˆ™æ¯ä¸ª repo éƒ½è¦ sync( pull&amp;push ) å¾ˆéº»çƒ¦</li>
<li>æ§åˆ¶å†™ä»£ç çš„èŠ‚å¥, åŠå°æ—¶æ•´ç†æ€è·¯, å°æ­¥æäº¤(èµ·æ¥èµ°èµ°å–æ¯æ°´), å–„ç”¨ <code>amend last commit</code> å’Œ <code>rebase</code>, ä¾¿äº reviewer ç†è§£</li>
</ul>
<h2 id="Firebase_-_ç‹èƒœ">Firebase - ç‹èƒœ</h2><p><a href="https://firebase.google.com/" target="_blank" rel="external">Firebase</a>æ˜¯ä¸€ä¸ªå¸®åŠ©ä½ å¿«é€Ÿå¼€å‘é«˜è´¨é‡çš„åº”ç”¨ç¨‹åºï¼Œå¢å¼ºä½ çš„ç”¨æˆ·åŸºç¡€ï¼Œå¹¶æé«˜ç›ˆåˆ©èƒ½åŠ›çš„ç§»åŠ¨å¼€å‘å¹³å°ã€‚Firebaseæœ‰å¾ˆå¤šäº’è¡¥æ€§çš„åŠŸèƒ½ç»„æˆï¼Œä½ å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚ï¼Œæ‰¾åˆ°é€‚ç”¨çš„åŠŸèƒ½æ¨¡å—æ­é…ä½¿ç”¨ã€‚</p>
<h3 id="åŠŸèƒ½ä»‹ç»">åŠŸèƒ½ä»‹ç»</h3><blockquote>
<p>æ€»ä½“åŠŸèƒ½é¢„è§ˆï¼š</p>
</blockquote>
<p><img src="https://lh3.googleusercontent.com/Jp5DG28Mj668TyylbnjcCjNvzh-9-IjxT1IixnKrOziswXJzQZZ8GUpRobmQPba0vvINC8c6GymEni3UYcAX3uLVdHFz0Z_x=s1600" alt="all-feature-preview"></p>
<h4 id="åˆ†æåŠŸèƒ½">åˆ†æåŠŸèƒ½</h4><p>Firebaseçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯Firebasesåˆ†æï¼Œä¸€ä¸ªå…è´¹ä¸”æ²¡æœ‰é™åˆ¶çš„åˆ†æè§£å†³æ–¹æ¡ˆã€‚é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„Dashboardçœ‹æ¿ï¼Œå¯ä»¥æŸ¥çœ‹ç”¨æˆ·çš„è¡Œä¸ºä»¥åŠå±æ€§çš„å®šé‡åˆ†æã€‚åŒæ—¶æ”¯æŒiOSå’ŒAndroidå¹³å°ï¼š</p>
<ul>
<li>æœ€å¤šå¯ä»¥æ— é™åˆ¶æŠ¥å‘Š500ä¸ªæ—¶é—´ç±»å‹ï¼Œæ¯ä¸€ä¸ªæ—¶é—´ç±»å‹å¯æ”¯æŒ25ä¸ªå±æ€§</li>
<li>ç»Ÿä¸€çš„dashbaordæŸ¥çœ‹ç”¨æˆ·è¡Œä¸ºä»¥åŠè·¨ç½‘ç»œæ€§èƒ½åˆ†æ</li>
<li>äººå£åˆ†å¸ƒï¼ŒåŒ…æ‹¬å¹´é¾„ã€æ€§åˆ«ä»¥åŠä½ç½®ä¿¡æ¯ç­‰</li>
<li>æä¾›å¯å¯¼å‡ºçš„BigQueryè‡ªå®šä¹‰æŸ¥è¯¢</li>
</ul>
<h4 id="Develop">Develop</h4><p>æ„å»ºæ›´å¥½çš„åº”ç”¨ç¨‹åºï¼Œå¹¶é¢„ç•™æ¥å£ç»™å¼€å‘è€…ã€‚èŠ‚çœå…³é”®çš„å¼€å‘æ—¶é—´ï¼Œäº§å‡ºé«˜è´¨é‡ã€æ— bugçš„åº”ç”¨ç¨‹åºã€‚</p>
<ul>
<li>äº‘ç«¯æ¶ˆæ¯<br>æä¾›å¯é çš„è·¨å¹³å°çš„æ¶ˆæ¯åˆ†å‘å’Œæ¥å—é€šé“</li>
<li>è®¤è¯<br>æä¾›å¥å£®çš„è®¤è¯æœºåˆ¶</li>
<li>å®æ—¶æ•°æ®<br>å®æ—¶å­˜å‚¨å’ŒåŒæ­¥åº”ç”¨æ•°æ®</li>
<li>å­˜å‚¨<br>ä¾¿æ·çš„æ–‡ä»¶å­˜å‚¨</li>
<li>å¯„ä¸»<br>å¿«é€Ÿåˆ†å‘ç½‘ç»œå†…å®¹</li>
<li>è¿œç¨‹é…ç½®<br>å¯è¿œç¨‹è‡ªå®šä¹‰åº”ç”¨çš„é…ç½®ä¿¡æ¯</li>
<li>æµ‹è¯•Lab<br>æä¾›äº‘ç«¯æµ‹è¯•åŠŸèƒ½</li>
<li>CrashæŠ¥å‘Š<br>ä¿è¯åº”ç”¨çš„ç¨³å®šæ€§</li>
</ul>
<h4 id="Grow">Grow</h4><p>åœ¨æ°å½“çš„æ—¶æœºï¼ŒåŸ¹å…»å¹¶å¸å¼•åˆé€‚çš„ç”¨æˆ·ã€‚ä¿ƒè¿›æ½œåœ¨ç”¨æˆ·çš„å¢é•¿ã€‚</p>
<ul>
<li>é€šçŸ¥<br>æ°å½“çš„æ—¶æœºå¸å¼•ç”¨æˆ·</li>
<li>Appç´¢å¼•<br>é©±åŠ¨æœ‰æ•ˆçš„æœç´¢æµé‡åˆ°ä½ çš„App</li>
<li>åŠ¨æ€é“¾æ¥<br>åº”ç”¨å†…å‘é€åŠ¨æ€é“¾æ¥ï¼Œå¼•å¯¼ç”¨æˆ·åˆ°æ­£ç¡®çš„åœ°æ–¹</li>
<li>é‚€è¯·<br>å¼•å¯¼ç”¨æˆ·åˆ†äº«ä½ çš„åº”ç”¨ç¨‹åº</li>
<li>AdWordså¹¿å‘Š<br>é€šè¿‡Googleæœç´¢è·å–ç”¨æˆ·</li>
</ul>
<h4 id="Earn">Earn</h4><p>é€šè¿‡å‘å…¨çƒç”¨æˆ·å±•ç¤ºå¸å¼•çš„å¹¿å‘Šèµšå–åˆ°æ”¶å…¥ã€‚</p>
<ul>
<li>AdMob<br>é€šè¿‡å¸å¼•æ€§çš„å¹¿å‘Šç›ˆåˆ©</li>
</ul>
<h3 id="å¼€å‘ä½¿ç”¨">å¼€å‘ä½¿ç”¨</h3><h4 id="å‰ç½®æ¡ä»¶">å‰ç½®æ¡ä»¶</h4><ul>
<li>ä¸€ä¸ªè¿è¡ŒGoogle PlayæœåŠ¡9.0.0ä»¥ä¸Šç‰ˆæœ¬çš„Androidè®¾å¤‡</li>
<li>é€šè¿‡ <a href="https://developer.android.com/tools/help/sdk-manager.html" target="_blank" rel="external">Android SDK Manager</a> è·å–Google Play services</li>
<li><a href="http://developer.android.com/sdk" target="_blank" rel="external">Android Studio</a> 1.5æˆ–è€…æ›´é«˜ç‰ˆæœ¬</li>
<li>ä¸€ä¸ªAndroid Studioé¡¹ç›®å’ŒåŒ…å</li>
</ul>
<blockquote>
<p>æ³¨æ„äº‹é¡¹ï¼š<br>Android Studioä½äº2.2ç‰ˆæœ¬ä¸­çš„Instant Runå­˜åœ¨Firebase Analyticså’Œç‰¹å®šäº‹ä»¶ä¿æŠ¤ä¸å…¼å®¹é—®é¢˜ï¼Œå®˜æ–¹å»ºè®®ç¦ç”¨ Instant runæˆ–è€…å‡çº§Android Studioåˆ°2.2é¢„è§ˆç‰ˆã€‚</p>
</blockquote>
<h4 id="åˆ›å»ºFirebaseé¡¹ç›®">åˆ›å»ºFirebaseé¡¹ç›®</h4><ul>
<li>è®¿é—® <a href="https://console.firebase.google.com/" target="_blank" rel="external">æ§åˆ¶å°</a>ï¼Œåˆ›å»ºä¸€ä¸ªFirebaseé¡¹ç›®ã€‚<br><img src="http://7xsk2b.com1.z0.glb.clouddn.com/image/firebase-create-project.png" alt="firebase-create-projec"></li>
<li>æ·»åŠ Firebaseåˆ°åº”ç”¨ç¨‹åº<br>é€‰æ‹©é¡¹ç›® -&gt; é¡¹ç›®è®¾ç½® -&gt; å°†Firebaseæ·»åŠ åˆ°æ‚¨çš„Android/iOS/ç½‘é¡µåº”ç”¨ï¼ŒæŒ‰ç…§å‘å¯¼ä¸€æ­¥ä¸€æ­¥å®Œæˆé…ç½®ã€‚<br><img src="http://7xsk2b.com1.z0.glb.clouddn.com/image/firebase-console-dashboard.png" alt="firebase-console-dashboard"><br><img src="http://7xsk2b.com1.z0.glb.clouddn.com/image/firebase-add-to-app.png" alt="firebase-add-to-app"></li>
<li>é€‰æ‹©éœ€è¦çš„åŠŸèƒ½æ¨¡å—ï¼ŒåŠ å…¥é¡¹ç›®ä¸­<br><img src="http://7xsk2b.com1.z0.glb.clouddn.com/image/firebase-feature-libs-list.png" alt="firebase-feature-libs-list"></li>
</ul>
<p>å…·ä½“çš„å¼€å‘æ–‡æ¡£ï¼Œ<a href="https://firebase.google.com/docs" target="_blank" rel="external">å‚è§å®˜ç½‘</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«/">ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬55æœŸ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/13/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬55æœŸ/" class="article-date">
  	<time datetime="2016-05-13T10:30:00.000Z" itemprop="datePublished">2016-05-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/13/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬55æœŸ/">ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬55æœŸ</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Android_MVVMå¼€å‘æ¨¡å¼_-_ç‹èƒœ">Android MVVMå¼€å‘æ¨¡å¼ - ç‹èƒœ</h2><p>MVVMï¼ˆ<a href="https://en.wikipedia.org/wiki/Model_View_ViewModel" target="_blank" rel="external">Modelï¼Viewï¼ViewModel</a>ï¼‰ï¼Œå®ƒæœ€åˆæ˜¯åœ¨2005å¹´ç”±å¾®è½¯æå‡ºçš„ä¸€ä¸ªè¢«è¯æ˜å¯ç”¨çš„æ¦‚å¿µã€‚åœ¨Google I/O 2015ä¸Šï¼Œä¼´éšç€Android Mé¢„è§ˆç‰ˆå‘å¸ƒçš„<a href="https://developer.android.com/tools/data-binding/guide.html" target="_blank" rel="external">Data Binding</a>ä½¿AndroidåŸç”Ÿå¼€å‘ä¹Ÿæ”¯æŒäº†MVVMæ¡†æ¶ã€‚</p>
<p><img src="https://tech.vg.no/files/2015/07/mvvm.png" alt="mvvm-workflow"></p>
<p>ä¸‹é¢è¿˜æ˜¯é€šè¿‡å¤©æ°”çš„ç¤ºä¾‹æ¥æ¼”ç¤ºMVVMæ¡†æ¶çš„è¿ç”¨ï¼Œæ•ˆæœå¦‚å›¾ï¼š<br><img src="http://7xsk2b.com1.z0.glb.clouddn.com/image/weather-app-screenshot.png" alt="weather-app-screenshot"></p>
<h2 id="ç›®å½•ç»“æ„">ç›®å½•ç»“æ„</h2><p>  <img src="http://7xsk2b.com2.z0.glb.clouddn.com/image/android-mvvm.png" alt="android-mvvm"></p>
<h3 id="å¼€å¯Data_BindingåŠŸèƒ½">å¼€å¯Data BindingåŠŸèƒ½</h3><p>Android Studioä¸­ï¼Œåœ¨éœ€è¦å¼€å¯Data BindingåŠŸèƒ½çš„Moduleä¸­çš„build.gradleæ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹å†…å®¹</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼€å¯Data BindingåŠŸèƒ½</span></span><br><span class="line">dataBinding &#123;</span><br><span class="line">    enabled <span class="keyword">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Modelå±‚_Weather">Modelå±‚ Weather</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Weather</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String date;<span class="comment">//æ—¥æœŸ</span></span><br><span class="line">    <span class="keyword">private</span> String textDay;<span class="comment">//ç™½å¤©å¤©æ°”</span></span><br><span class="line">    <span class="keyword">private</span> String textNight;<span class="comment">//å¤œæ™šå¤©æ°”</span></span><br><span class="line">    <span class="keyword">private</span> String high;<span class="comment">//æœ€é«˜æ°”æ¸©</span></span><br><span class="line">    <span class="keyword">private</span> String low;<span class="comment">//æœ€ä½æ°”æ¸©</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDisplay</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        sb.append(date);</span><br><span class="line">        sb.append(<span class="string">"\t"</span>);</span><br><span class="line">        sb.append(<span class="string">"ç™½å¤©:"</span>);</span><br><span class="line">        sb.append(textDay);</span><br><span class="line">        sb.append(<span class="string">", "</span>);</span><br><span class="line">        sb.append(<span class="string">"å¤œæ™š:"</span>);</span><br><span class="line">        sb.append(textNight);</span><br><span class="line">        sb.append(<span class="string">", "</span>);</span><br><span class="line">        sb.append(<span class="string">"æœ€é«˜æ°”æ¸©:"</span>);</span><br><span class="line">        sb.append(high);</span><br><span class="line">        sb.append(<span class="string">", "</span>);</span><br><span class="line">        sb.append(<span class="string">"æœ€ä½æ°”æ¸©:"</span>);</span><br><span class="line">        sb.append(low);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// setter and getter</span></span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Viewå±‚">Viewå±‚</h3><ul>
<li><p>activity_weather_mvvm.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">  <span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">layout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">LinearLayout</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">        <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">TextView</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">            <span class="attribute">android:textStyle</span>=<span class="value">"bold"</span></span><br><span class="line">            <span class="attribute">android:textSize</span>=<span class="value">"22sp"</span></span><br><span class="line">            <span class="attribute">android:layout_marginLeft</span>=<span class="value">"@dimen/activity_horizontal_margin"</span></span><br><span class="line">            <span class="attribute">android:text</span>=<span class="value">"ä¸Šæµ·æœªæ¥3å¤©çš„å¤©æ°”"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">ListView</span></span><br><span class="line">            <span class="attribute">android:id</span>=<span class="value">"@+id/lv"</span></span><br><span class="line">            <span class="attribute">android:layout_marginTop</span>=<span class="value">"@dimen/activity_horizontal_margin"</span></span><br><span class="line">            <span class="attribute">android:visibility</span>=<span class="value">"gone"</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">LinearLayout</span></span><br><span class="line">            <span class="attribute">android:id</span>=<span class="value">"@+id/ll_loading"</span></span><br><span class="line">            <span class="attribute">android:layout_marginTop</span>=<span class="value">"100dp"</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">            <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="title">ProgressBar</span></span><br><span class="line">                <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></span><br><span class="line">                <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">                <span class="attribute">style</span>=<span class="value">"?android:attr/progressBarStyleLarge"</span></span><br><span class="line">                <span class="attribute">android:layout_gravity</span>=<span class="value">"center_horizontal"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="title">TextView</span></span><br><span class="line">                <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></span><br><span class="line">                <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">                <span class="attribute">android:layout_gravity</span>=<span class="value">"center"</span></span><br><span class="line">                <span class="attribute">android:textSize</span>=<span class="value">"20sp"</span></span><br><span class="line">                <span class="attribute">android:text</span>=<span class="value">"@string/loading"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">layout</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>WeatherActivity</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeatherActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">WeatherViewModel</span>.<span class="title">DataListener</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ActivityWeatherMvvmBinding binding;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        binding = DataBindingUtil.setContentView(<span class="keyword">this</span>, R.layout.activity_weather_mvvm);</span><br><span class="line">        <span class="keyword">new</span> WeatherViewModel(<span class="keyword">this</span>).getWeatherList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onWeatherChanged</span><span class="params">(<span class="keyword">boolean</span> occurError, List&lt;Weather&gt; data)</span> </span>&#123;</span><br><span class="line">        binding.llLoading.setVisibility(View.GONE);</span><br><span class="line">        <span class="keyword">if</span> (occurError) &#123;</span><br><span class="line">            Toast.makeText(WeatherActivity.<span class="keyword">this</span>, <span class="string">"Get data failed!"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            binding.lv.setAdapter(<span class="keyword">new</span> WeatherAdapter(data));</span><br><span class="line">            binding.lv.setVisibility(View.VISIBLE);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>weather_item.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">layout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">data</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">variable</span> <span class="attribute">name</span>=<span class="value">"weather"</span> <span class="attribute">type</span>=<span class="value">"org.freedom.androidpatterndemo.mvvm.model.Weather"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">data</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">TextView</span></span><br><span class="line">        <span class="attribute">android:id</span>=<span class="value">"@+id/tv_weather"</span></span><br><span class="line">        <span class="attribute">android:paddingLeft</span>=<span class="value">"16dp"</span></span><br><span class="line">        <span class="attribute">android:paddingRight</span>=<span class="value">"16dp"</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">        <span class="attribute">android:textSize</span>=<span class="value">"18sp"</span></span><br><span class="line">        <span class="attribute">android:text</span>=<span class="value">"@&#123;weather.getDisplay&#125;"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">layout</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>WeatherAdapter</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeatherAdapter</span> <span class="keyword">extends</span> <span class="title">BaseAdapter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Weather&gt; data;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WeatherAdapter</span><span class="params">(List&lt;Weather&gt; data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data == <span class="keyword">null</span> ? <span class="number">0</span> : data.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Weather <span class="title">getItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data.get(position);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getItemId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">getView</span><span class="params">(<span class="keyword">int</span> position, View convertView, ViewGroup viewGroup)</span> </span>&#123;</span><br><span class="line">        ViewHolder holder;</span><br><span class="line">        <span class="keyword">if</span> (convertView == <span class="keyword">null</span>) &#123;</span><br><span class="line">            holder = <span class="keyword">new</span> ViewHolder((WeatherItemBinding) DataBindingUtil.inflate(LayoutInflater.from(viewGroup.getContext()),</span><br><span class="line">                R.layout.weather_item, viewGroup, <span class="keyword">false</span>));</span><br><span class="line">            convertView = holder.binding.tvWeather;</span><br><span class="line">            convertView.setTag(holder);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            holder = (ViewHolder) convertView.getTag();</span><br><span class="line">        &#125;</span><br><span class="line">        holder.binding.setWeather(getItem(position));</span><br><span class="line">        <span class="keyword">return</span> convertView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ViewHolder</span> </span>&#123;</span><br><span class="line">        WeatherItemBinding binding;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ViewHolder</span><span class="params">(WeatherItemBinding binding)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.binding = binding;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>WeatherViewModer</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * View model for WeatherActivity</span><br><span class="line"> *</span><br><span class="line"> * ä»ç»´åŸºç™¾ç§‘æ–‡ç« ä¸­å¯ä»¥çœ‹åˆ°ï¼š</span><br><span class="line"> *</span><br><span class="line"> * view modelæ˜¯ä¸€ä¸ªæŠ½è±¡çš„viewï¼Œå®ƒå¯¹å¤–æš´éœ²å…¬æœ‰çš„å±æ€§å’Œå‘½ä»¤ã€‚</span><br><span class="line"> *</span><br><span class="line"> * Created by wangsheng on 16/5/12.</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeatherViewModel</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> DataListener dataListener;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WeatherViewModel</span><span class="params">(DataListener dataListener)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dataListener = dataListener;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * é€šè¿‡ç½‘ç»œè¯·æ±‚è·å–å¤©æ°”åˆ—è¡¨æ•°æ®</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getWeatherList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        HttpEngine.get(Constants.API_WEATHER, <span class="keyword">new</span> HttpEngine.JSONRequestCallback() &#123;</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailed</span><span class="params">(Call call, Exception e)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (call.request().url().url().toString().equals(Constants.API_WEATHER)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (dataListener != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        dataListener.onWeatherChanged(<span class="keyword">true</span>, <span class="keyword">null</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(Call call, JSONObject jsonResult)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (call.request().url().url().toString().equals(Constants.API_WEATHER)) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        JSONArray jsonArray = jsonResult.getJSONArray(<span class="string">"results"</span>).getJSONObject(<span class="number">0</span>).getJSONArray(<span class="string">"daily"</span>);</span><br><span class="line">                        Gson gson = <span class="keyword">new</span> GsonBuilder().setFieldNamingPolicy(FieldNamingPolicy.LOWER_CASE_WITH_UNDERSCORES).create();</span><br><span class="line">                        List&lt;Weather&gt; data = gson.fromJson(jsonArray.toString(), <span class="keyword">new</span> TypeToken&lt;List&lt;Weather&gt;&gt;()&#123;&#125;.getType());</span><br><span class="line">                        <span class="keyword">if</span> (dataListener != <span class="keyword">null</span>) &#123;</span><br><span class="line">                            dataListener.onWeatherChanged(<span class="keyword">false</span>, data);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                        <span class="keyword">if</span> (dataListener != <span class="keyword">null</span>) &#123;</span><br><span class="line">                            dataListener.onWeatherChanged(<span class="keyword">true</span>, <span class="keyword">null</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DataListener</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onWeatherChanged</span><span class="params">(<span class="keyword">boolean</span> occurError, List&lt;Weather&gt; data)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ€»ç»“">æ€»ç»“</h3><p>é€šè¿‡ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼ŒViewModerä»£æ›¿äº†åŸæ¥çš„Presenterï¼Œä¸è¿‡ç›¸æ¯”äºMVPï¼ŒMVVMçš„Data Bindingæ¡†æ¶åšäº†æ•°æ®å’ŒViewçš„è‡ªåŠ¨ç»‘å®šåŠŸèƒ½ï¼Œçœå»äº†æ‰‹åŠ¨findViewByIdä»¥åŠæ‹¿åˆ°ç»„ä»¶åsetæ•°æ®çš„ç¹çæ­¥éª¤ã€‚</p>
<h2 id="ä»è®¡ç®—æœºä¸ºä»€ä¹ˆç”¨è¡¥ç å­˜å‚¨æ•°æ®ï¼Œè¡ç”Ÿåˆ°å­˜å‚¨å•å…ƒæ•°æ®æº¢å‡º_-_æä»™é¹">ä»è®¡ç®—æœºä¸ºä»€ä¹ˆç”¨è¡¥ç å­˜å‚¨æ•°æ®ï¼Œè¡ç”Ÿåˆ°å­˜å‚¨å•å…ƒæ•°æ®æº¢å‡º - æä»™é¹</h2><h3 id="å¼•è¨€">å¼•è¨€</h3><blockquote>
<p>å…ˆè¯´å‡ å¥å±è¯ï¼Œè§‰å¾—å•°å—¦å¯ä»¥å¿½ç•¥è·³è¿‡è¿™æ®µå±è¯ã€‚<br>ä¿—è¯è¯´ï¼šçœ¼çœ‹ä»–èµ·é«˜æ¥¼ï¼Œçœ¼çœ‹ä»–å®´å®¾å®¢ï¼Œçœ¼çœ‹ä»–æ¥¼å¡Œäº†ã€‚æˆ‘æƒ³è¿™å¥è¯æ”¾åœ¨æˆ‘ä»¬åšæŠ€æœ¯çš„ï¼Œä¹Ÿå¾ˆåˆé€‚â€”â€”åŸºç¡€ä¸ç‰¢ï¼Œåœ°åŠ¨å±±æ‘‡ã€‚<br>å°½ç®¡æˆ‘ä»¬å¾ˆå¤šäººä¸æ˜¯åšåŸºç¡€å¼€å‘çš„ï¼Œä½†æ˜¯æ“ä½œç³»ç»Ÿã€æ•°æ®ç»“æ„å’Œç®—æ³•ã€è®¡ç®—æœºç½‘ç»œã€è®¾è®¡æ¨¡å¼â€¦â€¦è¿™äº›ITé¢†åŸŸçš„åŸºç¡€æ€§å­¦ç§‘ï¼Œå¯¹äºæˆ‘ä»¬æ¥è¯´å…¶å®æŒºé‡è¦çš„ï¼Œæ¯”å¦‚åšä¼˜åŒ–ã€è·¨è¯­è¨€å­¦ä¹ ã€å·¥ç¨‹æ¡†æ¶æ­å»ºâ€¦â€¦ã€‚åŸºç¡€è™½ç„¶ä¸èƒ½å†³å®šçœ¼å‰ï¼Œä½†æ˜¯èƒ½å¤Ÿå†³å®šæˆ‘ä»¬åœ¨è¿™æ¡è·¯ä¸Šèµ°å¤šè¿œã€‚æ¡†æ¶é‚£ä¹ˆå¤šã€ç‰¹æ•ˆé‚£ä¹ˆå¤šï¼ŒçœŸå¿ƒæ²¡æœ‰å…´è¶£ä¸€ä¸ªä¸ªéƒ½æ‘¸ä¸€éï¼Œæ‰€ä»¥å¶å°”å›è¿‡å¤´å»ç¿»çœ‹è¿™äº›åŸºç¡€æ€§çš„ä¸œè¥¿æ˜¯æŒºæœ‰æ„æ€çš„ã€‚</p>
</blockquote>
<ul>
<li>æ˜¯å¦è¿˜è®°å¾—åœ¨å­¦æ“ä½œç³»ç»Ÿçš„æ—¶å€™ï¼Œå¾ˆå›°æƒ‘è®¡ç®—æœºä¸ºä»€ä¹ˆè¦ç”¨è¡¥ç å­˜å‚¨æ•°æ®ï¼Œè€Œä¸æ˜¯ç”¨æˆ‘ä»¬äººæ›´å®¹æ˜“ç†è§£çš„åŸç æ¥è¿›è¡Œå­˜å‚¨å‘¢ï¼Ÿ</li>
</ul>
<blockquote>
<p>å…³äºè¿™ä¸ªé—®é¢˜ï¼Œç›¸ä¿¡å¾ˆå¤šæ•™è¿™é—¨è¯¾çš„è€å¸ˆä»¥åŠå·¥ä½œå¤šå¹´çš„coderä¹Ÿè§£é‡Šä¸æ¸…ï¼Œç”šè‡³ä¸çŸ¥é“è¿™ä¸ªæ¦‚å¿µã€‚</p>
</blockquote>
<ul>
<li>æœ¬æ–‡å°†å°è¯•ä»ç†æ€§ç»“åˆæ„Ÿæ€§çš„è§’åº¦å»è¯´æ˜<strong><em>è®¡ç®—æœºä¸ºä»€ä¹ˆç”¨è¡¥ç å­˜å‚¨æ•°æ®</em></strong>ï¼Œå½“æˆ‘ä»¬æ˜ç™½è¿™ä¸ªé—®é¢˜åï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å°±å¯ä»¥å»ç†è§£å¦ä¸€ä¸ªè¡ç”Ÿé—®é¢˜â€”â€”<strong><em>æ•°æ®æº¢å‡º</em></strong>ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€æ®µå…³äºæ•°æ®æº¢å‡ºçš„Javaä»£ç ç‰‡ï¼š</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*charä¸ºæ— ç¬¦å·æ•°ï¼Œ16ä½å­˜å‚¨ï¼Œè¡¨ç¤ºèŒƒå›´æ˜¯0ï½2^16-1ï¼ˆå³0ï½65535ï¼‰*/</span></span><br><span class="line"><span class="keyword">char</span> ch = Character.MAX_VALUE; <span class="comment">// chä¸º65535</span></span><br><span class="line">ch += (<span class="keyword">char</span>) <span class="number">1</span>; <span class="comment">// åŠ 1åï¼Œå¼•èµ·æ•°æ®æº¢å‡ºï¼Œåˆ™chä¸º0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*intä½æœ‰ç¬¦å·æ•°ï¼Œ32ä½å­˜å‚¨ï¼Œè¡¨ç¤ºèŒƒå›´æ˜¯ï¼2^31~2^31-1ï¼ˆå³ï¼2147483648ï½2147483647ï¼‰*/</span></span><br><span class="line"><span class="keyword">int</span> i = Integer.MAX_VALUE; <span class="comment">// iä¸º2147483647</span></span><br><span class="line">i += <span class="number">1</span>; <span class="comment">// åŠ 1åï¼Œå¼•èµ·æ•°æ®æº¢å‡ºï¼Œåˆ™iä¸ºï¼2147483648</span></span><br></pre></td></tr></table></figure>
<ul>
<li>è‡³äºä¸Šè¿°ä»£ç ç‰‡çš„æ‰§è¡Œç»“æœä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Œæš‚æ—¶ä¸è§£é‡Šï¼Œå¸Œæœ›é€šè¿‡æ–‡ç« å¾ªåºæ¸è¿›çš„è¿‡ç¨‹æ¥è¯´æ˜æº¢å‡ºçš„é—®é¢˜ã€‚</li>
</ul>
<h3 id="fuckæ¦‚å¿µ">fuckæ¦‚å¿µ</h3><ul>
<li>è®¡ç®—æœºç”¨äºŒè¿›åˆ¶æ¥è¡¨ç¤ºæ•°æ®ï¼Œè¿™ä¸ªå¤§å®¶åº”è¯¥éƒ½äº†è§£ï¼ˆä¸äº†è§£çš„æ‰¾å—æ¿ç –æ‹æ­»è‡ªå·±ç®—äº†ï¼‰ã€‚</li>
</ul>
<blockquote>
<ul>
<li>æ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼Œæœ¬æ–‡éƒ½ä»¥4ä½å­˜å‚¨å•å…ƒæ¥è¯´æ˜</li>
<li>ä¸‹é¢å‡ ä¸ªå°èŠ‚ä¼šæåˆ°ä¸€äº›å…³é”®æ¦‚å¿µï¼Œä¸è¦å¯¹è¿™äº›æ¦‚å¿µææ…Œï¼Œè¿™äº›æ¦‚å¿µä¼šç»“åˆä¾‹å­æˆ–è€…å¯¹æ¯”çš„å½¢å¼ï¼Œå°½é‡ä»¥é€šä¿—ç®€æ´çš„æ–‡å­—æ¥è¯´æ˜ï¼Œä¿è¯äººäººéƒ½èƒ½çœ‹çš„æ‡‚</li>
</ul>
</blockquote>
<h4 id="åŠ æ³•å™¨">åŠ æ³•å™¨</h4><ul>
<li>è®¡ç®—æœºåªæœ‰åŠ æ³•å™¨æ²¡æœ‰å‡æ³•å™¨ï¼Œä¸¤ä¸ªæ•°çš„å‡æ³•è¿ç®—ä¼šè¢«è®¡ç®—æœºè½¬æ¢ä¸ºåŠ æ³•è¿ç®—ã€‚ï¼ˆå…ˆåŸ‹ä¸ªä¼ç¬”â€”â€”é€šè¿‡è¡¥ç è¿›è¡Œè¡¨ç¤ºï¼Œå³å¯å°†å‡æ³•è¿ç®—è½¬æ¢ä¸ºåŠ æ³•è¿ç®—ï¼‰</li>
</ul>
<h4 id="æ¨¡ã€è¡¥æ•°">æ¨¡ã€è¡¥æ•°</h4><ul>
<li><p>åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œæœ‰è®¸å¤šåŒ–å‡ä¸ºåŠ ç‚¹ä¾‹å­ã€‚æˆ‘ä»¬ä»¥æœ€å¹³å¸¸çš„é’Ÿè¡¨ä¸ºä¾‹ï¼Œæ—¶é’ˆé€†æ—¶é’ˆæ‹¨xï¼ˆ0&lt;x&lt;12ï¼‰æ ¼å’Œæ—¶é’ˆé¡ºæ—¶é’ˆæ‹¨12-xæ ¼ï¼Œæ•ˆæœæ˜¯ç›¸åŒçš„ã€‚æ¯”å¦‚ï¼Œæ—¶é’ˆä»10ç‚¹è°ƒæ•´åˆ°5ç‚¹æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼š</p>
<ol>
<li>æ—¶é’ˆé€†æ—¶é’ˆæ‹¨5æ ¼ï¼Œç›¸å½“äºåšå‡æ³•ï¼š10 -5 = 5</li>
<li>æ—¶é’ˆé¡ºæ—¶é’ˆæ‹¨7ï¼ˆå³12 - 5ï¼‰æ ¼ï¼Œç›¸å½“äºåšåŠ æ³•ï¼š10 + 7 = 12 +5 = 5ï¼ˆMODï¼12ï¼‰</li>
</ol>
</li>
<li><p>æ€»ç»“ï¼Œx + (MOD - x) = MODå°±æ˜¯æ¨¡ï¼Œxå’ŒMOD - xå°±æ˜¯ä¸€å¯¹â€œäº’è¡¥â€çš„æ•°ï¼Œå³åŸæ•°xçš„è¡¥æ•°ä¸ºMOD - xæˆ–è€…åŸæ•°MOD - xçš„è¡¥æ•°ä¸ºxã€‚é€šè¿‡å¯¹é’Ÿè¡¨æ‹¨æ—¶é’ˆçš„ä¾‹å­å¯ä»¥å‘ç°ï¼Œç”¨è¡¥æ•°ï¼ˆ7ï¼‰ä»£æ›¿åŸæ•°ï¼ˆ5ï¼‰ï¼Œå¯æŠŠå‡æ³•è½¬å˜ä¸ºåŠ æ³•ï¼ˆå‡ºç°çš„è¿›ä½å°±æ˜¯æ¨¡ï¼Œè¿›ä½èˆå¼ƒï¼‰ã€‚</p>
</li>
</ul>
<blockquote>
<p>äºŒè¿›åˆ¶æ•°çš„æ¨¡ï¼Œå…ˆæ¥çœ‹ä¸‹ä¸¤ä¸ªä¸ªä¾‹å­ï¼ˆæ­¤å¤„æˆ‘ä»¬å¿½ç•¥ç¬¦å·ï¼‰ï¼š</p>
<ol>
<li>2ä½å­˜å‚¨æ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°æ˜¯11ï¼ˆ10è¿›åˆ¶ï¼š3 = 2^2 - 1ï¼‰ï¼Œæ¯”ä»–å¤§1çš„æ˜¯11 + 1 = 100ï¼ˆ10è¿›åˆ¶ï¼š4 = 2^2ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ª100åˆ™æ˜¯2ä½å­˜å‚¨æ‰€èƒ½è¡¨ç¤ºçš„æ‰€æœ‰æ•°æ®çš„æ¨¡ã€‚</li>
<li>4ä½å­˜å‚¨æ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°æ˜¯1111ï¼ˆ10è¿›åˆ¶ï¼š15 = 2^4 - 1ï¼‰ï¼Œæ¯”ä»–å¤§1çš„æ•°æ˜¯1111 + 1 = 10000ï¼ˆ10è¿›åˆ¶ï¼š16 = 2^4ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ª10000åˆ™æ˜¯4ä½å­˜å‚¨æ‰€èƒ½è¡¨ç¤ºçš„æ‰€æœ‰æ•°æ®çš„æ¨¡ã€‚</li>
</ol>
<p>é€šè¿‡å¯¹ä¸Šé¢ä¸¤ä¸ªä¾‹å­å¯ä»¥æ¨è®ºï¼š<strong><em>ä¸€ä¸ªäºŒè¿›åˆ¶æ•°çš„æœ€é«˜ä½ä½æ•°ç”¨nè¡¨ç¤ºï¼Œé‚£ä¹ˆè¯¥äºŒè¿›åˆ¶æ•°çš„æ¨¡å°±æ˜¯2^n</em></strong>ã€‚</p>
</blockquote>
<h4 id="åŸç ã€åç ã€è¡¥ç ">åŸç ã€åç ã€è¡¥ç </h4><ul>
<li>å…ˆæ¥çœ‹ä¸€å¼ å›½å†…å¤–æ•™æå¯¹æ¯”çš„è¡¨ï¼ˆå‡ºè‡ªã€Šè®¡ç®—æœºæ•™è‚²ã€‹2015å¹´ç¬¬10æœŸçš„æ–‡ç« â€”â€”ã€ŠåŸç ã€åç å’Œè¡¥ç çš„æ•™å­¦è®¨è®ºã€‹ï¼‰</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1510997-e2ea5fb9d6fc3f5a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å›½å†…å¤–æ•™æå¯¹æ¯”.png"></p>
<ul>
<li><p>ç»™å®šä¸€ä¸ªæœ‰ç¬¦å·æ•°xï¼Œæ¥å¯¹æ¯”ä¸‹å›½å¤–å’Œå›½å†…æ•™æå¯¹åŸç ã€åç ã€è¡¥ç çš„è¡¨ç¤ºï¼š</p>
<ul>
<li>å›½å¤–æ•™æ<ul>
<li>sign and magnitude representationï¼ˆåŸç ï¼‰ï¼šæœ€é«˜ä½ä½ç¬¦å·ä½ï¼ˆ0è¡¨ç¤ºæ­£æ•°ï¼Œ1è¡¨ç¤ºè´Ÿæ•°ï¼‰ï¼Œå‰©ä½™ä½ï¼ˆæ•°æ®ä½ï¼‰ä¸ºxçš„å¤§å°ã€‚</li>
<li>onesâ€™ complement representationï¼ˆåç ï¼‰ï¼šå¦‚æœxä¸ºæ­£æ•°ï¼Œåˆ™æ˜¯å…¶äºŒè¿›åˆ¶è¡¨ç¤ºï¼›å¦‚æœxä¸ºè´Ÿæ•°ï¼Œåˆ™æ˜¯å…¶å¯¹åº”æ­£æ•°çš„bit complement/bitwise NOTï¼ˆæŒ‰ä½å–åï¼‰â€”â€”æ‰§è¡Œæ¯ä¸€ä½é€»è¾‘å¦å®šçš„ä¸€å…ƒæ“ä½œã€‚å¯ç”¨å…¬å¼è¡¨ç¤ºä¸ºï¼š<ul>
<li><strong><em>[x]å = (2^n - 1) - |X|ï¼ˆå…¶ä¸­nä¸ºå°†ç¬¦å·ä½ç®—åœ¨å†…çš„ä½æ•°ï¼Œ|X|ä¸ºç»å¯¹å€¼ï¼‰</em></strong></li>
</ul>
</li>
<li>twoâ€™s complement representationï¼ˆè¡¥ç ï¼‰ï¼šå¦‚æœxä¸ºæ­£æ•°ï¼Œåˆ™æ˜¯å…¶äºŒè¿›åˆ¶è¡¨ç¤ºï¼›å¦‚æœxä¸ºè´Ÿæ•°ï¼Œåˆ™æ˜¯å…¶å¯¹åº”æ­£æ•°çš„äºŒçš„è¡¥ï¼ˆæ‰€æœ‰ä½å–åååŠ 1ï¼‰ã€‚å¯ç”¨å…¬å¼è¡¨ç¤ºä¸ºï¼š<ul>
<li><strong><em>[x]è¡¥ = (2^n) - |X| ï¼ [x]å + 1ï¼ˆå…¶ä¸­nä¸ºå°†ç¬¦å·ä½ç®—åœ¨å†…çš„ä½æ•°ï¼Œ|X|ä¸ºç»å¯¹å€¼ï¼‰</em></strong></li>
</ul>
</li>
</ul>
</li>
<li>å›½å†…æ•™æ<ul>
<li>åŸç ï¼šæœ€é«˜ä½ä¸ºç¬¦å·ä½ï¼Œå‰©ä½™ä½ï¼ˆæ•°æ®ä½ï¼‰ä¸ºxçš„ç»å¯¹å€¼ã€‚</li>
<li>åç ï¼šå¦‚æœxä¸ºæ­£æ•°ï¼Œåˆ™ä¸åŸç ç›¸åŒï¼›å¦‚æœxä¸ºè´Ÿæ•°ï¼Œç¬¦å·ä½ä¿æŒä¸å˜ï¼Œæ•°æ®ä½å–åã€‚</li>
<li>è¡¥ç ï¼šå¦‚æœxä¸ºæ­£æ•°ï¼Œåˆ™ä¸åŸç ç›¸åŒï¼›å¦‚æœxä¸ºè´Ÿæ•°ï¼Œç¬¦å·ä½ä¿æŒä¸å˜ï¼Œæ•°æ®ä½å–åï¼Œç„¶ååŠ 1ï¼ˆè‹¥ç¬¦å·ä½æœ‰è¿›ä½ï¼Œåˆ™èˆå¼ƒè¿›ä½ï¼‰ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><p>å¯¹æ¯”å›½å†…å¤–æ•™æçš„è¡¨è¿°ï¼Œæ˜¯å¦å‘ç°é«˜ä¸‹ç«‹ç°ï¼š</p>
<ul>
<li>å›½å†…æ•™æç”»è›‡æ·»è¶³ï¼Œå¹¶ä¸”å®¹æ˜“å¼•èµ·è¯¯è§£ï¼š<ol>
<li><strong><em><del>åŸç æ˜¯åç å’Œè¡¥ç çš„åŸºç¡€ï¼Œåç å’Œè¡¥ç ç”±åŸç è½¬åŒ–è€Œæ¥</del></em></strong></li>
<li><strong><em><del>åŸç ã€åç å’Œè¡¥ç çš„ç¬¦å·ä½ç›¸åŒ</del></em></strong></li>
</ol>
</li>
<li>å›½å¤–æ•™æï¼Œåˆ™éå¸¸é€šä¿—ï¼š<ol>
<li><strong><em>æ±‚è§£ä¸€ä¸ªæ•°çš„åç å’Œè¡¥ç ï¼Œæ ¹æœ¬ä¸éœ€è¦çŸ¥é“åŸç ï¼Œç›´æ¥é€šè¿‡å®ƒä»¬çš„ä¸¤ä¸ªå¯¹åº”å…¬å¼å³å¯ï¼Œç”šè‡³å¯ä»¥è¯´åŸç ä¸åç å’Œè¡¥ç æ²¡æœ‰åŠæ¯›é’±å…³ç³»ï¼Œåå€’æ˜¯åç å’Œè¡¥ç å­˜åœ¨å…³ç³»â€”â€”è¡¥ç  = åç  + 1</em></strong></li>
<li><strong><em>åŸç çš„å‡ºå‘ç‚¹æ˜¯ç¬¦å·çš„è¡¨ç¤ºï¼ˆç¬¦å·ä½ï¼‰ï¼Œå³ç”¨0è¡¨ç¤ºæ­£æ•°ï¼Œç”¨1è¡¨ç¤ºè´Ÿæ•°ï¼›åç å’Œè¡¥ç çš„å‡ºå‘ç‚¹æ˜¯å‡æ³•çš„è¿ç®—ï¼Œå³ç”¨ä¸¤ä¸ªæ­£æ•°çš„åŠ æ³•å–ä»£ä¸¤ä¸ªæ•°çš„å‡æ³•</em></strong></li>
</ol>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>ç‹—æ—¥çš„å›½å†…æ•™æå’Œç¿»è¯‘ï¼ŒçœŸæ˜¯è¯¯äººå­å¼Ÿå•Š</p>
</blockquote>
<h3 id="è®¡ç®—æœºä¸ºä»€ä¹ˆç”¨è¡¥ç å­˜å‚¨æ•°æ®">è®¡ç®—æœºä¸ºä»€ä¹ˆç”¨è¡¥ç å­˜å‚¨æ•°æ®</h3><ul>
<li>ä¸Šé¢é“ºå«äº†è¿™é—¨ä¹…ï¼Œç»ˆäºè¦è¿›å…¥ç¬¬ä¸€ä¸ªæ­£é¢˜â€”â€”è®¡ç®—æœºä¸ºä»€ä¹ˆç”¨è¡¥ç å­˜å‚¨æ•°æ®ã€‚ä¸ºäº†ä¸å¼•èµ·æ··æ·†ï¼Œæˆ‘ä»¬å°±ä»¥å›½å¤–æ•™æå¯¹äºåŸç ã€åç å’Œè¡¥ç çš„è¡¨ç¤ºæ³•æ¥è¿›è¡Œè¯´æ˜ã€‚ç®€å•èµ·è§ï¼Œä»¥4ä½å­˜å‚¨è¡¨ç¤ºæœ‰ç¬¦å·æ•°ä¸ºä¾‹ï¼Œé€šè¿‡åŸç ã€åç å’Œè¡¥ç çš„è¡¨ç¤ºæ³•æ¥ç”Ÿæˆä¸€å¼ è¡¨ï¼š</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">æœ‰ç¬¦å·æ•°ï¼ˆåè¿›åˆ¶ï¼‰</th>
<th style="text-align:center">sign and magnitude representationï¼ˆåŸç ï¼‰</th>
<th style="text-align:center">onesâ€™ complement representationï¼ˆåç ï¼‰ï¼Œ[x]å = (2^n - 1) - \X\</th>
<th style="text-align:center">twoâ€™s complement representationï¼ˆè¡¥ç ï¼‰ï¼Œ[x]è¡¥ = (2^n) - \X\</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">+7</td>
<td style="text-align:center">0111</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
</tr>
<tr>
<td style="text-align:center">+6</td>
<td style="text-align:center">0110</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
</tr>
<tr>
<td style="text-align:center">+5</td>
<td style="text-align:center">0101</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
</tr>
<tr>
<td style="text-align:center">+4</td>
<td style="text-align:center">0100</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
</tr>
<tr>
<td style="text-align:center">+3</td>
<td style="text-align:center">0011</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
</tr>
<tr>
<td style="text-align:center">+2</td>
<td style="text-align:center">0010</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
</tr>
<tr>
<td style="text-align:center">+1</td>
<td style="text-align:center">0001</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
</tr>
<tr>
<td style="text-align:center">+0</td>
<td style="text-align:center">0000</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
<td style="text-align:center">è¡¨ç¤ºæ–¹å¼ä¸å˜</td>
</tr>
<tr>
<td style="text-align:center">-0</td>
<td style="text-align:center">1000</td>
<td style="text-align:center">1111</td>
<td style="text-align:center">0000ï¼ˆæ±‚è§£è¿‡ç¨‹ï¼š[x]è¡¥ = 2^n - \x\ = 2^4 - \-0\ = 2^4 - (+0)ï¼Œä½¿ç”¨äºŒè¿›åˆ¶åˆ™ä¸º10000 - 0000 = 10000ï¼Œè¶…è¿‡4ä½ï¼ˆæœ‰è¿›ä½ï¼‰ï¼Œé‚£ä¹ˆèˆå¼ƒè¿›ä½1ï¼Œæœ€ç»ˆç»“æœå°±æ˜¯0000ï¼‰</td>
</tr>
<tr>
<td style="text-align:center">-1</td>
<td style="text-align:center">1001</td>
<td style="text-align:center">1110</td>
<td style="text-align:center">1111</td>
</tr>
<tr>
<td style="text-align:center">-2</td>
<td style="text-align:center">1010</td>
<td style="text-align:center">1101</td>
<td style="text-align:center">1110</td>
</tr>
<tr>
<td style="text-align:center">-3</td>
<td style="text-align:center">1011</td>
<td style="text-align:center">1100</td>
<td style="text-align:center">1101</td>
</tr>
<tr>
<td style="text-align:center">-4</td>
<td style="text-align:center">1100</td>
<td style="text-align:center">1011</td>
<td style="text-align:center">1100</td>
</tr>
<tr>
<td style="text-align:center">-5</td>
<td style="text-align:center">1101</td>
<td style="text-align:center">1010</td>
<td style="text-align:center">1011</td>
</tr>
<tr>
<td style="text-align:center">-6</td>
<td style="text-align:center">1110</td>
<td style="text-align:center">1001</td>
<td style="text-align:center">1010</td>
</tr>
<tr>
<td style="text-align:center">-7</td>
<td style="text-align:center">1111</td>
<td style="text-align:center">1000</td>
<td style="text-align:center">1001</td>
</tr>
<tr>
<td style="text-align:center">-8</td>
<td style="text-align:center">è¶…å‡º4ä¸ªbitæ‰€èƒ½è¡¨è¾¾èŒƒå›´</td>
<td style="text-align:center">è¶…å‡º4ä¸ªbitæ‰€èƒ½è¡¨è¾¾èŒƒå›´</td>
<td style="text-align:center">1000</td>
</tr>
<tr>
<td style="text-align:center">å¤‡æ³¨</td>
<td style="text-align:center">é›¶é‡ç ï¼ŒäºŒè¿›åˆ¶å­˜åœ¨ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼š0000å’Œ1000</td>
<td style="text-align:center">é›¶é‡ç ï¼ŒäºŒè¿›åˆ¶å­˜åœ¨ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼š0000å’Œ1111</td>
<td style="text-align:center">é›¶æ— é‡ç ï¼ŒåŒæ—¶è§£å†³äº†åŸç å’Œåç ä¸èƒ½è¡¨ç¤º-8çš„é—®é¢˜</td>
</tr>
</tbody>
</table>
<ul>
<li><p>é€šè¿‡ä¸Šè¿°è¡¨æ ¼ï¼Œå¯ä»¥å¾ˆè‡ªç„¶çš„æ€»ç»“å‡ºä¸€ä¸ªç»“è®ºï¼š<strong><em>è¡¥ç è¡¨ç¤ºæ³•ï¼ˆtwoâ€™s complement representationï¼‰å¯ä»¥é˜²æ­¢0çš„æœºå™¨æ•°é‡ç ï¼ŒåŒæ—¶åˆè§£å†³äº†åŸç å’Œåç æ— æ³•è¡¨ç¤ºï¼8çš„é—®é¢˜</em></strong>ï¼Œè¿™æ ·å°±æå¤§çš„ç®€åŒ–äº†è®¡ç®—æœºçš„ç¡¬ä»¶è®¾è®¡ã€‚</p>
</li>
<li><p>ç»“åˆä¹‹å‰æåˆ°çš„æ—¶é’Ÿä¾‹å­ï¼Œæˆ‘ä»¬æŠŠè¡¥ç è¡¨ç¤ºæ³•ï¼ˆtwoâ€™s complement representationï¼‰æ‰€è¡¨ç¤ºçš„å››ä½å­˜å‚¨å•å…ƒï¼ŒæŒ‰ç…§ä»0000åˆ°1111é€’å¢çš„æ–¹å¼ï¼Œå‡åŒ€çš„åˆ†å¸ƒåœ¨æ—¶é’Ÿçš„è¡¨ç›˜ä¸Šã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸‹é¢è¿™å¼ å›¾ï¼ˆå›¾ç‰‡æ¥è‡ªäº<a href="http://users.dickinson.edu/~braught/courses/cs251f02/classes/notes07.html" target="_blank" rel="external">è¿™é‡Œ</a>ï¼‰ï¼š</p>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1510997-54e3b1cb3e8e626b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="two&#39;s complement wheel"></p>
<ul>
<li><p>OKï¼Œç»§ç»­ä»¥æ—¶é’Ÿçš„æ–¹å¼æ¥è§‚å¯Ÿä¸Šå›¾ï¼š</p>
<ul>
<li><strong><em>é¡ºæ—¶é’ˆæ–¹å‘ä½åŠ æ³•ï¼Œé€†æ—¶é’ˆæ–¹å‘ä¸ºå‡æ³•</em></strong></li>
<li><strong><em>æ¨¡ä¸º2^n</em></strong>ï¼šåœ¨1111å¤„é¡ºæ—¶é’ˆæ‹¨ä¸€æ ¼ï¼Œå°±åˆ°äº†0000ã€‚ç”¨æ•°å­¦çš„æ–¹å¼ï¼Œå³1111 + 1 = 10000ï¼Œè¿›ä½èˆå¼ƒåˆ™ç»“æœä¸º0000ï¼Œé‚£ä¹ˆå››ä½å­˜å‚¨çš„æ¨¡å°±æ˜¯10000ï¼ˆ2^4ï¼‰</li>
<li><strong><em>å‡æ³•è½¬æ¢ä¸ºåŠ æ³•</em></strong>ï¼š3 - 1 = 3 + ï¼ˆ-1ï¼‰ = 0011 + 1111 = 0010ï¼Œçœ¼å°–çš„äººå¯èƒ½ä¼šè¯´0011 + 1111æ˜æ˜ç­‰äº10010ï¼Œæ€ä¹ˆä¼šæ˜¯0010ï¼Ÿè¿˜è®°å¾—ä¹‹å‰æè¿‡çš„æœ€é«˜ä½è¿›ä½èˆå¼ƒå˜›ï¼Œå› æ­¤å¯¹äº4ä½å­˜å‚¨æ¥è¯´ï¼Œè¿›ä½èˆå¼ƒåå°±æ˜¯0010 = 2ã€‚<blockquote>
<p>è‹¥å‡æ³•ä¸è½¬æ¢ä¸ºåŠ æ³•ï¼Œé‚£ä¹ˆ3 -1 = 0011 - 0001 = 0010 = 2</p>
</blockquote>
</li>
<li><strong><em>æ•°æ®æº¢å‡º</em></strong>ï¼šå½“0111ï¼ˆ7ï¼‰åŠ 1æ—¶ï¼ŒæŒ‰ç…§æˆ‘ä»¬äººçš„æ€ç»´æ¥è¯´ï¼Œåº”è¯¥ç»“æœä¸º8ï¼Œä½†æ˜¯å¯¹äºæœºå™¨æ¥è¯´åˆ™ä¸æ˜¯ï¼Œ0111ï¼ˆ7ï¼‰æ˜¯å››ä½å­˜å‚¨æ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°ï¼Œå®ƒæ˜¯æ— æ³•è¡¨ç¤º01111ï¼ˆ8ï¼‰çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±è¯´æ•°æ®æº¢å‡ºäº†ã€‚é‚£ä¹ˆæ•°æ®æº¢å‡ºè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå¾ˆç®€å•ï¼Œæœºå™¨çš„æ€è€ƒæ–¹å¼æ˜¾ç„¶å’Œæˆ‘ä»¬äººè„‘ä¸ä¸€æ ·ï¼Œæœºå™¨æŒ‰ç…§ä¸Šé¢ç¯å½¢å›¾çš„æ–¹å¼ï¼Œç”±äº0111ï¼ˆ7ï¼‰åŠ 1æ˜¯é¡ºæ—¶é’ˆé€ æˆçš„æ•°æ®æº¢å‡ºï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠæœºå™¨çš„æ“ä½œæƒ³è±¡æˆåœ¨0111ï¼ˆ7ï¼‰å¤„é¡ºæ—¶é’ˆæ‹¨äº†ä¸€æ ¼ï¼Œæˆ‘ä»¬å†å»å¯¹ç…§ä¸‹ç¯å½¢å›¾å‘ç°è¿™æ—¶å€™æŒ‡å‘äº†1000ï¼ˆï¼8ï¼‰ã€‚<blockquote>
<p>æŠŠè¿™ä¸ªè¿‡ç¨‹æƒ³è±¡æˆæ‹¨æ—¶é’ˆå°±OKäº†ï¼Œå¯¹äº1000ï¼ˆï¼8ï¼‰å‡1ä¹Ÿæ˜¯åŒæ ·é“ç†</p>
</blockquote>
</li>
</ul>
</li>
<li><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥æ€»ç»“ä¸€ä¸‹ï¼Œå¹¶è§£ç­”è®¡ç®—æœºä¸ºä»€ä¹ˆç”¨è¡¥ç å­˜å‚¨æ•°æ®ï¼š</p>
<ol>
<li><strong><em>è®¡ç®—æœºåªæœ‰åŠ æ³•å™¨æ²¡æœ‰å‡æ³•å™¨ï¼Œä¸¤ä¸ªæ•°çš„å‡æ³•è¿ç®—ä¼šè¢«è®¡ç®—æœºè½¬æ¢ä¸ºåŠ æ³•è¿ç®—ï¼Œè€Œè¡¥ç æ­£å¥½èƒ½å¤Ÿè§£å†³å‡æ³•è½¬æ¢ä¸ºåŠ æ³•çš„é—®é¢˜</em></strong></li>
<li><strong><em>é˜²æ­¢æœºå™¨å‘ç”Ÿé›¶é‡ç ï¼ŒåŒæ—¶è§£å†³äº†åŸç å’Œåç ä¸èƒ½è¡¨ç¤º-8çš„é—®é¢˜ï¼Œè¿™æ ·æå¤§çš„ç®€åŒ–äº†è®¡ç®—æœºçš„ç¡¬ä»¶è®¾è®¡</em></strong></li>
<li><strong><em>ä»¥å¾ªç¯çš„æ–¹å¼è§£å†³æ•°æ®æº¢å‡ºçš„é—®é¢˜</em></strong></li>
</ol>
</li>
</ul>
<h3 id="ä»è¡¥ç çš„è§’åº¦è§£ç­”ä»£ç ç‰‡ä¸­çš„æ•°æ®æº¢å‡º">ä»è¡¥ç çš„è§’åº¦è§£ç­”ä»£ç ç‰‡ä¸­çš„æ•°æ®æº¢å‡º</h3><ul>
<li><p>æ—¢ç„¶å·²ç»çŸ¥é“äº†è®¡ç®—æœºä¸ºä»€ä¹ˆç”¨è¡¥ç å­˜å‚¨æ•°æ®ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥å›è¿‡å¤´å»æ¶ˆç­æ–‡ç« å¼€å¤´çš„æ•°æ®æº¢å‡ºçš„ä»£ç ç‰‡äº†ã€‚ç”±äºä»£ç ç‰‡ä¸­chå’Œiçš„é—®é¢˜æ˜¯ä¸€æ ·çš„ï¼Œé‚£æˆ‘ä»¬å°±é€‰æ‹©chæ¥è¿›è¡Œåˆ†æï¼Œå¦ä¸€ä¸ªç•™ç»™ä½ ä»¬åˆ†æã€‚</p>
</li>
<li><p>åœ¨Javaä¸­ï¼Œcharä¸ºæ— ç¬¦å·æ•°ï¼Œ16ä½å­˜å‚¨ï¼Œè¡¨ç¤ºèŒƒå›´æ˜¯0ï½2^16-1ï¼ˆå³0ï½65535ï¼‰ã€‚</p>
<ol>
<li>é¦–å…ˆï¼Œæˆ‘ä»¬æŒ‰ç…§0000 0000 0000 0000åˆ°1111 1111 1111 1111é€’å¢çš„æ–¹å¼ï¼Œå‡åŒ€çš„åˆ†å¸ƒåœ¨æ—¶é’Ÿçš„è¡¨ç›˜ä¸Šï¼Œå›¾å°±ä¸ç”»äº†ï¼Œè‡ªå·±åœ¨è„‘ä¸­æƒ³è±¡ä¸€ä¸‹æˆ–è€…ç”»ä¸ªè‰ç¨¿ã€‚</li>
<li>ç„¶åï¼Œæ‰¾å‡ºæ•°æ®æº¢å‡ºç‚¹ï¼Œé€šè¿‡è§‚å¯Ÿcharç¯å½¢å›¾å¯ä»¥å‘ç°æ•°æ®æº¢å‡ºç‚¹æ˜¯0ï¼ˆ0000 0000 0000 0000ï¼‰å’Œ65535ï¼ˆ1111 1111 1111 1111ï¼‰</li>
<li>æœ€åï¼Œæˆ‘ä»¬çš„ch = 65535 + 1ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶å‘ç”Ÿäº†æ•°æ®æº¢å‡ºï¼ŒæŒ‰ç…§æ‹¨æ—¶é’ˆçš„æ–¹å¼å°±å¯ä»¥å¾—å‡ºch = 0</li>
</ol>
</li>
<li><p>Perfectï¼Œæ˜¯å¦è§£ç­”äº†å½“åˆå­¦æ“ä½œç³»ç»Ÿå’Œç¼–ç¨‹çš„æ—¶å€™ï¼Œå›°æ‰°ä½ ä»¬å¾ˆä¹…çš„é—®é¢˜ã€‚é€ç»™å¤§å®¶ä¸€å¥è¯ï¼šæœ‰äº›æ¦‚å¿µå¯èƒ½å½“æ—¶ä¸ç†è§£ï¼Œä½†æ˜¯éšç€ç»éªŒå¤šç´¯ç§¯å’Œå›é¡¾çš„å¤šäº†ï¼Œè‡ªç„¶è€Œç„¶å°±ç†è§£äº†ã€‚</p>
</li>
</ul>
<blockquote>
<p>è´´å‡ºæˆ‘çœ‹çš„å…³äºè¡¥ç çš„æ–‡ç« é“¾æ¥ï¼Œæœ‰å‡ ç¯‡ä¸­æ–‡æ–‡ç« å¯¹äºæŸäº›çŸ¥è¯†ç‚¹å¯èƒ½è¯´é”™äº†ï¼Œåˆ‡è®°è¦å¸¦ç€æ‰¹åˆ¤çš„è§‚ç‚¹å»çœ‹ï¼š</p>
</blockquote>
<ul>
<li>ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ç¬¬äºŒç« </li>
<li>ã€Šè®¡ç®—æœºæ•™è‚²ã€‹2015å¹´ç¬¬10æœŸçš„æ–‡ç« â€”â€”ã€ŠåŸç ã€åç å’Œè¡¥ç çš„æ•™å­¦è®¨è®ºã€‹</li>
<li><a href="http://wenku.baidu.com/link?url=wayiLiKLswqXsZycoidDK2CHH_SRwW9cnWTr9Nmds_Gw1HkkX3aygtchh7mEZWYg2MnHoMUEim5bGCp839NPlhqoqTGX20CCNjAErJY0CKG" target="_blank" rel="external">è¡¥ç åŸç†çš„ä¸ªäººç†è§£</a></li>
<li><a href="http://www.360doc.com/content/12/1009/21/10086564_240513741.shtml" target="_blank" rel="external">ä¸ºä»€ä¹ˆè®¡ç®—æœºç”¨è¡¥ç å­˜å‚¨æ•°æ®ï¼Ÿ</a></li>
<li><a href="https://www.douban.com/note/223507364/" target="_blank" rel="external">åŸç ã€åç å’Œè¡¥ç </a></li>
<li><a href="http://baike.baidu.com/link?url=ZcIzYnFGWCC7a4gbpAVow0F981p3hPW4esDXi6uA5Uee0ovhblfp8gOvDzN-HQiJgdgGAhRuVMay9ZpdB8OS2q#reference-[1]-377340-wrap" target="_blank" rel="external">è¡¥ç </a></li>
<li><a href="http://users.dickinson.edu/~braught/courses/cs251f02/classes/notes07.html" target="_blank" rel="external">Class #7 - Signed Binary Numbers, Subtraction and Overflow</a>ã€€ã€€</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«/">ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬54æœŸ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/06/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬54æœŸ/" class="article-date">
  	<time datetime="2016-05-06T10:30:00.000Z" itemprop="datePublished">2016-05-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/06/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬54æœŸ/">ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬54æœŸ</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="è‡ªåŠ¨åŒ–_ssh_æˆæƒç¬”è®°_-_æ›¾é“­">è‡ªåŠ¨åŒ– ssh æˆæƒç¬”è®° - æ›¾é“­</h2><p>æ¯æ¬¡ <code>ssh user@host</code> ç™»å½•ç›®æ ‡æœºå™¨éƒ½è¦è¾“å¯†ç æ˜¯ä»¶å¾ˆçƒ¦çš„äº‹ï¼Œç‰¹åˆ«æ˜¯ç»å¸¸è®¿é—®å¤šå°ä¸»æœºçš„æƒ…å†µã€‚ æœ€è¿‘å†™è‡ªåŠ¨åŒ–è„šæœ¬æ—¶ç¢°åˆ°è¦è‡ªåŠ¨åšæœºå™¨é—´ ssh éªŒè¯ï¼Œç¢°åˆ°ä¸€äº›é—®é¢˜è®°å½•ä¸‹æ¥å¤‡å¿˜ã€‚</p>
<h3 id="åˆ†æ">åˆ†æ</h3><ul>
<li>é€šè¿‡ <code>ssh-keygen -t rsa -b 4096 -C &quot;your_email@example.com&quot;</code> å‘½ä»¤ç”Ÿæˆæœ¬åœ°æœºå™¨çš„ç§é’¥å’Œå…¬é’¥: <code>~/.ssh/id_rsa</code> and <code>~/.ssh/id_rsa.pub</code></li>
<li>æˆæƒå°±æ˜¯å°†å°†æœ¬åœ°æœºå™¨çš„å…¬é’¥åŠ å…¥åˆ°ç›®æ ‡æœºå™¨çš„ <code>~/.ssh/authorized_keys</code> ä¸­ä¾›éªŒè¯ç”¨</li>
<li>æœ¬åœ° <code>~/.ssh/known_hosts</code> ä¸­ä¿¡ä»»ç›®æ ‡æœºå™¨çš„å…¬é’¥æŒ‡çº¹</li>
</ul>
<h3 id="è‡ªåŠ¨åš_ssh-key_æˆæƒ">è‡ªåŠ¨åš ssh-key æˆæƒ</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># copy local ssh-key to remote å¯¹åº”åˆ†æä¸­çš„ç¬¬äºŒæ­¥</span></span><br><span class="line">cat ~<span class="regexp">/.ssh/id</span>_rsa.pub | ssh root<span class="variable">@192</span>.<span class="number">168.37</span>.<span class="number">110</span> <span class="string">"cat &gt;&gt; ~/.ssh/authorized_keys"</span></span><br><span class="line"><span class="comment"># add host to known_hosts å¯¹åº”åˆ†æä¸­çš„ç¬¬ä¸‰æ­¥</span></span><br><span class="line">ssh-keyscan -t rsa <span class="string">"192.168.37.110"</span> <span class="prompt">&gt;&gt; </span>~<span class="regexp">/.ssh/known</span>_hosts</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…è¿™ä¸¤æ¡å‘½ä»¤å¯ä»¥ç²¾ç®€ä¸ºå¦‚ä¸‹ä¸€æ¡</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew install ssh-<span class="keyword">copy</span>-<span class="property">id</span> <span class="comment"># just for mac</span></span><br><span class="line">ssh-<span class="keyword">copy</span>-<span class="property">id</span> -i ~/.ssh/id_rsa.pub root@<span class="number">192.168</span>.37.110</span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰å‰©ä¸‹çš„ä¸€ä¸ªéš¾é¢˜æ˜¯è¿˜éœ€è¦æ‰‹åŠ¨è¾“å…¥å¯†ç ï¼Œè¿™ä¸ªæ€ä¹ˆè‡ªåŠ¨åŒ–å‘¢ï¼Ÿ</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># just for mac</span></span><br><span class="line">brew install <span class="symbol">https:</span>/<span class="regexp">/raw.githubusercontent.com/kadwanev</span><span class="regexp">/bigboybrew/master</span><span class="regexp">/Library/</span><span class="constant">Formula/</span>sshpass.rb </span><br><span class="line">sshpass -p <span class="string">"PASSWORD"</span> ssh-copy-id -i ~<span class="regexp">/.ssh/id</span>_rsa.pub -o <span class="constant">StrictHostKeyChecking=</span>no root<span class="variable">@192</span>.<span class="number">168.37</span>.<span class="number">110</span></span><br></pre></td></tr></table></figure>
<p>æˆ–è€…ä½¿ç”¨ Fabric ç­‰è¿œç¨‹æ‰§è¡Œ run(â€œcmdâ€)</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># tips æ‰§è¡Œ sudo ä¸éœ€è¦æ‰‹åŠ¨è¾“å…¥å¯†ç </span></span><br><span class="line">echo <span class="string">"PASSWORD"</span> <span class="string">| sudo -S CMD</span></span><br></pre></td></tr></table></figure>
<p>ç”¨ iterm2 åš terminal ç®¡ç†<br>ç•¥</p>
<p>å‚è€ƒ:</p>
<ul>
<li><a href="http://www.ruanyifeng.com/blog/2011/12/ssh_remote_login.html" target="_blank" rel="external">SSHåŸç†ä¸è¿ç”¨ï¼ˆä¸€ï¼‰ï¼šè¿œç¨‹ç™»å½• - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a></li>
<li><a href="http://www.ibm.com/developerworks/cn/aix/library/au-sshsecurity/" target="_blank" rel="external">SSH å®‰å…¨æ€§å’Œé…ç½®å…¥é—¨</a></li>
</ul>
<h2 id="æšä¸¾çš„ç‰¹æ®Šç”¨æ³•_-_æ¨å¿—å¹³">æšä¸¾çš„ç‰¹æ®Šç”¨æ³• - æ¨å¿—å¹³</h2><blockquote>
<p>æºäºé¡¹ç›®ä¸­çš„åº”ç”¨å¤ªå¹¿äº†ï¼Œä½†æ˜¯å¯¹swiftçš„å¾ˆå¤šç®€å•ç‰¹æ€§ä¸ç†Ÿã€‚ä¹‹å‰é‚£ä¸ªåŠ¨ç”»çš„<code>é˜¶æ®µ</code>ä½¿ç”¨åˆ°enumæœ‰é‡åˆ°å›°éš¾æš‚æ—¶ç»•å¼€å®ƒäº†</p>
</blockquote>
<p><code>å½“æ—¶çš„ç›®æ ‡å°±æ˜¯å¤–éƒ¨ç›´æ¥èµ‹å€¼æ“ä½œ</code></p>
<h3 id="å¦‚ä¸‹åŠ¨ç”»çš„enumç¤ºä¾‹ï¼š">å¦‚ä¸‹åŠ¨ç”»çš„enumç¤ºä¾‹ï¼š</h3><blockquote>
<p>ä¸ºäº†çœäº‹ï¼Œç›®å‰ç›´æ¥ä½¿ç”¨æ­»çš„æ–‡æ¡ˆæ”¾åœ¨è¿™é‡Œ</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">AnimationPeriod</span>: <span class="title">UInt</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åŠ¨ç”»æ‰§è¡Œçš„äº”ä¸ªé˜¶æ®µ</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">Start</span>,<span class="type">First</span>,<span class="type">Second</span>,<span class="type">Third</span>,<span class="type">End</span></span><br><span class="line">    </span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">description</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Start</span>, .<span class="type">First</span>:    <span class="keyword">return</span> <span class="string">"æ­£åœ¨æå–å­¦æ ¡æœ€æ–°\nå½•å–æ¡ä»¶"</span></span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Second</span>:           <span class="keyword">return</span> <span class="string">"æ­£åœ¨ä¸å­¦æ ¡è¿›è¡ŒåŒ¹é…"</span></span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Third</span>, .<span class="type">End</span>:      <span class="keyword">return</span> <span class="string">"æ­£åœ¨æ ¹æ®åŒ¹é…ç»“æœ\nç”Ÿæˆé€‰æ ¡æ–¹æ¡ˆ"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">duration</span><span class="params">()</span></span> -&gt; <span class="type">NSTimeInterval</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Start</span>:    <span class="keyword">return</span> <span class="number">0.8</span></span><br><span class="line">        <span class="keyword">case</span> .<span class="type">First</span>:    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Second</span>:   <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Third</span>:    <span class="keyword">return</span> <span class="number">0.5</span></span><br><span class="line">        <span class="keyword">case</span> .<span class="type">End</span>:      <span class="keyword">return</span> <span class="number">0.25</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AnimationPeriod</span> </span>&#123;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="func"><span class="keyword">func</span> <span class="title">next</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Start</span>:    <span class="keyword">self</span> = .<span class="type">First</span></span><br><span class="line">        <span class="keyword">case</span> .<span class="type">First</span>:    <span class="keyword">self</span> = .<span class="type">Second</span></span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Second</span>:   <span class="keyword">self</span> = .<span class="type">Third</span></span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Third</span>:    <span class="keyword">self</span> = .<span class="type">End</span></span><br><span class="line">        <span class="keyword">default</span>:        <span class="keyword">self</span> = .<span class="type">End</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹ä¸€äº›æšä¸¾çš„ä½¿ç”¨">ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹ä¸€äº›æšä¸¾çš„ä½¿ç”¨</h3><p>æºå¸¦<code>å‚æ•°</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">FamilyType</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">case</span> <span class="type">Father</span>(age: <span class="type">Int</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Mother</span>(age: <span class="type">Int</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Sister</span>(age: <span class="type">Int</span>)</span><br><span class="line"></span><br><span class="line">    <span class="func"><span class="keyword">func</span> <span class="title">gift</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span>(<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Sister</span>(<span class="keyword">let</span> age):</span><br><span class="line">            <span class="keyword">if</span> age &gt; <span class="number">15</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"iphone"</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"toy"</span></span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">case</span> .<span class="type">Mother</span>(<span class="keyword">let</span> age) <span class="keyword">where</span> age &lt; <span class="number">40</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"cloth"</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"book"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> someone = <span class="type">FamilyType</span>.<span class="type">Sister</span>(age: <span class="number">11</span>)</span><br><span class="line"><span class="keyword">let</span> somebody = <span class="type">FamilyType</span>.<span class="type">Mother</span>(age: <span class="number">40</span>)</span><br><span class="line"><span class="comment">// swiftçš„æšä¸¾æŠ€å·§</span></span><br><span class="line"><span class="keyword">let</span> someoneGift = someone.gift()     <span class="comment">// print toy</span></span><br><span class="line"><span class="keyword">let</span> somebodyGift = somebody.gift()	 <span class="comment">// book</span></span><br></pre></td></tr></table></figure>
<h4 id="é‚£æˆ‘ä»¬è¦å–å€¼çš„æœ‰">é‚£æˆ‘ä»¬è¦å–å€¼çš„æœ‰</h4><ul>
<li>æ–¹æ³•ä¸€</li>
</ul>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> someone &#123;</span><br><span class="line"><span class="keyword">case</span> .Father(<span class="keyword">let</span> age):</span><br><span class="line">    age</span><br><span class="line"><span class="keyword">case</span> .Sister(<span class="keyword">let</span> age):</span><br><span class="line">    age</span><br><span class="line"><span class="annotation">default</span>:()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ–¹æ³•äºŒ</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">case</span> .Sister(<span class="built_in">let</span> age) = someone &#123;</span><br><span class="line">    age</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æšä¸¾çš„åµŒå¥—">æšä¸¾çš„åµŒå¥—</h3><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Colleague &#123;</span><br><span class="line">    <span class="keyword">enum</span> Weight: Int &#123;</span><br><span class="line">        <span class="keyword">case</span> Light</span><br><span class="line">        <span class="keyword">case</span> Mid</span><br><span class="line">        <span class="keyword">case</span> Heavy</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> iOS(weight: Weight)</span><br><span class="line">    <span class="keyword">case</span> Android(weight: Weight)</span><br><span class="line">    <span class="keyword">case</span> HTML(weight: Weight)</span><br><span class="line">&#125;</span><br><span class="line">let woodenHelmet = Colleague.iOS(weight: .Mid)</span><br></pre></td></tr></table></figure>
<h3 id="æšä¸¾çš„æˆå‘˜å˜é‡">æšä¸¾çš„æˆå‘˜å˜é‡</h3><p>ä¹‹å‰å°±ä¸€ç›´æƒ³è¦ä½¿ç”¨æšä¸¾åšåˆ°å¤–éƒ¨åŠ¨æ€å¯¹æšä¸¾èµ‹å€¼å‚¨å­˜æ“ä½œï¼Œ<br>é‚£æˆå‘˜å˜é‡ç”¨æ³•å¦‚ä¸‹</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ®è‡ªèº«èµ‹å€¼</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Device</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> iPad, iPhone</span><br><span class="line">    <span class="keyword">var</span> year: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> iPhone: <span class="keyword">return</span> <span class="number">2007</span></span><br><span class="line">        <span class="keyword">case</span> iPad: <span class="keyword">return</span> <span class="number">2010</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// set get æ–¹æ³•å¯¹äºæšä¸¾çš„æˆå‘˜å˜é‡æ˜¯æ— æ•ˆçš„ï¼Œå…è®¸getè°ƒç”¨ä½†setä¸å¯æ‰§è¡Œ</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Story</span>, <span class="type">News</span></span><br><span class="line">    <span class="keyword">var</span> year: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">set</span>&#123;</span><br><span class="line">            year = newValue</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">get</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">self</span>.year</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> myIpad = <span class="type">Device</span>.iPad</span><br><span class="line">myIpad.year</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> storyBook = <span class="type">Book</span>.<span class="type">Story</span></span><br><span class="line"><span class="comment">//storyBook.year = 2010	 // set æ–¹æ³•æ­¤å¤„æŠ¥é”™</span></span><br><span class="line"><span class="comment">//storyBook.year			 // get æ— æ•ˆ</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆå§‹åŒ–ï¼Œæ„Ÿè§‰ç„¶å¹¶è½¯">åˆå§‹åŒ–ï¼Œæ„Ÿè§‰ç„¶å¹¶è½¯</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">AppleDevice</span> &#123;</span></span><br><span class="line">    <span class="keyword">case</span> iMac(<span class="string">price:</span>Int)</span><br><span class="line">    <span class="keyword">case</span> iPod(<span class="string">price:</span>Int)</span><br><span class="line">    <span class="keyword">case</span> iPhone(<span class="string">price:</span>Int)</span><br><span class="line">    init (<span class="string">costMoney:</span> Int) &#123;</span><br><span class="line">        <span class="keyword">if</span> costMoney &gt; <span class="number">10000</span> &#123;</span><br><span class="line">            self = .iMac(<span class="string">price:</span> costMoney)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> costMoney &gt; <span class="number">2500</span> &#123;</span><br><span class="line">            self = .iPhone(<span class="string">price:</span> costMoney)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            self = .iPod(<span class="string">price:</span> costMoney)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let myDevice = AppleDevice(<span class="string">costMoney:</span> <span class="number">6000</span>)</span><br></pre></td></tr></table></figure>
<h3 id="å…ƒç»„çš„ä½¿ç”¨">å…ƒç»„çš„ä½¿ç”¨</h3><p>å¤šä¸ªå‚æ•°çš„ä»‹å…¥æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å…ƒç»„,æ­¤å¤„å¸¸è§„ä½¿ç”¨æŠ¥é”™æš‚æ—¶æ— æ³•è§£å†³ï¼Œ<br>ä½¿ç”¨funcå‡½æ•°èµ‹å€¼å€’æ˜¯æ²¡æœ‰å‡ºé”™ã€‚whyï¼Ÿï¼Ÿ</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">HumanHabit</span> &#123;</span></span><br><span class="line">    <span class="keyword">case</span> Reading</span><br><span class="line">    <span class="keyword">case</span> PlayGame</span><br><span class="line">    <span class="keyword">case</span> Traveling</span><br><span class="line">&#125;</span><br><span class="line">typealias HumanInfo = (<span class="string">age:</span> Int, <span class="string">name:</span> String, <span class="string">habit:</span> HumanHabit)</span><br><span class="line"></span><br><span class="line">func selectRAM(<span class="string">humanInfo:</span> HumanInfo) -&gt; HumanInfo &#123;<span class="keyword">return</span> (<span class="string">age:</span> <span class="number">32</span>, <span class="string">name:</span> humanInfo.name, <span class="string">habit:</span> humanInfo.habit)&#125;</span><br><span class="line">func selectCPU(<span class="string">humanInfo:</span> HumanInfo) -&gt; HumanInfo &#123;<span class="keyword">return</span> (<span class="string">age:</span> humanInfo.age, <span class="string">name:</span> <span class="string">"3.2GHZ"</span>, <span class="string">habit:</span> humanInfo.habit)&#125;</span><br><span class="line">func selectGPU(<span class="string">humanInfo:</span> HumanInfo) -&gt; HumanInfo &#123;<span class="keyword">return</span> (<span class="string">age:</span> humanInfo.age, <span class="string">name:</span> <span class="string">"3.2GHZ"</span>, <span class="string">habit:</span> .Reading)&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Desktop</span> &#123;</span></span><br><span class="line">    <span class="keyword">case</span> Cube(HumanInfo)</span><br><span class="line">    <span class="keyword">case</span> Tower(HumanInfo)</span><br><span class="line">    <span class="keyword">case</span> Rack(HumanInfo)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let aTower = Desktop.Tower(selectGPU(selectCPU(selectRAM((<span class="number">0</span>, <span class="string">""</span>, .Traveling) <span class="keyword">as</span> HumanInfo))))</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«/">ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬53æœŸ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/29/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬53æœŸ/" class="article-date">
  	<time datetime="2016-04-29T10:30:00.000Z" itemprop="datePublished">2016-04-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/29/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬53æœŸ/">ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬53æœŸ</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="JSPatchåˆæ¢_-_åˆ˜åº·">JSPatchåˆæ¢ - åˆ˜åº·</h2><h4 id="ä»€ä¹ˆæ˜¯JSPatch">ä»€ä¹ˆæ˜¯JSPatch</h4><p>JSPatchæ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæœ€åˆæ˜¯è…¾è®¯@bangçš„ä¸ªäººé¡¹ç›®ï¼Œè¯ç”Ÿäº2015å¹´5æœˆã€‚å®ƒèƒ½å¤Ÿä½¿ç”¨JavaScriptè°ƒç”¨Objective-Cçš„åŸç”Ÿæ¥å£ï¼Œä»è€ŒåŠ¨æ€æ¤å…¥ä»£ç æ¥æ›¿æ¢æ—§ä»£ç ï¼Œä»¥å®ç°ä¿®å¤çº¿ä¸Šbugã€‚</p>
<h4 id="JSPatchå¹³å°">JSPatchå¹³å°</h4><p>JSPatch éœ€è¦ä½¿ç”¨è€…æœ‰ä¸€ä¸ªåå°å¯ä»¥ä¸‹å‘å’Œç®¡ç†è„šæœ¬ï¼Œå¹¶ä¸”éœ€è¦å¤„ç†ä¼ è¾“å®‰å…¨ç­‰éƒ¨ç½²å·¥ä½œã€‚å¦‚æœè‡ªå·±æ­å»ºåå°ä¸‹å‘ JSPatch è„šæœ¬ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ github ä¸Šçš„ä»£ç ã€‚JSPatch å¹³å°æä¾›äº†è„šæœ¬åå°æ‰˜ç®¡ï¼Œç‰ˆæœ¬ç®¡ç†ï¼Œä¿è¯ä¼ è¾“å®‰å…¨ç­‰åŠŸèƒ½ï¼Œæ— éœ€æ­å»ºä¸€ä¸ªåå°ï¼Œæ— éœ€å…³å¿ƒéƒ¨ç½²æ“ä½œï¼Œåªéœ€å¼•å…¥ä¸€ä¸ª SDK å³å¯ç«‹å³ä½¿ç”¨ JSPatchã€‚</p>
<h4 id="JSPatchå®ç°åŸç†">JSPatchå®ç°åŸç†</h4><h5 id="åŸºæœ¬åŸç†">åŸºæœ¬åŸç†</h5><p>Objective-Cæ˜¯åŠ¨æ€è¯­è¨€ï¼Œå…·æœ‰è¿è¡Œæ—¶ç‰¹æ€§ï¼Œè¯¥ç‰¹æ€§å¯é€šè¿‡ç±»åç§°å’Œæ–¹æ³•åçš„å­—ç¬¦ä¸²è·å–è¯¥ç±»å’Œè¯¥æ–¹æ³•ï¼Œå¹¶å®ä¾‹åŒ–å’Œè°ƒç”¨ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Class <span class="class"><span class="keyword">class</span> = <span class="title">NSClassFromString</span></span>(@<span class="string">"DataManager"</span>);</span><br><span class="line">id dataManager = [[<span class="class"><span class="keyword">class</span> <span class="title">alloc</span>] <span class="title">init</span>];</span></span><br><span class="line">SEL selector = NSSelectorFromString(@<span class="string">"saveData"</span>);</span><br><span class="line">[dataManager performSelector:selector];</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥æ›¿æ¢æŸä¸ªç±»çš„æ–¹æ³•ä¸ºæ–°çš„å®ç°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">mySaveData</span><span class="params">(id slf, SEL sel)</span> </span>&#123; &#125;</span><br><span class="line">class_replaceMethod(<span class="keyword">class</span>, selector, mySaveData, <span class="string">""</span>);</span><br></pre></td></tr></table></figure>
<p>æ–°æ³¨å†Œä¸€ä¸ªç±»ï¼Œä¸ºç±»æ·»åŠ æ–¹æ³•ï¼š</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class cls = objc_allocateClassPair<span class="list">([NSObject class], <span class="string">"MyObject"</span>, <span class="number">0</span>)</span><span class="comment">;</span></span><br><span class="line">objc_registerClassPair<span class="list">(<span class="keyword">cls</span>)</span><span class="comment">;</span></span><br><span class="line">class_addMethod<span class="list">(<span class="keyword">cls</span>, selector, implement, typedesc)</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<h5 id="Javascriptè°ƒç”¨">Javascriptè°ƒç”¨</h5><p>å¯ä»¥ç”¨Javascriptå¯¹è±¡å®šä¹‰ä¸€ä¸ªObjective-Cç±»ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attribute">__isCls</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attribute">__clsName</span>: <span class="string">"UIView"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨OCæ‰§è¡ŒJSè„šæœ¬å‰ï¼Œé€šè¿‡æ­£åˆ™æŠŠæ‰€æœ‰æ–¹æ³•è°ƒç”¨éƒ½æ”¹æˆè°ƒç”¨ __c() å‡½æ•°ï¼Œå†æ‰§è¡Œè¿™ä¸ªJSè„šæœ¬ï¼Œåšåˆ°äº†æ¶ˆæ¯è½¬å‘æœºåˆ¶ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UIView.<span class="function"><span class="title">alloc</span><span class="params">()</span></span>.<span class="function"><span class="title">init</span><span class="params">()</span></span></span><br><span class="line">-&gt;</span><br><span class="line">UIView.__c(<span class="string">'alloc'</span>)().__c(<span class="string">'init'</span>)()</span><br></pre></td></tr></table></figure>
<h5 id="äº’ä¼ æ¶ˆæ¯">äº’ä¼ æ¶ˆæ¯</h5><ul>
<li><code>JavaScriptCore</code>: é€šè¿‡æ­¤frameworkå®ç°æ¶ˆæ¯äº’ä¼ </li>
<li><code>JSContext</code>: JSä»£ç çš„æ‰§è¡Œç¯å¢ƒã€‚JSé€šè¿‡è°ƒç”¨ JSContext å®šä¹‰çš„æ–¹æ³•æŠŠæ•°æ®ä¼ ç»™OCï¼ŒOCé€šè¿‡è¿”å›å€¼ä¼ ä¼šç»™JSã€‚</li>
</ul>
<h4 id="é›†æˆæ­¥éª¤">é›†æˆæ­¥éª¤</h4><p>é€šè¿‡JSPatchå¹³å°ã€‚</p>
<ul>
<li>åˆ›å»ºAppï¼Œè·å¾—AppKey</li>
<li>ä¸‹è½½SDKå¹¶å¯¼å…¥åˆ°é¡¹ç›®</li>
<li>è®¾ç½®App Transport Security Settings</li>
<li>æ·»åŠ ä¾èµ–æ¡†æ¶ï¼š<code>libz.dylib</code>å’Œ<code>JavaScriptCore.framework</code></li>
<li>æ·»åŠ ä»£ç ï¼š</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr_selector">[JSPatch startWithAppKey:@"c08857f72a4e5f7b"]</span>;</span><br><span class="line"><span class="attr_selector">[JSPatch sync]</span>; <span class="comment">//æ£€æŸ¥æ›´æ–°</span></span><br></pre></td></tr></table></figure>
<h4 id="å¦‚ä½•ä½¿ç”¨">å¦‚ä½•ä½¿ç”¨</h4><p>åœ¨ JSPatch å¹³å°çš„è§„èŒƒé‡Œï¼ŒJSè„šæœ¬çš„æ–‡ä»¶åå¿…é¡»æ˜¯ <code>main.js</code>ã€‚<br>ç›´æ¥åœ¨main.jsä¸­æ·»åŠ JavaScriptä»£ç ï¼<br>è¯¦ç»†ä½¿ç”¨è¯·è§<code>Github Wiki</code></p>
<h4 id="æµ‹è¯•">æµ‹è¯•</h4><ul>
<li>åœ¨é¡¹ç›®ä¸­æ·»åŠ <code>main.js</code>æ–‡ä»¶</li>
<li>æ·»åŠ ä»£ç </li>
<li><code>didFinishLaunchingWithOptions</code>æ·»åŠ ä¸€è¡Œï¼š</li>
</ul>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">[JSPatch testScriptInBundle]</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Run!</li>
</ul>
<h4 id="åœ¨å¹³å°ä¸­æ·»åŠ JSè„šæœ¬">åœ¨å¹³å°ä¸­æ·»åŠ JSè„šæœ¬</h4><ol>
<li>åœ¨åˆ›å»ºçš„åº”ç”¨ä¸­æ·»åŠ ç‰ˆæœ¬</li>
<li>åœ¨æ·»åŠ çš„ç‰ˆæœ¬ä¸­ä¸Šä¼ <code>main.js</code><br>ä¸Šä¼ åï¼Œå¯¹åº”ç‰ˆæœ¬çš„Appä¼šè¯·æ±‚ä¸‹è½½æ­¤ è„šæœ¬å¹¶ä¿å­˜åœ¨æœ¬åœ°ï¼Œä»¥åAppæ¯æ¬¡å¯åŠ¨éƒ½ä¼šæ‰§è¡Œã€‚<br>äº²æµ‹ç¬¬ä¸€æ¬¡å¹¶ä¸ä¼šæ‰§è¡Œï¼ï¼ï¼</li>
</ol>
<h4 id="éƒ¨ç½²å®‰å…¨ç­–ç•¥">éƒ¨ç½²å®‰å…¨ç­–ç•¥</h4><p>ä½¿ç”¨ JSPatch æœ‰ä¸¤ä¸ªå®‰å…¨é—®é¢˜ï¼š</p>
<ul>
<li>ä¼ è¾“å®‰å…¨ï¼šJS è„šæœ¬å¯ä»¥è°ƒç”¨ä»»æ„ OC æ–¹æ³•ï¼Œæƒé™éå¸¸å¤§ï¼Œè‹¥è¢«ä¸­é—´äººæ”»å‡»æ›¿æ¢ä»£ç ï¼Œä¼šé€ æˆè¾ƒå¤§çš„å±å®³ã€‚</li>
<li>æ‰§è¡Œå®‰å…¨ï¼šä¸‹å‘çš„ JS è„šæœ¬çµæ´»åº¦å¤§ï¼Œç›¸å½“äºä¸€æ¬¡å°å‹æ›´æ–°ï¼Œè‹¥æœªè¿›è¡Œå……åˆ†æµ‹è¯•ï¼Œå¯èƒ½ä¼šå‡ºç° crash ç­‰æƒ…å†µå¯¹ APP ç¨³å®šæ€§é€ æˆå½±å“ã€‚</li>
</ul>
<p>é’ˆå¯¹ä¼ è¾“å®‰å…¨é—®é¢˜ï¼Œä½œè€…çš„å»ºè®®æ˜¯å¯¹ä¸‹å‘çš„JSä»£ç è¿›è¡ŒRSAæ ¡éªŒï¼Œè€Œæ‰§è¡Œå®‰å…¨ï¼Œé™¤äº†åœ¨å‘å¸ƒJSè„šæœ¬ä¹‹å‰åšå¥½å‘¨å…¨æµ‹è¯•ä¹‹å¤–ï¼Œè¿˜éœ€è¦å»ºç«‹å›é€€æœºåˆ¶ï¼Œå®ç°æ–¹å¼æ˜¯åå°ä¸‹å‘å‘½ä»¤ï¼Œè®© APP åœ¨ä¸‹æ¬¡å¯åŠ¨æ—¶ä¸æ‰§è¡Œ JSPatch è„šæœ¬å³å¯ã€‚ä½†è¿™é‡Œèƒ½å›é€€çš„å‰ææ˜¯ APP å¯ä»¥æ¥æ”¶åˆ°åå°ä¸‹å‘çš„å›é€€å‘½ä»¤ï¼Œè‹¥å› ä¸ºä¸‹å‘çš„è„šæœ¬å¯¼è‡´ APP å¯åŠ¨å³æ—¶ crashï¼Œè¿™ä¸ªå›é€€å‘½ä»¤ä¹Ÿä¼šæ¥æ”¶ä¸åˆ°ã€‚æ‰€ä»¥å»ºè®®å†åŠ ä¸€å±‚é˜²å¯åŠ¨ crash çš„æœºåˆ¶ï¼ŒAPP åœ¨è¿ç»­å¯åŠ¨å³ crash åï¼Œä¸‹æ¬¡å¯åŠ¨ä¸å†æ‰§è¡Œè„šæœ¬æ–‡ä»¶ã€‚</p>
<h4 id="Swifté¡¹ç›®ä¸­ä½¿ç”¨JSPatch">Swifté¡¹ç›®ä¸­ä½¿ç”¨JSPatch</h4><p>ä½¿ç”¨ <code>defineClass()</code> è¦†ç›– Swift ç±»æ—¶ï¼Œç±»ååº”ä¸º <code>é¡¹ç›®å.åŸç±»å</code>:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">defineClass</span><span class="params">(<span class="string">'demo.ViewController'</span>, &#123;&#125;)</span></span></span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ol>
<li>åªæ”¯æŒè°ƒç”¨ç»§æ‰¿è‡ª NSObject çš„ Swift ç±»ï¼›</li>
<li>ç»§æ‰¿è‡ª NSObject çš„ Swift ç±»ï¼Œå…¶ç»§æ‰¿è‡ªçˆ¶ç±»çš„æ–¹æ³•å’Œå±æ€§å¯ä»¥åœ¨ JS è°ƒç”¨ï¼Œå…¶ä»–è‡ªå®šä¹‰æ–¹æ³•å’Œå±æ€§åŒæ ·éœ€è¦åŠ  dynamic å…³é”®å­—æ‰è¡Œï¼›</li>
<li>è‹¥æ–¹æ³•çš„å‚æ•°/å±æ€§ç±»å‹ä¸º Swift ç‰¹æœ‰çš„(å¦‚ Character / Tuple)ï¼Œåˆ™æ­¤æ–¹æ³•å’Œå±æ€§æ— æ³•é€šè¿‡ JS è°ƒç”¨ã€‚</li>
</ol>
<h4 id="ä¸ä¼šJavaScript?">ä¸ä¼šJavaScript?</h4><p><a href="http://bang590.github.io/JSPatchConvertor/" target="_blank" rel="external">JSPatch Convertor</a></p>
<hr>
<p>å‚è€ƒï¼š</p>
<p><a href="http://jspatch.com" target="_blank" rel="external">JSPatchå¹³å°</a></p>
<p><a href="https://github.com/bang590/JSPatch/wiki" target="_blank" rel="external">Github Wiki</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«/">ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬52æœŸ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/22/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬52æœŸ/" class="article-date">
  	<time datetime="2016-04-22T10:30:00.000Z" itemprop="datePublished">2016-04-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/22/ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬52æœŸ/">ç§»åŠ¨å‘¨åˆ†äº«-ç¬¬52æœŸ</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Swift_çš„_Playground_å­¦ä¹ ">Swift çš„ Playground å­¦ä¹ </h2><blockquote>
<p>æˆ‘ä»¬ä¸€å¼€å§‹çŸ¥é“ <strong><em>Playground</em></strong>ï¼Œä¹ŸçŸ¥é“ç„¶åæŸ¥çœ‹ä¸€äº›å˜é‡åŠå˜é‡çš„å†å²è®°å½•ã€‚å¶å°”è¿˜çŸ¥é“å¯ä»¥åšè§†å›¾ç”šè‡³åŠ¨ç”»å±•ç¤ºä½†æ˜¯ï¼Œç°åœ¨ï¼Œä½ ç‰¹ä¹ˆçœ‹åˆ°çš„æ˜¯ <strong><em>MarkDown</em></strong> è¯­æ³•ï¼Œæœ‰æ²¡æœ‰ã€‚</p>
</blockquote>
<h3 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h3><ul>
<li><a href="http://nshipster.cn/xcplayground/" target="_blank" rel="external">XCPlaygroundä»‹ç»&amp;å®è·µ</a></li>
<li><a href="https://developer.apple.com/library/mac/documentation/Miscellaneous/Reference/XCPlaygroundModuleRef/XCPlayground.html" target="_blank" rel="external">XCPlaygroundè‹¹æœå®˜ç½‘æ–‡æ¡£</a></li>
</ul>
<h3 id="ä½¿ç”¨ä¼˜åŠ¿">ä½¿ç”¨ä¼˜åŠ¿</h3><ul>
<li>å¿«é€Ÿå­¦ä¹ swift</li>
<li>å¿«é€Ÿæµ‹è¯•ä»£ç æ•ˆæœ</li>
<li>éªŒè¯API</li>
<li>å¯Œæ–‡æœ¬æ³¨é‡Š</li>
</ul>
<p><code>å¦‚ä¸‹æ‰€æœ‰æ¡ˆä¾‹ä½¿ç”¨Xcode7ä¸‹åŠ è½½playgroundæ–‡ä»¶ï¼Œå¯é¢„è§ˆæ•ˆæœ</code><br><a href="https://github.com/51offer/51offer.github.com/tree/blog/share_files/xcodeyang52.playground" target="_blank" rel="external">æ–‡ä»¶ä¸‹è½½é“¾æ¥</a></p>
<h3 id="å˜é‡">å˜é‡</h3><blockquote>
<p>è‡³ä¸Šè€Œä¸‹æ‰§è¡Œï¼Œæ˜¾ç¤ºå˜é‡çš„å½“å‰å€¼åŠå†å²è®°å½•çš„å˜åŒ–ã€‚</p>
</blockquote>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable"><span class="keyword">var</span> name</span> = <span class="string">"æ¨å¿—"</span></span><br><span class="line">name += <span class="string">"å¹³"</span></span><br><span class="line"><span class="comment">// playgroundä¸‹é¢„è§ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="variable"><span class="keyword">var</span> graph</span> = <span class="number">0.0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0.</span>..<span class="number">100</span> &#123;</span><br><span class="line">    graph = sin(<span class="typename">Double</span>(i)/<span class="number">10.0</span>)</span><br><span class="line">    <span class="comment">// playgroundä¸‹é¢„è§ˆ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="UIè§†å›¾">UIè§†å›¾</h3><blockquote>
<p>ç®€å•æ˜¾ç¤ºUIçš„åŸºç¡€å…ƒç´ </p>
</blockquote>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">let redView = <span class="function"><span class="title">UIView</span><span class="params">(frame:CGRectMake(<span class="number">0</span>,<span class="number">0</span>,<span class="number">100</span>,<span class="number">100</span>)</span></span>)</span><br><span class="line">redView<span class="class">.backgroundColor</span> = UIColor.<span class="function"><span class="title">redColor</span><span class="params">()</span></span></span><br><span class="line">redView<span class="class">.layer</span><span class="class">.cornerRadius</span> = <span class="number">20</span></span><br><span class="line">redView<span class="class">.layer</span><span class="class">.borderWidth</span> = <span class="number">3</span></span><br><span class="line">redView<span class="class">.layer</span><span class="class">.borderColor</span> = UIColor.<span class="function"><span class="title">whiteColor</span><span class="params">()</span></span><span class="class">.CGColor</span></span><br><span class="line"></span><br><span class="line">let circle = <span class="function"><span class="title">UIView</span><span class="params">(frame:CGRectMake(<span class="number">25</span>,<span class="number">25</span>,<span class="number">50</span>,<span class="number">50</span>)</span></span>)</span><br><span class="line">circle<span class="class">.backgroundColor</span> = UIColor.<span class="function"><span class="title">yellowColor</span><span class="params">()</span></span></span><br><span class="line">circle<span class="class">.layer</span><span class="class">.cornerRadius</span> = <span class="number">80</span></span><br><span class="line">redView.<span class="function"><span class="title">addSubview</span><span class="params">(circle)</span></span></span><br><span class="line"><span class="comment">// playgroundä¸‹é¢„è§ˆ</span></span><br></pre></td></tr></table></figure>
<h3 id="é‡å¤´æˆ">é‡å¤´æˆ</h3><h4 id="åŠ¨ç”»å±•ç¤º_&amp;_ç½‘ç»œè¯·æ±‚">åŠ¨ç”»å±•ç¤º &amp; ç½‘ç»œè¯·æ±‚</h4><blockquote>
<p>è¿™é‡Œéœ€è¦å¯¹ XCPlayground æœ‰ä¸€ç‚¹äº†è§£ï¼Œå¥½åƒè¿˜å¯¹SpriteKitåšäº†æ”¯æŒ<a href="http://letvar.com/blog/2014/06/swift-and-playgrounds-learn-to-program-in-a-fun-way-2/" target="_blank" rel="external">æ–‡ç« è¿æ¥</a></p>
</blockquote>
<figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸ªåº“éœ€è¦import</span></span><br><span class="line"><span class="built_in">import</span> XCPlayground</span><br><span class="line"></span><br><span class="line"><span class="built_in">let</span> containerView = UIView<span class="params">(frame: CGRect<span class="params">(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">320</span>, height: <span class="number">480</span>)</span>)</span></span><br><span class="line">containerView.backgroundColor = UIColor.yellowColor<span class="params">()</span></span><br><span class="line">XCPlaygroundPage.currentPage.liveView = containerView</span><br><span class="line"></span><br><span class="line"><span class="built_in">let</span> view = UIView<span class="params">(frame: CGRect<span class="params">(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">100</span>, height: <span class="number">100</span>)</span>)</span></span><br><span class="line">view.center = CGPoint<span class="params">(x: containerView.center.x, y: containerView.center.y-<span class="number">100</span>)</span></span><br><span class="line">view.backgroundColor = UIColor.redColor<span class="params">()</span></span><br><span class="line">containerView.addSubview<span class="params">(view)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// playgroundä¸‹é¢„è§ˆ</span></span><br><span class="line">UIView.animateWithDuration<span class="params">(<span class="number">3</span>, delay: <span class="number">0</span>, usingSpringWithDamping: <span class="number">0.1</span>, initialSpringVelocity: <span class="number">6</span>, options: UIViewAnimationOptions.CurveEaseInOut, animations: &#123;</span><br><span class="line">        view.center.y += <span class="number">100</span></span><br><span class="line">    &#125;, completion:&#123; <span class="params">(animation: Bool)</span> in</span><br><span class="line">        view.center.y -= <span class="number">100</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼‚æ­¥æ“ä½œï¼šç½‘ç»œåœ¨å®¶å›¾ç‰‡</span></span><br><span class="line"><span class="comment">// æ—§æ¥å£ï¼šXCPSetExecutionShouldContinueIndefinitely(true)</span></span><br><span class="line">XCPlaygroundPage.currentPage.needsIndefiniteExecution = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">let</span> url = NSURL<span class="params">(string: <span class="string">"https://avatars1.githubusercontent.com/u/5317671?v=3&amp;s=460"</span>)</span><span class="built_in">!</span></span><br><span class="line"><span class="built_in">let</span> task = NSURLSession.sharedSession<span class="params">()</span>.dataTaskWithURL<span class="params">(url)</span> &#123;</span><br><span class="line">    data, _, _ in</span><br><span class="line">    <span class="built_in">let</span> image = UIImage<span class="params">(data: data!)</span></span><br><span class="line">    <span class="comment">// playgroundä¸‹é¢„è§ˆ</span></span><br><span class="line">&#125;</span><br><span class="line">task.resume<span class="params">()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¿«é€Ÿæ£€æŸ¥APIæ¥å£</span></span><br><span class="line"><span class="built_in">let</span> url2 = NSURL<span class="params">(string: <span class="string">"http://www.test.51offer.com/mobile/abroad/query_school_by_name?name=%E4%B8%80"</span>)</span><span class="built_in">!</span></span><br><span class="line"><span class="built_in">let</span> task2 = NSURLSession.sharedSession<span class="params">()</span>.dataTaskWithURL<span class="params">(url2)</span> &#123;</span><br><span class="line">    data, _, _ in</span><br><span class="line">    <span class="built_in">let</span> <span class="built_in">str</span> = String<span class="params">(NSString<span class="params">(data: data!, encoding: NSUTF8StringEncoding)</span>)</span></span><br><span class="line">    <span class="comment">// playgroundä¸‹é¢„è§ˆ</span></span><br><span class="line">&#125;</span><br><span class="line">task2.resume<span class="params">()</span></span><br></pre></td></tr></table></figure>
<h3 id="ç»“æ„ä»‹ç»">ç»“æ„ä»‹ç»</h3><ul>
<li><p>sources</p>
<blockquote>
<p>æˆ‘ä»¬ç›´æ¥åœ¨ Playground ä¸Šé¢å†™ä»£ç ï¼Œç„¶åç¼–è¯‘å™¨ä¼šå®æ—¶ç¼–è¯‘æˆ‘ä»¬ä»£ç ï¼Œå¹¶å°†ç»“æœæ˜¾ç¤ºå‡ºæ¥ã€‚ä½†æ˜¯æ•ˆç‡å¾ˆä½ï¼Œsourceçš„ä½œç”¨å°±å¯ä»¥å‘æŒ¥å‡ºæ¥</p>
</blockquote>
</li>
<li><p>resources</p>
<blockquote>
<p>å¯ä»¥ä½œä¸ºsandboxä½¿ç”¨</p>
</blockquote>
</li>
</ul>
<figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›´æ¥ä½¿ç”¨PicButton è¿™ä¸ªclass.</span></span><br><span class="line"><span class="comment">// æ³¨æ„ç‚¹ï¼šPicButtonçš„ç±»åŠåˆå§‹åŒ–æ–¹æ³•å¿…é¡»æ˜¯publicçš„</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">let</span> btn = PicButton<span class="params">(frame: CGRectMake<span class="params">(<span class="number">0</span>,<span class="number">0</span>,<span class="number">200</span>,<span class="number">100</span>)</span>)</span></span><br><span class="line"><span class="comment">// playgroundä¸‹é¢„è§ˆ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚ä¸Šè¿°ï¼šåœ¨resourcesä¸­æ”¾å…¥jpgå›¾ç‰‡ï¼ŒåŠ è½½æœ¬åœ°èµ„æº</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">let</span> path = NSBundle.mainBundle<span class="params">()</span>.pathForResource<span class="params">(<span class="string">"swift-playground"</span>, ofType: <span class="string">"jpg"</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">let</span> image = UIImage<span class="params">(contentsOfFile:path)</span></span><br><span class="line">    <span class="built_in">let</span> imageView = UIImageView<span class="params">(image: image)</span></span><br><span class="line">        <span class="comment">// playgroundä¸‹é¢„è§ˆ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Android_APPå¼€å‘è®¾è®¡æ¨¡å¼_-_ç‹èƒœ">Android APPå¼€å‘è®¾è®¡æ¨¡å¼ - ç‹èƒœ</h2><h3 id="MVC(Standard_Android)">MVC(Standard Android)</h3><ul>
<li><p>ç›®å½•ç»“æ„</p>
<p><img src="http://7xsk2b.com2.z0.glb.clouddn.com/image/android-mvc.png" alt="android-mvc"></p>
<ul>
<li><p>Weather</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Weather</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String date;<span class="comment">//æ—¥æœŸ</span></span><br><span class="line">    <span class="keyword">private</span> String textDay;<span class="comment">//ç™½å¤©å¤©æ°”</span></span><br><span class="line">    <span class="keyword">private</span> String textNight;<span class="comment">//å¤œæ™šå¤©æ°”</span></span><br><span class="line">    <span class="keyword">private</span> String high;<span class="comment">//æœ€é«˜æ°”æ¸©</span></span><br><span class="line">    <span class="keyword">private</span> String low;<span class="comment">//æœ€ä½æ°”æ¸©</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDisplay</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        sb.append(date);</span><br><span class="line">        sb.append(<span class="string">"\t"</span>);</span><br><span class="line">        sb.append(<span class="string">"ç™½å¤©:"</span>);</span><br><span class="line">        sb.append(textDay);</span><br><span class="line">        sb.append(<span class="string">", "</span>);</span><br><span class="line">        sb.append(<span class="string">"å¤œæ™š:"</span>);</span><br><span class="line">        sb.append(textNight);</span><br><span class="line">        sb.append(<span class="string">", "</span>);</span><br><span class="line">        sb.append(<span class="string">"æœ€é«˜æ°”æ¸©:"</span>);</span><br><span class="line">        sb.append(high);</span><br><span class="line">        sb.append(<span class="string">", "</span>);</span><br><span class="line">        sb.append(<span class="string">"æœ€ä½æ°”æ¸©:"</span>);</span><br><span class="line">        sb.append(low);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// setter and getter</span></span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>WeatherActivity</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeatherActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> ListView lv;</span><br><span class="line">   <span class="keyword">private</span> LinearLayout llLoading;</span><br><span class="line"></span><br><span class="line">   <span class="annotation">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">       setContentView(R.layout.activity_weather);</span><br><span class="line">       lv = (ListView) findViewById(R.id.lv);</span><br><span class="line">       llLoading = (LinearLayout) findViewById(R.id.ll_loading);</span><br><span class="line">       loadData();</span><br><span class="line">   &#125;</span><br><span class="line">	</span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">loadData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       HttpEngine.get(Constants.API_WEATHER, <span class="keyword">new</span> HttpEngine.JSONRequestCallback() &#123;</span><br><span class="line">           <span class="annotation">@Override</span></span><br><span class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailed</span><span class="params">(Call call, Exception e)</span> </span>&#123;</span><br><span class="line">               <span class="keyword">if</span> (call.request().url().url().toString().equals(Constants.API_WEATHER)) &#123;</span><br><span class="line">                   Log.e(WeatherActivity.class.getSimpleName(), e.getMessage());</span><br><span class="line">                   Toast.makeText(WeatherActivity.<span class="keyword">this</span>, <span class="string">"Get data failed!"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">                   llLoading.setVisibility(View.GONE);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">	</span><br><span class="line">           <span class="annotation">@Override</span></span><br><span class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(Call call, JSONObject jsonResult)</span> </span>&#123;</span><br><span class="line">               <span class="keyword">if</span> (call.request().url().url().toString().equals(Constants.API_WEATHER)) &#123;</span><br><span class="line">                   <span class="keyword">try</span> &#123;</span><br><span class="line">                       JSONArray jsonArray = jsonResult.getJSONArray(<span class="string">"results"</span>).getJSONObject(<span class="number">0</span>).getJSONArray(<span class="string">"daily"</span>);</span><br><span class="line">                       Gson gson = <span class="keyword">new</span> GsonBuilder().setFieldNamingPolicy(FieldNamingPolicy.LOWER_CASE_WITH_UNDERSCORES).create();</span><br><span class="line">                       <span class="keyword">final</span> List&lt;Weather&gt; data = gson.fromJson(jsonArray.toString(), <span class="keyword">new</span> TypeToken&lt;List&lt;Weather&gt;&gt;()&#123;&#125;.getType());</span><br><span class="line">                       WeatherAdapter adapter = <span class="keyword">new</span> WeatherAdapter(WeatherActivity.<span class="keyword">this</span>, data);</span><br><span class="line">                       lv.setAdapter(adapter);</span><br><span class="line">                       llLoading.setVisibility(View.GONE);</span><br><span class="line">                       lv.setVisibility(View.VISIBLE);</span><br><span class="line">                   &#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">                       Log.e(WeatherActivity.class.getSimpleName(), e.getMessage());</span><br><span class="line">                       Toast.makeText(WeatherActivity.<span class="keyword">this</span>, <span class="string">"Get data failed!"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="MVP">MVP</h3><ul>
<li><p>ç›®å½•ç»“æ„</p>
<p><img src="http://7xsk2b.com2.z0.glb.clouddn.com/image/android-mvp.png" alt="android-mvp"></p>
<ul>
<li>Weather åŒä¸Š</li>
<li><p>IWeatherView &amp;&amp; WeatherActivity</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IWeatherView</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * åˆ·æ–°å¤©æ°”åˆ—è¡¨</span><br><span class="line">     * <span class="doctag">@param</span> data</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">refreshWeatherList</span><span class="params">(List&lt;Weather&gt; data)</span></span>;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯</span><br><span class="line">     * <span class="doctag">@param</span> e</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">showErrorInfo</span><span class="params">(Exception e)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeatherActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">IWeatherView</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ListView lv;</span><br><span class="line">    <span class="keyword">private</span> LinearLayout llLoading;</span><br><span class="line">    <span class="keyword">private</span> WeatherPresenter mWeatherPresenter;</span><br><span class="line">	</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_weather);</span><br><span class="line">        lv = (ListView) findViewById(R.id.lv);</span><br><span class="line">        llLoading = (LinearLayout) findViewById(R.id.ll_loading);</span><br><span class="line">        mWeatherPresenter = <span class="keyword">new</span> WeatherPresenter(<span class="keyword">this</span>);</span><br><span class="line">        mWeatherPresenter.getWeatherList();</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">refreshWeatherList</span><span class="params">(List&lt;Weather&gt; data)</span> </span>&#123;</span><br><span class="line">        WeatherAdapter adapter = <span class="keyword">new</span> WeatherAdapter(WeatherActivity.<span class="keyword">this</span>, data);</span><br><span class="line">        lv.setAdapter(adapter);</span><br><span class="line">        llLoading.setVisibility(View.GONE);</span><br><span class="line">        lv.setVisibility(View.VISIBLE);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showErrorInfo</span><span class="params">(Exception e)</span> </span>&#123;</span><br><span class="line">        Log.e(WeatherActivity.class.getSimpleName(), e.getMessage());</span><br><span class="line">        Toast.makeText(WeatherActivity.<span class="keyword">this</span>, <span class="string">"Get data failed!"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">        llLoading.setVisibility(View.GONE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>WeatherPresenter</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeatherPresenter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> IWeatherView mWeatherView;</span><br><span class="line">	</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WeatherPresenter</span><span class="params">(@NonNull IWeatherView view)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mWeatherView = view;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * é€šè¿‡ç½‘ç»œè¯·æ±‚è·å–å¤©æ°”åˆ—è¡¨æ•°æ®</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getWeatherList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        HttpEngine.get(Constants.API_WEATHER, <span class="keyword">new</span> HttpEngine.JSONRequestCallback() &#123;</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailed</span><span class="params">(Call call, Exception e)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (call.request().url().url().toString().equals(Constants.API_WEATHER)) &#123;</span><br><span class="line">                    mWeatherView.showErrorInfo(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">	</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(Call call, JSONObject jsonResult)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (call.request().url().url().toString().equals(Constants.API_WEATHER)) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        JSONArray jsonArray = jsonResult.getJSONArray(<span class="string">"results"</span>).getJSONObject(<span class="number">0</span>).getJSONArray(<span class="string">"daily"</span>);</span><br><span class="line">                        Gson gson = <span class="keyword">new</span> GsonBuilder().setFieldNamingPolicy(FieldNamingPolicy.LOWER_CASE_WITH_UNDERSCORES).create();</span><br><span class="line">                        List&lt;Weather&gt; data = gson.fromJson(jsonArray.toString(), <span class="keyword">new</span> TypeToken&lt;List&lt;Weather&gt;&gt;()&#123;&#125;.getType());</span><br><span class="line">                        mWeatherView.refreshWeatherList(data);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (JSONException e) &#123;</span><br><span class="line">                        mWeatherView.showErrorInfo(e);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Playground/">Playground</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«/">ç§»åŠ¨ç»„å‘¨æŠ€æœ¯åˆ†äº«</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 ç§»åŠ¨ç»„å›¢é˜Ÿ
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>